<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Vibe Coding Gallery - Enhanced Discovery</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #000;
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Animated background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(120, 30, 255, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 30, 120, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 10%, rgba(30, 255, 120, 0.3) 0%, transparent 50%);
            animation: drift 20s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes drift {
            0%, 100% { transform: scale(1) rotate(0deg); }
            33% { transform: scale(1.1) rotate(120deg); }
            66% { transform: scale(0.95) rotate(240deg); }
        }

        /* Header */
        .header {
            padding: 40px 20px 30px;
            text-align: center;
            position: relative;
            background: linear-gradient(180deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 100%);
        }

        .gallery-title {
            font-size: 4em;
            font-weight: 100;
            letter-spacing: 0.2em;
            margin-bottom: 15px;
            text-transform: uppercase;
            position: relative;
            display: inline-block;
        }

        @media (max-width: 768px) {
            .gallery-title {
                font-size: 2.5em;
                letter-spacing: 0.1em;
            }
        }

        .gallery-title::before {
            content: 'VIBE CODING';
            position: absolute;
            left: 0;
            top: 0;
            background: linear-gradient(45deg, #ff006e, #8338ec, #3a86ff, #06ffa5);
            background-size: 400% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: shimmer 8s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .gallery-subtitle {
            font-size: 1.3em;
            font-weight: 200;
            color: rgba(255, 255, 255, 0.6);
            letter-spacing: 0.3em;
            text-transform: uppercase;
            margin-bottom: 20px;
        }

        /* Settings Bar */
        .settings-bar {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 100;
        }

        .settings-button {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3em;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .settings-button:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.1);
        }

        .settings-button.active {
            background: linear-gradient(135deg, #ff006e, #8338ec);
            border: none;
        }

        /* Main Layout */
        .main-layout {
            display: flex;
            max-width: 1800px;
            margin: 0 auto;
            padding: 0 20px;
            gap: 30px;
        }

        @media (max-width: 1024px) {
            .main-layout {
                flex-direction: column;
            }
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            position: sticky;
            top: 20px;
            height: fit-content;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        @media (max-width: 1024px) {
            .sidebar {
                width: 100%;
                position: relative;
                top: 0;
                max-height: none;
            }
        }

        .sidebar-section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .sidebar-title {
            font-size: 1.2em;
            font-weight: 300;
            margin-bottom: 15px;
            color: #06ffa5;
            letter-spacing: 0.05em;
        }

        /* Search Box */
        .search-container {
            position: relative;
            margin-bottom: 20px;
        }

        .search-box {
            width: 100%;
            padding: 12px 40px 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            color: white;
            font-size: 1em;
            outline: none;
            transition: all 0.3s ease;
        }

        .search-box:focus {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.5);
        }

        /* Filter Tags */
        .filter-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .filter-tag {
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
            user-select: none;
        }

        .filter-tag:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .filter-tag.active {
            background: linear-gradient(135deg, #ff006e, #8338ec);
            border: none;
            color: white;
        }

        /* Categories */
        .category-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .category-item {
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .category-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .category-item.active {
            background: linear-gradient(135deg, #ff006e, #8338ec);
            border: none;
        }

        .category-count {
            background: rgba(0, 0, 0, 0.3);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.85em;
        }

        /* Statistics */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: 300;
            color: #06ffa5;
        }

        .stat-label {
            font-size: 0.85em;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 5px;
        }

        /* Content Area */
        .content-area {
            flex: 1;
            min-width: 0;
        }

        /* View Controls */
        .view-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .view-modes {
            display: flex;
            gap: 10px;
        }

        .view-mode-button {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            color: white;
            cursor: pointer;
            font-size: 0.95em;
            transition: all 0.3s ease;
        }

        .view-mode-button:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .view-mode-button.active {
            background: linear-gradient(135deg, #ff006e, #8338ec);
            border: none;
        }

        .sort-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sort-select {
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            color: white;
            cursor: pointer;
            outline: none;
        }

        /* Gallery Views */
        .gallery-grid {
            display: grid;
            gap: 25px;
        }

        .gallery-grid.grid-view {
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        }

        .gallery-grid.list-view {
            grid-template-columns: 1fr;
        }

        .gallery-grid.compact-view {
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }

        /* Tool Card */
        .tool-card {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            transition: all 0.5s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .tool-card.pinned {
            border-color: #ff006e;
            background: rgba(255, 0, 110, 0.05);
        }

        .tool-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        }

        .tool-card.list-view {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .tool-card.compact-view {
            padding: 15px;
        }

        .tool-icon {
            font-size: 3em;
            margin-bottom: 15px;
            display: block;
            text-align: center;
        }

        .tool-card.list-view .tool-icon {
            font-size: 2.5em;
            margin-bottom: 0;
        }

        .tool-card.compact-view .tool-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .tool-content {
            flex: 1;
        }

        .tool-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 10px;
        }

        .tool-title {
            font-size: 1.4em;
            font-weight: 300;
            letter-spacing: 0.03em;
        }

        .tool-card.compact-view .tool-title {
            font-size: 1.1em;
        }

        .tool-badges {
            display: flex;
            gap: 5px;
        }

        .tool-badge {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tool-badge:hover {
            transform: scale(1.2);
        }

        .tool-badge.pinned {
            background: #ff006e;
            border-color: #ff006e;
        }

        .tool-badge.favorite {
            background: #ffeb3b;
            border-color: #ffeb3b;
        }

        .tool-description {
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.5;
            margin-bottom: 15px;
            font-size: 0.95em;
        }

        .tool-card.compact-view .tool-description {
            font-size: 0.85em;
            margin-bottom: 10px;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .tool-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 15px;
        }

        .tool-tag {
            padding: 4px 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            font-size: 0.8em;
            color: rgba(255, 255, 255, 0.6);
        }

        .tool-stats {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.5);
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .tool-actions {
            display: flex;
            gap: 10px;
        }

        .tool-card.compact-view .tool-actions {
            flex-direction: column;
        }

        .action-button {
            flex: 1;
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 400;
            letter-spacing: 0.03em;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        .action-button.primary {
            background: linear-gradient(135deg, #ff006e, #8338ec);
            color: white;
        }

        .action-button.primary:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(138, 43, 226, 0.5);
        }

        .action-button.secondary {
            background: transparent;
            color: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .action-button.secondary:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Settings Panel */
        .settings-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            border-left: 1px solid rgba(255, 255, 255, 0.2);
            padding: 30px;
            transition: right 0.3s ease;
            z-index: 1000;
            overflow-y: auto;
            backdrop-filter: blur(20px);
        }

        .settings-panel.open {
            right: 0;
        }

        @media (max-width: 768px) {
            .settings-panel {
                width: 100%;
                right: -100%;
            }
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .settings-title {
            font-size: 1.5em;
            font-weight: 300;
            color: #06ffa5;
        }

        .close-settings {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            transition: all 0.3s ease;
        }

        .close-settings:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .settings-section {
            margin-bottom: 30px;
        }

        .settings-section-title {
            font-size: 1.1em;
            font-weight: 300;
            margin-bottom: 15px;
            color: rgba(255, 255, 255, 0.8);
        }

        .import-export-buttons {
            display: flex;
            gap: 10px;
        }

        .import-export-button {
            flex: 1;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-size: 0.95em;
            transition: all 0.3s ease;
        }

        .import-export-button:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .file-input {
            display: none;
        }

        /* Progress Tracking */
        .progress-tracker {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff006e, #8338ec);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.6);
        }

        /* Pinned Dashboard */
        .pinned-dashboard {
            display: none;
            padding: 20px;
        }

        .pinned-dashboard.active {
            display: block;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .dashboard-title {
            font-size: 2.5em;
            font-weight: 100;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff006e, #8338ec);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .dashboard-subtitle {
            color: rgba(255, 255, 255, 0.6);
            font-size: 1.1em;
        }

        .pinned-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .pinned-category {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
        }

        .pinned-category-title {
            font-size: 1.3em;
            font-weight: 300;
            margin-bottom: 20px;
            color: #06ffa5;
        }

        .pinned-tools-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .pinned-tool-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pinned-tool-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .pinned-tool-icon {
            font-size: 1.8em;
        }

        .pinned-tool-info {
            flex: 1;
        }

        .pinned-tool-name {
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .pinned-tool-usage {
            font-size: 0.85em;
            color: rgba(255, 255, 255, 0.6);
        }

        /* Quick Access Bar */
        .quick-access-bar {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            padding: 15px 30px;
            display: flex;
            gap: 20px;
            align-items: center;
            z-index: 100;
            backdrop-filter: blur(20px);
        }

        .quick-access-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quick-access-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 15px 30px;
            color: white;
            font-size: 1em;
            z-index: 2000;
            opacity: 0;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .toast.success {
            border-color: #06ffa5;
            color: #06ffa5;
        }

        .toast.error {
            border-color: #ff006e;
            color: #ff006e;
        }

        /* Loading Skeleton */
        .skeleton {
            background: linear-gradient(90deg, 
                rgba(255, 255, 255, 0.05) 25%, 
                rgba(255, 255, 255, 0.1) 50%, 
                rgba(255, 255, 255, 0.05) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 10px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .skeleton-card {
            height: 300px;
            border-radius: 15px;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }
    </style>
</head>
<body>
    <!-- Settings Bar -->
    <div class="settings-bar">
        <button class="settings-button" id="pinned-view-btn" title="Pinned Dashboard">📌</button>
        <button class="settings-button" id="settings-btn" title="Settings">⚙️</button>
    </div>

    <!-- Header -->
    <div class="header">
        <h1 class="gallery-title">VIBE CODING</h1>
        <div class="gallery-subtitle">Kody's Creative Playground</div>
    </div>

    <!-- Main Layout -->
    <div class="main-layout" id="main-gallery">
        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- Search -->
            <div class="sidebar-section">
                <div class="search-container">
                    <input type="text" class="search-box" id="search-input" placeholder="Search tools...">
                    <span class="search-icon">🔍</span>
                </div>
            </div>

            <!-- Categories -->
            <div class="sidebar-section">
                <h3 class="sidebar-title">Categories</h3>
                <div class="category-list" id="category-list">
                    <div class="category-item active" data-category="all">
                        <span>All Tools</span>
                        <span class="category-count">0</span>
                    </div>
                </div>
            </div>

            <!-- Filter Tags -->
            <div class="sidebar-section">
                <h3 class="sidebar-title">Filter by Tags</h3>
                <div class="filter-tags" id="filter-tags"></div>
            </div>

            <!-- Statistics -->
            <div class="sidebar-section">
                <h3 class="sidebar-title">Statistics</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="total-tools">0</div>
                        <div class="stat-label">Total Tools</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="pinned-count">0</div>
                        <div class="stat-label">Pinned</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="used-count">0</div>
                        <div class="stat-label">Used</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="favorite-count">0</div>
                        <div class="stat-label">Favorites</div>
                    </div>
                </div>
            </div>

            <!-- Progress -->
            <div class="sidebar-section">
                <h3 class="sidebar-title">Discovery Progress</h3>
                <div class="progress-tracker">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                    </div>
                    <div class="progress-text">
                        <span id="progress-text">0% Explored</span>
                        <span id="progress-detail">0/0</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Content Area -->
        <main class="content-area">
            <!-- View Controls -->
            <div class="view-controls">
                <div class="view-modes">
                    <button class="view-mode-button active" data-view="grid">Grid</button>
                    <button class="view-mode-button" data-view="list">List</button>
                    <button class="view-mode-button" data-view="compact">Compact</button>
                </div>
                <div class="sort-controls">
                    <label style="color: rgba(255, 255, 255, 0.6); margin-right: 10px;">Sort by:</label>
                    <select class="sort-select" id="sort-select">
                        <option value="name">Name</option>
                        <option value="recent">Recently Added</option>
                        <option value="popular">Most Popular</option>
                        <option value="used">Most Used</option>
                        <option value="random">Random</option>
                    </select>
                </div>
            </div>

            <!-- Gallery Grid -->
            <div class="gallery-grid grid-view" id="gallery-grid">
                <!-- Skeleton Loading -->
                <div class="skeleton skeleton-card"></div>
                <div class="skeleton skeleton-card"></div>
                <div class="skeleton skeleton-card"></div>
            </div>
        </main>
    </div>

    <!-- Pinned Dashboard -->
    <div class="pinned-dashboard" id="pinned-dashboard">
        <div class="dashboard-header">
            <h2 class="dashboard-title">Your Pinned Tools</h2>
            <p class="dashboard-subtitle">Quick access to your prioritized tools</p>
        </div>
        <div class="pinned-categories" id="pinned-categories"></div>
        <div style="text-align: center; margin-top: 40px;">
            <button class="action-button primary" id="back-to-gallery" style="width: 200px;">Back to Gallery</button>
        </div>
    </div>

    <!-- Settings Panel -->
    <div class="settings-panel" id="settings-panel">
        <div class="settings-header">
            <h2 class="settings-title">Settings</h2>
            <button class="close-settings" id="close-settings">×</button>
        </div>

        <div class="settings-section">
            <h3 class="settings-section-title">Import/Export Settings</h3>
            <p style="color: rgba(255, 255, 255, 0.6); font-size: 0.9em; margin-bottom: 15px;">
                Save and restore your gallery preferences, pinned tools, and progress
            </p>
            <div class="import-export-buttons">
                <button class="import-export-button" id="export-settings">Export JSON</button>
                <button class="import-export-button" id="import-settings-btn">Import JSON</button>
                <input type="file" class="file-input" id="import-file" accept=".json">
            </div>
        </div>

        <div class="settings-section">
            <h3 class="settings-section-title">Data Management</h3>
            <button class="import-export-button" id="clear-data" style="width: 100%; background: rgba(255, 0, 110, 0.2); border-color: #ff006e;">
                Clear All Data
            </button>
        </div>

        <div class="settings-section">
            <h3 class="settings-section-title">Gallery Preferences</h3>
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                    <input type="checkbox" id="auto-save" checked style="width: 20px; height: 20px;">
                    <span style="color: rgba(255, 255, 255, 0.8);">Auto-save preferences</span>
                </label>
                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                    <input type="checkbox" id="show-descriptions" checked style="width: 20px; height: 20px;">
                    <span style="color: rgba(255, 255, 255, 0.8);">Show tool descriptions</span>
                </label>
            </div>
        </div>
    </div>

    <!-- Quick Access Bar -->
    <div class="quick-access-bar" id="quick-access-bar" style="display: none;">
        <div class="quick-access-item">
            <span>🚀</span>
            <span>Recent Tools</span>
        </div>
        <div class="quick-access-item">
            <span>⭐</span>
            <span>Favorites</span>
        </div>
        <div class="quick-access-item">
            <span>📊</span>
            <span>Analytics</span>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script>
        // Application State
        const AppState = {
            tools: [],
            categories: new Map(),
            tags: new Set(),
            userPreferences: {
                pinnedTools: [],
                favoriteTools: [],
                toolUsage: {},
                lastVisited: {},
                notes: {},
                customCategories: {},
                viewMode: 'grid',
                sortMode: 'name',
                filters: {
                    category: 'all',
                    tags: [],
                    search: ''
                },
                settings: {
                    autoSave: true,
                    showDescriptions: true
                }
            },
            currentView: 'gallery' // 'gallery' or 'pinned'
        };

        // GitHub configuration
        const REPO_OWNER = 'kody-w';
        const REPO_NAME = 'localFirstTools';
        const BRANCH = 'main';

        // Local storage keys
        const STORAGE_KEY = 'vibe_gallery_state';

        // Tool metadata generator
        function generateToolMetadata(file) {
            const filename = file.path.split('/').pop();
            const nameWithoutExt = filename.replace(/\.(html|htm)$/i, '');
            const formattedName = nameWithoutExt
                .replace(/[-_]/g, ' ')
                .replace(/\b\w/g, l => l.toUpperCase());
            
            const hash = filename.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
            
            const icons = ['🎨', '✨', '🌟', '💫', '🔮', '🎭', '🌈', '🎪', '🎯', '🎲', '🎸', '🎹', '🎬', '🎭', '🎪', '🎨'];
            const categories = ['Creative', 'Utility', 'Visualization', 'Interactive', 'Experimental', 'Generative'];
            const allTags = [
                'interactive', 'generative', 'particles', 'animation', 
                'experimental', '3D', 'audio-reactive', 'kinetic',
                'abstract', 'geometric', 'organic', 'minimal',
                'colorful', 'monochrome', 'dynamic', 'static',
                'tool', 'art', 'game', 'utility'
            ];
            
            const descriptions = [
                "An experimental dive into creative web technology",
                "Interactive art piece exploring code and creativity",
                "A digital meditation on algorithms and aesthetics",
                "Pushing browser limits for visual experiences",
                "Real-time generative art that evolves",
                "Creative coding experiment in web tech",
                "Where code becomes art",
                "Digital canvas for creative expression",
                "Vibe coding at its finest"
            ];
            
            const category = categories[hash % categories.length];
            const numTags = 3 + (hash % 3);
            const tags = [];
            for (let i = 0; i < numTags; i++) {
                tags.push(allTags[(hash + i * 7) % allTags.length]);
            }
            
            return {
                id: file.path,
                title: formattedName,
                description: descriptions[hash % descriptions.length],
                icon: icons[hash % icons.length],
                category: category,
                tags: tags,
                url: file.pages_url || file.path,
                rawUrl: file.raw_url || file.path,
                path: file.path,
                createdAt: new Date().toISOString()
            };
        }

        // Load state from local storage
        function loadState() {
            try {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved) {
                    const data = JSON.parse(saved);
                    Object.assign(AppState.userPreferences, data.userPreferences || {});
                    return true;
                }
            } catch (e) {
                console.error('Error loading state:', e);
            }
            return false;
        }

        // Save state to local storage
        function saveState() {
            if (AppState.userPreferences.settings.autoSave) {
                try {
                    const dataToSave = {
                        userPreferences: AppState.userPreferences,
                        version: '2.0',
                        lastSaved: new Date().toISOString()
                    };
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));
                } catch (e) {
                    console.error('Error saving state:', e);
                }
            }
        }

        // Export settings to JSON
        function exportSettings() {
            const exportData = {
                version: '2.0',
                exportDate: new Date().toISOString(),
                userPreferences: AppState.userPreferences,
                tools: AppState.tools.map(tool => ({
                    id: tool.id,
                    title: tool.title,
                    category: tool.category,
                    tags: tool.tags
                }))
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `vibe-gallery-settings-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showToast('Settings exported successfully', 'success');
        }

        // Import settings from JSON
        function importSettings(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.version === '2.0' && data.userPreferences) {
                        AppState.userPreferences = data.userPreferences;
                        saveState();
                        renderGallery();
                        updateSidebar();
                        showToast('Settings imported successfully', 'success');
                    } else {
                        showToast('Invalid settings file', 'error');
                    }
                } catch (err) {
                    showToast('Error importing settings', 'error');
                    console.error('Import error:', err);
                }
            };
            reader.readAsText(file);
        }

        // Toast notification
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Fetch tools from GitHub
        async function fetchTools() {
            try {
                const isLocal = window.location.protocol === 'file:' || 
                               window.location.hostname === 'localhost';
                
                if (isLocal) {
                    // Try local config first
                    try {
                        const response = await fetch('data/config/utility_apps_config.json');
                        if (response.ok) {
                            const config = await response.json();
                            const tools = config.apps.map(app => ({
                                path: app.path.replace('./', ''),
                                pages_url: app.path.replace('./', ''),
                                raw_url: app.path.replace('./', '')
                            }));
                            return tools.map(generateToolMetadata);
                        }
                    } catch (e) {
                        console.log('Local config not found, using fallback');
                    }
                }
                
                // GitHub API
                const apiUrl = `https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/git/trees/${BRANCH}?recursive=1`;
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error(`GitHub API error: ${response.status}`);
                }
                
                const data = await response.json();
                const tools = [];
                
                data.tree.forEach(item => {
                    if (item.type === 'blob' && 
                        (item.path.endsWith('.html') || item.path.endsWith('.htm'))) {
                        
                        const filename = item.path.split('/').pop().toLowerCase();
                        const excludeFiles = ['index.html', 'template.html', 'example.html', 'test.html', 'gallery.html'];
                        
                        if (!excludeFiles.includes(filename)) {
                            tools.push({
                                path: item.path,
                                pages_url: isLocal ? item.path : `https://${REPO_OWNER}.github.io/${REPO_NAME}/${item.path}`,
                                raw_url: `https://raw.githubusercontent.com/${REPO_OWNER}/${REPO_NAME}/${BRANCH}/${item.path}`
                            });
                        }
                    }
                });
                
                return tools.map(generateToolMetadata);
                
            } catch (error) {
                console.error('Error fetching tools:', error);
                showToast('Error loading tools', 'error');
                return [];
            }
        }

        // Process tools and extract categories/tags
        function processTools(tools) {
            AppState.tools = tools;
            AppState.categories.clear();
            AppState.tags.clear();
            
            // Add default category
            AppState.categories.set('all', tools.length);
            
            tools.forEach(tool => {
                // Process categories
                const count = AppState.categories.get(tool.category) || 0;
                AppState.categories.set(tool.category, count + 1);
                
                // Process tags
                tool.tags.forEach(tag => AppState.tags.add(tag));
            });
        }

        // Filter and sort tools
        function getFilteredTools() {
            let filtered = [...AppState.tools];
            const prefs = AppState.userPreferences;
            
            // Apply category filter
            if (prefs.filters.category && prefs.filters.category !== 'all') {
                filtered = filtered.filter(tool => tool.category === prefs.filters.category);
            }
            
            // Apply tag filters
            if (prefs.filters.tags.length > 0) {
                filtered = filtered.filter(tool => 
                    prefs.filters.tags.some(tag => tool.tags.includes(tag))
                );
            }
            
            // Apply search filter
            if (prefs.filters.search) {
                const search = prefs.filters.search.toLowerCase();
                filtered = filtered.filter(tool => 
                    tool.title.toLowerCase().includes(search) ||
                    tool.description.toLowerCase().includes(search) ||
                    tool.tags.some(tag => tag.includes(search))
                );
            }
            
            // Sort
            filtered.sort((a, b) => {
                // Pinned items first
                const aPinned = prefs.pinnedTools.includes(a.id);
                const bPinned = prefs.pinnedTools.includes(b.id);
                if (aPinned && !bPinned) return -1;
                if (!aPinned && bPinned) return 1;
                
                // Then by sort mode
                switch (prefs.sortMode) {
                    case 'name':
                        return a.title.localeCompare(b.title);
                    case 'recent':
                        return (prefs.lastVisited[b.id] || 0) - (prefs.lastVisited[a.id] || 0);
                    case 'popular':
                    case 'used':
                        return (prefs.toolUsage[b.id] || 0) - (prefs.toolUsage[a.id] || 0);
                    case 'random':
                        return Math.random() - 0.5;
                    default:
                        return 0;
                }
            });
            
            return filtered;
        }

        // Render gallery
        function renderGallery() {
            const grid = document.getElementById('gallery-grid');
            const tools = getFilteredTools();
            const viewMode = AppState.userPreferences.viewMode;
            
            grid.className = `gallery-grid ${viewMode}-view`;
            grid.innerHTML = '';
            
            if (tools.length === 0) {
                grid.innerHTML = '<div style="grid-column: 1/-1; text-align: center; padding: 50px; color: rgba(255,255,255,0.5);">No tools found</div>';
                return;
            }
            
            tools.forEach(tool => {
                const card = createToolCard(tool, viewMode);
                grid.appendChild(card);
            });
        }

        // Create tool card
        function createToolCard(tool, viewMode) {
            const prefs = AppState.userPreferences;
            const isPinned = prefs.pinnedTools.includes(tool.id);
            const isFavorite = prefs.favoriteTools.includes(tool.id);
            const usage = prefs.toolUsage[tool.id] || 0;
            
            const card = document.createElement('div');
            card.className = `tool-card ${viewMode}-view ${isPinned ? 'pinned' : ''}`;
            card.dataset.toolId = tool.id;
            
            const iconSection = viewMode === 'list' ? 
                `<span class="tool-icon">${tool.icon}</span>` :
                `<div class="tool-icon">${tool.icon}</div>`;
            
            const badgesHtml = `
                <div class="tool-badges">
                    <button class="tool-badge ${isPinned ? 'pinned' : ''}" data-action="pin" title="Pin">
                        📌
                    </button>
                    <button class="tool-badge ${isFavorite ? 'favorite' : ''}" data-action="favorite" title="Favorite">
                        ⭐
                    </button>
                </div>
            `;
            
            const tagsHtml = viewMode !== 'compact' ? `
                <div class="tool-tags">
                    ${tool.tags.map(tag => `<span class="tool-tag">${tag}</span>`).join('')}
                </div>
            ` : '';
            
            const statsHtml = viewMode !== 'compact' ? `
                <div class="tool-stats">
                    <div class="stat-item">
                        <span>👁</span>
                        <span>${usage}</span>
                    </div>
                    <div class="stat-item">
                        <span>📁</span>
                        <span>${tool.category}</span>
                    </div>
                </div>
            ` : '';
            
            card.innerHTML = `
                ${iconSection}
                <div class="tool-content">
                    <div class="tool-header">
                        <h3 class="tool-title">${tool.title}</h3>
                        ${badgesHtml}
                    </div>
                    <p class="tool-description">${tool.description}</p>
                    ${tagsHtml}
                    ${statsHtml}
                    <div class="tool-actions">
                        <button class="action-button primary" data-action="open">Open</button>
                        <button class="action-button secondary" data-action="download">Save</button>
                    </div>
                </div>
            `;
            
            // Add event listeners
            card.querySelectorAll('[data-action]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    handleToolAction(tool, btn.dataset.action);
                });
            });
            
            card.addEventListener('click', () => {
                handleToolAction(tool, 'open');
            });
            
            return card;
        }

        // Handle tool actions
        function handleToolAction(tool, action) {
            const prefs = AppState.userPreferences;
            
            switch (action) {
                case 'open':
                    // Update usage stats
                    prefs.toolUsage[tool.id] = (prefs.toolUsage[tool.id] || 0) + 1;
                    prefs.lastVisited[tool.id] = Date.now();
                    saveState();
                    updateProgress();
                    window.open(tool.url, '_blank');
                    break;
                    
                case 'pin':
                    const pinIndex = prefs.pinnedTools.indexOf(tool.id);
                    if (pinIndex > -1) {
                        prefs.pinnedTools.splice(pinIndex, 1);
                        showToast('Tool unpinned');
                    } else {
                        prefs.pinnedTools.push(tool.id);
                        showToast('Tool pinned');
                    }
                    saveState();
                    renderGallery();
                    updateSidebar();
                    break;
                    
                case 'favorite':
                    const favIndex = prefs.favoriteTools.indexOf(tool.id);
                    if (favIndex > -1) {
                        prefs.favoriteTools.splice(favIndex, 1);
                        showToast('Removed from favorites');
                    } else {
                        prefs.favoriteTools.push(tool.id);
                        showToast('Added to favorites');
                    }
                    saveState();
                    renderGallery();
                    updateSidebar();
                    break;
                    
                case 'download':
                    downloadTool(tool);
                    break;
            }
        }

        // Download tool
        async function downloadTool(tool) {
            try {
                const response = await fetch(tool.rawUrl);
                if (!response.ok) throw new Error('Download failed');
                
                const content = await response.text();
                const blob = new Blob([content], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = tool.path.split('/').pop();
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showToast('Tool downloaded successfully');
            } catch (error) {
                showToast('Error downloading tool', 'error');
            }
        }

        // Update sidebar
        function updateSidebar() {
            const prefs = AppState.userPreferences;
            
            // Update categories
            const categoryList = document.getElementById('category-list');
            categoryList.innerHTML = '';
            
            AppState.categories.forEach((count, category) => {
                const item = document.createElement('div');
                item.className = `category-item ${prefs.filters.category === category ? 'active' : ''}`;
                item.dataset.category = category;
                item.innerHTML = `
                    <span>${category === 'all' ? 'All Tools' : category}</span>
                    <span class="category-count">${count}</span>
                `;
                item.addEventListener('click', () => {
                    prefs.filters.category = category;
                    saveState();
                    updateSidebar();
                    renderGallery();
                });
                categoryList.appendChild(item);
            });
            
            // Update tags
            const filterTags = document.getElementById('filter-tags');
            filterTags.innerHTML = '';
            
            Array.from(AppState.tags).sort().forEach(tag => {
                const tagEl = document.createElement('div');
                tagEl.className = `filter-tag ${prefs.filters.tags.includes(tag) ? 'active' : ''}`;
                tagEl.textContent = tag;
                tagEl.addEventListener('click', () => {
                    const index = prefs.filters.tags.indexOf(tag);
                    if (index > -1) {
                        prefs.filters.tags.splice(index, 1);
                    } else {
                        prefs.filters.tags.push(tag);
                    }
                    saveState();
                    updateSidebar();
                    renderGallery();
                });
                filterTags.appendChild(tagEl);
            });
            
            // Update statistics
            document.getElementById('total-tools').textContent = AppState.tools.length;
            document.getElementById('pinned-count').textContent = prefs.pinnedTools.length;
            document.getElementById('favorite-count').textContent = prefs.favoriteTools.length;
            
            const usedTools = Object.keys(prefs.toolUsage).length;
            document.getElementById('used-count').textContent = usedTools;
            
            updateProgress();
        }

        // Update progress
        function updateProgress() {
            const totalTools = AppState.tools.length;
            const usedTools = Object.keys(AppState.userPreferences.toolUsage).length;
            const percentage = totalTools > 0 ? Math.round((usedTools / totalTools) * 100) : 0;
            
            document.getElementById('progress-fill').style.width = `${percentage}%`;
            document.getElementById('progress-text').textContent = `${percentage}% Explored`;
            document.getElementById('progress-detail').textContent = `${usedTools}/${totalTools}`;
        }

        // Render pinned dashboard
        function renderPinnedDashboard() {
            const dashboard = document.getElementById('pinned-categories');
            const prefs = AppState.userPreferences;
            const pinnedTools = AppState.tools.filter(tool => prefs.pinnedTools.includes(tool.id));
            
            if (pinnedTools.length === 0) {
                dashboard.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 50px; color: rgba(255,255,255,0.5);">
                        <p style="font-size: 1.2em; margin-bottom: 20px;">No pinned tools yet</p>
                        <p>Pin your favorite tools from the gallery to see them here</p>
                    </div>
                `;
                return;
            }
            
            // Group by category
            const byCategory = {};
            pinnedTools.forEach(tool => {
                if (!byCategory[tool.category]) {
                    byCategory[tool.category] = [];
                }
                byCategory[tool.category].push(tool);
            });
            
            dashboard.innerHTML = '';
            
            Object.entries(byCategory).forEach(([category, tools]) => {
                const categoryEl = document.createElement('div');
                categoryEl.className = 'pinned-category';
                
                const toolsHtml = tools.map(tool => `
                    <div class="pinned-tool-item" data-tool-id="${tool.id}">
                        <span class="pinned-tool-icon">${tool.icon}</span>
                        <div class="pinned-tool-info">
                            <div class="pinned-tool-name">${tool.title}</div>
                            <div class="pinned-tool-usage">Used ${prefs.toolUsage[tool.id] || 0} times</div>
                        </div>
                    </div>
                `).join('');
                
                categoryEl.innerHTML = `
                    <h3 class="pinned-category-title">${category}</h3>
                    <div class="pinned-tools-list">${toolsHtml}</div>
                `;
                
                dashboard.appendChild(categoryEl);
            });
            
            // Add click handlers
            dashboard.querySelectorAll('.pinned-tool-item').forEach(item => {
                item.addEventListener('click', () => {
                    const tool = AppState.tools.find(t => t.id === item.dataset.toolId);
                    if (tool) {
                        handleToolAction(tool, 'open');
                    }
                });
            });
        }

        // Initialize event listeners
        function initEventListeners() {
            // Search
            document.getElementById('search-input').addEventListener('input', (e) => {
                AppState.userPreferences.filters.search = e.target.value;
                saveState();
                renderGallery();
            });
            
            // View modes
            document.querySelectorAll('.view-mode-button').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.view-mode-button').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    AppState.userPreferences.viewMode = btn.dataset.view;
                    saveState();
                    renderGallery();
                });
            });
            
            // Sort
            document.getElementById('sort-select').addEventListener('change', (e) => {
                AppState.userPreferences.sortMode = e.target.value;
                saveState();
                renderGallery();
            });
            
            // Settings panel
            document.getElementById('settings-btn').addEventListener('click', () => {
                document.getElementById('settings-panel').classList.add('open');
            });
            
            document.getElementById('close-settings').addEventListener('click', () => {
                document.getElementById('settings-panel').classList.remove('open');
            });
            
            // Import/Export
            document.getElementById('export-settings').addEventListener('click', exportSettings);
            
            document.getElementById('import-settings-btn').addEventListener('click', () => {
                document.getElementById('import-file').click();
            });
            
            document.getElementById('import-file').addEventListener('change', (e) => {
                if (e.target.files[0]) {
                    importSettings(e.target.files[0]);
                }
            });
            
            // Clear data
            document.getElementById('clear-data').addEventListener('click', () => {
                if (confirm('Are you sure you want to clear all data?')) {
                    localStorage.removeItem(STORAGE_KEY);
                    location.reload();
                }
            });
            
            // Settings checkboxes
            document.getElementById('auto-save').addEventListener('change', (e) => {
                AppState.userPreferences.settings.autoSave = e.target.checked;
                saveState();
            });
            
            document.getElementById('show-descriptions').addEventListener('change', (e) => {
                AppState.userPreferences.settings.showDescriptions = e.target.checked;
                saveState();
                renderGallery();
            });
            
            // Pinned view toggle
            document.getElementById('pinned-view-btn').addEventListener('click', () => {
                AppState.currentView = 'pinned';
                document.getElementById('main-gallery').style.display = 'none';
                document.getElementById('pinned-dashboard').classList.add('active');
                document.getElementById('pinned-view-btn').classList.add('active');
                renderPinnedDashboard();
            });
            
            // Back to gallery
            document.getElementById('back-to-gallery').addEventListener('click', () => {
                AppState.currentView = 'gallery';
                document.getElementById('pinned-dashboard').classList.remove('active');
                document.getElementById('main-gallery').style.display = 'flex';
                document.getElementById('pinned-view-btn').classList.remove('active');
            });
        }

        // Initialize application
        async function init() {
            // Load saved state
            loadState();
            
            // Apply saved settings to UI
            document.getElementById('auto-save').checked = AppState.userPreferences.settings.autoSave;
            document.getElementById('show-descriptions').checked = AppState.userPreferences.settings.showDescriptions;
            
            // Set initial view mode
            document.querySelectorAll('.view-mode-button').forEach(btn => {
                if (btn.dataset.view === AppState.userPreferences.viewMode) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Set initial sort mode
            document.getElementById('sort-select').value = AppState.userPreferences.sortMode;
            
            // Fetch and process tools
            const tools = await fetchTools();
            processTools(tools);
            
            // Initial render
            updateSidebar();
            renderGallery();
            
            // Initialize event listeners
            initEventListeners();
            
            // Show welcome message for first-time users
            if (!localStorage.getItem(STORAGE_KEY)) {
                showToast('Welcome! Your progress is automatically saved locally', 'success');
            }
        }

        // Advanced features for discovery
        class DiscoveryEngine {
            constructor() {
                this.recommendations = [];
                this.patterns = {};
            }
            
            analyzeUsagePatterns() {
                const prefs = AppState.userPreferences;
                const patterns = {
                    mostUsedCategory: null,
                    preferredTags: [],
                    usageTime: {},
                    relatedTools: {}
                };
                
                // Find most used category
                const categoryUsage = {};
                Object.keys(prefs.toolUsage).forEach(toolId => {
                    const tool = AppState.tools.find(t => t.id === toolId);
                    if (tool) {
                        categoryUsage[tool.category] = (categoryUsage[tool.category] || 0) + prefs.toolUsage[toolId];
                    }
                });
                
                patterns.mostUsedCategory = Object.entries(categoryUsage)
                    .sort((a, b) => b[1] - a[1])[0]?.[0];
                
                // Find preferred tags
                const tagUsage = {};
                Object.keys(prefs.toolUsage).forEach(toolId => {
                    const tool = AppState.tools.find(t => t.id === toolId);
                    if (tool) {
                        tool.tags.forEach(tag => {
                            tagUsage[tag] = (tagUsage[tag] || 0) + prefs.toolUsage[toolId];
                        });
                    }
                });
                
                patterns.preferredTags = Object.entries(tagUsage)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 5)
                    .map(([tag]) => tag);
                
                this.patterns = patterns;
                return patterns;
            }
            
            getRecommendations() {
                const prefs = AppState.userPreferences;
                const patterns = this.analyzeUsagePatterns();
                const recommendations = [];
                
                // Get unused tools in preferred category
                if (patterns.mostUsedCategory) {
                    const categoryTools = AppState.tools.filter(tool => 
                        tool.category === patterns.mostUsedCategory &&
                        !prefs.toolUsage[tool.id]
                    );
                    recommendations.push(...categoryTools.slice(0, 3));
                }
                
                // Get tools with preferred tags
                const tagTools = AppState.tools.filter(tool => 
                    !prefs.toolUsage[tool.id] &&
                    tool.tags.some(tag => patterns.preferredTags.includes(tag))
                );
                recommendations.push(...tagTools.slice(0, 3));
                
                // Remove duplicates
                const uniqueRecommendations = Array.from(new Set(recommendations.map(t => t.id)))
                    .map(id => AppState.tools.find(t => t.id === id));
                
                this.recommendations = uniqueRecommendations;
                return uniqueRecommendations;
            }
            
            getSimilarTools(toolId) {
                const tool = AppState.tools.find(t => t.id === toolId);
                if (!tool) return [];
                
                // Find tools with similar tags or category
                const similar = AppState.tools.filter(t => {
                    if (t.id === toolId) return false;
                    
                    const sameCategoryScore = t.category === tool.category ? 2 : 0;
                    const sharedTags = t.tags.filter(tag => tool.tags.includes(tag)).length;
                    const similarityScore = sameCategoryScore + sharedTags;
                    
                    return similarityScore > 0;
                }).sort((a, b) => {
                    // Sort by similarity
                    const aScore = (a.category === tool.category ? 2 : 0) + 
                                  a.tags.filter(tag => tool.tags.includes(tag)).length;
                    const bScore = (b.category === tool.category ? 2 : 0) + 
                                  b.tags.filter(tag => tool.tags.includes(tag)).length;
                    return bScore - aScore;
                });
                
                return similar.slice(0, 5);
            }
        }

        // Keyboard shortcuts
        class KeyboardShortcuts {
            constructor() {
                this.shortcuts = {
                    '/': () => document.getElementById('search-input').focus(),
                    'p': () => document.getElementById('pinned-view-btn').click(),
                    's': () => document.getElementById('settings-btn').click(),
                    'g': () => {
                        if (AppState.currentView === 'pinned') {
                            document.getElementById('back-to-gallery').click();
                        }
                    },
                    '1': () => this.setViewMode('grid'),
                    '2': () => this.setViewMode('list'),
                    '3': () => this.setViewMode('compact'),
                    'r': () => {
                        AppState.userPreferences.sortMode = 'random';
                        document.getElementById('sort-select').value = 'random';
                        saveState();
                        renderGallery();
                    }
                };
                
                this.init();
            }
            
            init() {
                document.addEventListener('keydown', (e) => {
                    // Don't trigger if user is typing in an input
                    if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                        return;
                    }
                    
                    const key = e.key.toLowerCase();
                    if (this.shortcuts[key]) {
                        e.preventDefault();
                        this.shortcuts[key]();
                    }
                });
            }
            
            setViewMode(mode) {
                const button = document.querySelector(`.view-mode-button[data-view="${mode}"]`);
                if (button) {
                    button.click();
                }
            }
        }

        // Tool preview system
        class ToolPreview {
            constructor() {
                this.previewWindow = null;
                this.previewFrame = null;
            }
            
            async createPreview(tool) {
                // Create preview modal
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.95);
                    z-index: 2000;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    backdrop-filter: blur(10px);
                `;
                
                const container = document.createElement('div');
                container.style.cssText = `
                    width: 90%;
                    height: 90%;
                    max-width: 1400px;
                    background: #000;
                    border: 1px solid rgba(255, 255, 255, 0.2);
                    border-radius: 20px;
                    overflow: hidden;
                    display: flex;
                    flex-direction: column;
                `;
                
                const header = document.createElement('div');
                header.style.cssText = `
                    padding: 20px;
                    background: rgba(255, 255, 255, 0.05);
                    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                `;
                
                header.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <span style="font-size: 1.5em;">${tool.icon}</span>
                        <div>
                            <h3 style="font-size: 1.3em; font-weight: 300; margin-bottom: 5px;">${tool.title}</h3>
                            <p style="color: rgba(255, 255, 255, 0.6); font-size: 0.9em;">${tool.description}</p>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button id="preview-open" style="padding: 10px 20px; background: linear-gradient(135deg, #ff006e, #8338ec); border: none; border-radius: 20px; color: white; cursor: pointer;">
                            Open Full
                        </button>
                        <button id="preview-close" style="padding: 10px 20px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 20px; color: white; cursor: pointer;">
                            Close
                        </button>
                    </div>
                `;
                
                const iframe = document.createElement('iframe');
                iframe.src = tool.url;
                iframe.style.cssText = `
                    flex: 1;
                    width: 100%;
                    border: none;
                    background: white;
                `;
                
                container.appendChild(header);
                container.appendChild(iframe);
                modal.appendChild(container);
                document.body.appendChild(modal);
                
                // Event listeners
                document.getElementById('preview-open').addEventListener('click', () => {
                    window.open(tool.url, '_blank');
                    document.body.removeChild(modal);
                });
                
                document.getElementById('preview-close').addEventListener('click', () => {
                    document.body.removeChild(modal);
                });
                
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        document.body.removeChild(modal);
                    }
                });
            }
        }

        // Collections system
        class Collections {
            constructor() {
                this.collections = this.loadCollections();
            }
            
            loadCollections() {
                const saved = localStorage.getItem('vibe_gallery_collections');
                return saved ? JSON.parse(saved) : {
                    'Quick Access': [],
                    'Learning': [],
                    'Projects': [],
                    'Archive': []
                };
            }
            
            saveCollections() {
                localStorage.setItem('vibe_gallery_collections', JSON.stringify(this.collections));
            }
            
            addToCollection(toolId, collectionName) {
                if (!this.collections[collectionName]) {
                    this.collections[collectionName] = [];
                }
                
                if (!this.collections[collectionName].includes(toolId)) {
                    this.collections[collectionName].push(toolId);
                    this.saveCollections();
                    showToast(`Added to ${collectionName}`, 'success');
                }
            }
            
            removeFromCollection(toolId, collectionName) {
                if (this.collections[collectionName]) {
                    const index = this.collections[collectionName].indexOf(toolId);
                    if (index > -1) {
                        this.collections[collectionName].splice(index, 1);
                        this.saveCollections();
                        showToast(`Removed from ${collectionName}`, 'success');
                    }
                }
            }
            
            createCollection(name) {
                if (!this.collections[name]) {
                    this.collections[name] = [];
                    this.saveCollections();
                    showToast(`Collection "${name}" created`, 'success');
                }
            }
            
            deleteCollection(name) {
                if (this.collections[name] && confirm(`Delete collection "${name}"?`)) {
                    delete this.collections[name];
                    this.saveCollections();
                    showToast(`Collection "${name}" deleted`, 'success');
                }
            }
        }

        // Analytics system
        class Analytics {
            constructor() {
                this.data = this.loadAnalytics();
            }
            
            loadAnalytics() {
                const saved = localStorage.getItem('vibe_gallery_analytics');
                return saved ? JSON.parse(saved) : {
                    sessions: [],
                    toolMetrics: {},
                    dailyUsage: {}
                };
            }
            
            saveAnalytics() {
                localStorage.setItem('vibe_gallery_analytics', JSON.stringify(this.data));
            }
            
            trackSession() {
                const session = {
                    start: Date.now(),
                    end: null,
                    toolsViewed: [],
                    toolsUsed: []
                };
                
                this.data.sessions.push(session);
                this.currentSession = session;
                
                // Clean old sessions (keep last 30 days)
                const thirtyDaysAgo = Date.now() - (30 * 24 * 60 * 60 * 1000);
                this.data.sessions = this.data.sessions.filter(s => s.start > thirtyDaysAgo);
                
                this.saveAnalytics();
            }
            
            trackToolView(toolId) {
                if (this.currentSession) {
                    if (!this.currentSession.toolsViewed.includes(toolId)) {
                        this.currentSession.toolsViewed.push(toolId);
                    }
                }
                
                // Update tool metrics
                if (!this.data.toolMetrics[toolId]) {
                    this.data.toolMetrics[toolId] = {
                        views: 0,
                        uses: 0,
                        lastViewed: null,
                        lastUsed: null
                    };
                }
                
                this.data.toolMetrics[toolId].views++;
                this.data.toolMetrics[toolId].lastViewed = Date.now();
                
                // Update daily usage
                const today = new Date().toISOString().split('T')[0];
                if (!this.data.dailyUsage[today]) {
                    this.data.dailyUsage[today] = {
                        views: 0,
                        uses: 0,
                        uniqueTools: new Set()
                    };
                }
                this.data.dailyUsage[today].views++;
                this.data.dailyUsage[today].uniqueTools.add(toolId);
                
                this.saveAnalytics();
            }
            
            trackToolUse(toolId) {
                this.trackToolView(toolId);
                
                if (this.currentSession) {
                    if (!this.currentSession.toolsUsed.includes(toolId)) {
                        this.currentSession.toolsUsed.push(toolId);
                    }
                }
                
                this.data.toolMetrics[toolId].uses++;
                this.data.toolMetrics[toolId].lastUsed = Date.now();
                
                const today = new Date().toISOString().split('T')[0];
                this.data.dailyUsage[today].uses++;
                
                this.saveAnalytics();
            }
            
            getInsights() {
                const insights = {
                    totalSessions: this.data.sessions.length,
                    averageSessionTools: 0,
                    mostViewedTools: [],
                    mostUsedTools: [],
                    recentActivity: [],
                    dailyTrend: []
                };
                
                // Calculate average tools per session
                if (this.data.sessions.length > 0) {
                    const totalTools = this.data.sessions.reduce((sum, s) => sum + s.toolsUsed.length, 0);
                    insights.averageSessionTools = Math.round(totalTools / this.data.sessions.length);
                }
                
                // Get most viewed/used tools
                const toolMetrics = Object.entries(this.data.toolMetrics);
                insights.mostViewedTools = toolMetrics
                    .sort((a, b) => b[1].views - a[1].views)
                    .slice(0, 5)
                    .map(([id, metrics]) => ({
                        tool: AppState.tools.find(t => t.id === id),
                        views: metrics.views
                    }));
                
                insights.mostUsedTools = toolMetrics
                    .sort((a, b) => b[1].uses - a[1].uses)
                    .slice(0, 5)
                    .map(([id, metrics]) => ({
                        tool: AppState.tools.find(t => t.id === id),
                        uses: metrics.uses
                    }));
                
                // Get daily trend (last 7 days)
                const last7Days = [];
                for (let i = 6; i >= 0; i--) {
                    const date = new Date();
                    date.setDate(date.getDate() - i);
                    const dateStr = date.toISOString().split('T')[0];
                    const dayData = this.data.dailyUsage[dateStr] || { views: 0, uses: 0 };
                    last7Days.push({
                        date: dateStr,
                        views: dayData.views,
                        uses: dayData.uses
                    });
                }
                insights.dailyTrend = last7Days;
                
                return insights;
            }
        }

        // Initialize systems
        const discoveryEngine = new DiscoveryEngine();
        const keyboardShortcuts = new KeyboardShortcuts();
        const toolPreview = new ToolPreview();
        const collections = new Collections();
        const analytics = new Analytics();

        // Start analytics session
        analytics.trackSession();

        // Enhanced tool action handler with analytics
        const originalHandleToolAction = handleToolAction;
        handleToolAction = function(tool, action) {
            if (action === 'open') {
                analytics.trackToolUse(tool.id);
            } else if (action === 'view') {
                analytics.trackToolView(tool.id);
            }
            originalHandleToolAction(tool, action);
        };

        // Initialize application when DOM is ready
        document.addEventListener('DOMContentLoaded', init);

        // Save session end on page unload
        window.addEventListener('beforeunload', () => {
            if (analytics.currentSession) {
                analytics.currentSession.end = Date.now();
                analytics.saveAnalytics();
            }
            saveState();
        });
    </script>
</body>
</html>