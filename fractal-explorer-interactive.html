<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fractal Explorer Interactive</title>
    <meta name="description" content="Interactive fractal generator with Mandelbrot, Julia sets, Burning Ship, zoom navigation, color palettes, and high-resolution export">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            height: 100vh;
            overflow: hidden;
            color: #e0e0e0;
        }
        #app { display: flex; height: 100vh; }
        #sidebar {
            width: 320px;
            background: rgba(20, 20, 40, 0.95);
            padding: 20px;
            overflow-y: auto;
            border-right: 2px solid #8a2be2;
        }
        h1 { font-size: 18px; color: #8a2be2; margin-bottom: 20px; }
        .section {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }
        .section h3 {
            font-size: 12px;
            color: #8a2be2;
            margin-bottom: 12px;
            text-transform: uppercase;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-size: 11px;
            color: #aaa;
        }
        input[type="range"] {
            width: 100%;
            margin-bottom: 15px;
        }
        input[type="number"] {
            width: 100%;
            padding: 8px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #8a2be2;
            color: #e0e0e0;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        select {
            width: 100%;
            padding: 8px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #8a2be2;
            color: #e0e0e0;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        button {
            width: 100%;
            padding: 10px;
            background: #8a2be2;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 8px;
            font-weight: bold;
        }
        button:hover { background: #9b4dca; }
        .value-display {
            float: right;
            color: #8a2be2;
            font-weight: bold;
        }
        #main { flex: 1; display: flex; flex-direction: column; }
        #header {
            background: rgba(20, 20, 40, 0.95);
            padding: 15px 20px;
            border-bottom: 2px solid #8a2be2;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        #canvas-container {
            flex: 1;
            position: relative;
            overflow: hidden;
            cursor: crosshair;
        }
        canvas {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            image-rendering: pixelated;
        }
        .preset-btn {
            padding: 10px;
            background: rgba(138, 43, 226, 0.2);
            border: 1px solid #8a2be2;
            color: #e0e0e0;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 8px;
            text-align: center;
            font-size: 12px;
        }
        .preset-btn:hover { background: rgba(138, 43, 226, 0.4); }
        #controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(20, 20, 40, 0.9);
            padding: 15px;
            border-radius: 8px;
            font-size: 11px;
            border: 1px solid #8a2be2;
        }
        .control-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            gap: 15px;
        }
        .control-value {
            color: #8a2be2;
            font-weight: bold;
            font-family: 'Courier New', monospace;
        }
        .info-text {
            font-size: 11px;
            color: #aaa;
            line-height: 1.5;
            margin-top: 10px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(138, 43, 226, 0.9);
            padding: 20px 40px;
            border-radius: 8px;
            font-weight: bold;
            z-index: 100;
        }
    </style>
</head>
<body>
    <div id="app">
        <div id="sidebar">
            <h1>üåÄ Fractal Explorer</h1>

            <div class="section">
                <h3>Fractal Type</h3>
                <select id="fractalType">
                    <option value="mandelbrot">Mandelbrot Set</option>
                    <option value="julia">Julia Set</option>
                    <option value="burning-ship">Burning Ship</option>
                    <option value="tricorn">Tricorn</option>
                </select>
            </div>

            <div class="section">
                <h3>Julia Parameters</h3>
                <label>Real (C.x) <span class="value-display" id="juliaRealVal">-0.7</span></label>
                <input type="range" id="juliaReal" min="-2" max="2" step="0.01" value="-0.7">

                <label>Imaginary (C.y) <span class="value-display" id="juliaImagVal">0.27</span></label>
                <input type="range" id="juliaImag" min="-2" max="2" step="0.01" value="0.27">
            </div>

            <div class="section">
                <h3>Rendering</h3>
                <label>Max Iterations <span class="value-display" id="iterVal">256</span></label>
                <input type="range" id="maxIterations" min="50" max="1000" step="50" value="256">

                <label>Color Scheme</label>
                <select id="colorScheme">
                    <option value="rainbow">Rainbow</option>
                    <option value="fire">Fire</option>
                    <option value="ocean">Ocean</option>
                    <option value="grayscale">Grayscale</option>
                    <option value="psychedelic">Psychedelic</option>
                    <option value="electric">Electric</option>
                </select>

                <label>Color Density <span class="value-display" id="colorDensityVal">10</span></label>
                <input type="range" id="colorDensity" min="1" max="50" value="10">

                <label>Resolution</label>
                <select id="resolution">
                    <option value="800">800x600</option>
                    <option value="1280" selected>1280x720</option>
                    <option value="1920">1920x1080</option>
                    <option value="2560">2560x1440</option>
                </select>
            </div>

            <div class="section">
                <h3>Famous Locations</h3>
                <div class="preset-btn" onclick="loadLocation('mandelbrot-full')">üåå Full Mandelbrot</div>
                <div class="preset-btn" onclick="loadLocation('seahorse-valley')">üê¥ Seahorse Valley</div>
                <div class="preset-btn" onclick="loadLocation('elephant-valley')">üêò Elephant Valley</div>
                <div class="preset-btn" onclick="loadLocation('spiral')">üåÄ Spiral</div>
                <div class="preset-btn" onclick="loadLocation('mini-mandel')">‚ú® Mini Mandelbrot</div>
            </div>

            <div class="section">
                <h3>Actions</h3>
                <button onclick="render()">üîÑ Re-render</button>
                <button onclick="resetView()">üè† Reset View</button>
                <button onclick="exportImage()">üíæ Export PNG</button>
            </div>

            <div class="info-text">
                <strong>Controls:</strong><br>
                ‚Ä¢ Click to zoom in<br>
                ‚Ä¢ Right-click to zoom out<br>
                ‚Ä¢ Drag to pan<br>
                ‚Ä¢ Scroll to zoom
            </div>
        </div>

        <div id="main">
            <div id="header">
                <h2 style="color: #8a2be2;">Interactive Fractal Generator</h2>
                <div style="font-size: 12px; color: #aaa;">
                    Click to zoom in, right-click to zoom out
                </div>
            </div>

            <div id="canvas-container">
                <canvas id="canvas"></canvas>
                <div id="controls">
                    <div class="control-row">
                        <span>Center X:</span>
                        <span class="control-value" id="centerX">0</span>
                    </div>
                    <div class="control-row">
                        <span>Center Y:</span>
                        <span class="control-value" id="centerY">0</span>
                    </div>
                    <div class="control-row">
                        <span>Zoom:</span>
                        <span class="control-value" id="zoomLevel">1.0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let params = {
            fractalType: 'mandelbrot',
            centerX: -0.5,
            centerY: 0,
            zoom: 1,
            maxIterations: 256,
            colorScheme: 'rainbow',
            colorDensity: 10,
            resolution: 1280,
            juliaReal: -0.7,
            juliaImag: 0.27
        };

        let isDragging = false;
        let dragStartX = 0;
        let dragStartY = 0;
        let dragStartCenterX = 0;
        let dragStartCenterY = 0;

        function resizeCanvas() {
            const res = parseInt(params.resolution);
            canvas.width = res;
            canvas.height = Math.floor(res * 0.75);
        }

        function pixelToComplex(px, py) {
            const aspectRatio = canvas.width / canvas.height;
            const range = 4 / params.zoom;

            const x = params.centerX + (px / canvas.width - 0.5) * range * aspectRatio;
            const y = params.centerY + (py / canvas.height - 0.5) * range;

            return { x, y };
        }

        function mandelbrot(x0, y0, maxIter) {
            let x = 0, y = 0;
            let iteration = 0;

            while (x * x + y * y <= 4 && iteration < maxIter) {
                const xtemp = x * x - y * y + x0;
                y = 2 * x * y + y0;
                x = xtemp;
                iteration++;
            }

            return iteration;
        }

        function julia(x0, y0, cx, cy, maxIter) {
            let x = x0, y = y0;
            let iteration = 0;

            while (x * x + y * y <= 4 && iteration < maxIter) {
                const xtemp = x * x - y * y + cx;
                y = 2 * x * y + cy;
                x = xtemp;
                iteration++;
            }

            return iteration;
        }

        function burningShip(x0, y0, maxIter) {
            let x = 0, y = 0;
            let iteration = 0;

            while (x * x + y * y <= 4 && iteration < maxIter) {
                const xtemp = x * x - y * y + x0;
                y = Math.abs(2 * x * y) + y0;
                x = Math.abs(xtemp);
                iteration++;
            }

            return iteration;
        }

        function tricorn(x0, y0, maxIter) {
            let x = 0, y = 0;
            let iteration = 0;

            while (x * x + y * y <= 4 && iteration < maxIter) {
                const xtemp = x * x - y * y + x0;
                y = -2 * x * y + y0;
                x = xtemp;
                iteration++;
            }

            return iteration;
        }

        function getColor(iteration, maxIter) {
            if (iteration === maxIter) {
                return { r: 0, g: 0, b: 0 };
            }

            const t = iteration / params.colorDensity;

            switch (params.colorScheme) {
                case 'rainbow':
                    return {
                        r: Math.floor(Math.sin(0.016 * t + 0) * 127 + 128),
                        g: Math.floor(Math.sin(0.013 * t + 2) * 127 + 128),
                        b: Math.floor(Math.sin(0.01 * t + 4) * 127 + 128)
                    };

                case 'fire':
                    return {
                        r: Math.min(255, Math.floor(t * 8)),
                        g: Math.min(255, Math.floor(t * 4)),
                        b: Math.floor(t * 2)
                    };

                case 'ocean':
                    return {
                        r: Math.floor(t * 2),
                        g: Math.floor(t * 4),
                        b: Math.min(255, Math.floor(t * 8))
                    };

                case 'grayscale':
                    const gray = Math.floor((iteration / maxIter) * 255);
                    return { r: gray, g: gray, b: gray };

                case 'psychedelic':
                    return {
                        r: Math.floor(Math.abs(Math.sin(t * 0.1)) * 255),
                        g: Math.floor(Math.abs(Math.cos(t * 0.15)) * 255),
                        b: Math.floor(Math.abs(Math.sin(t * 0.2)) * 255)
                    };

                case 'electric':
                    return {
                        r: Math.floor(Math.abs(Math.sin(t * 0.05)) * 255),
                        g: 0,
                        b: Math.floor(Math.abs(Math.cos(t * 0.05)) * 255)
                    };

                default:
                    return { r: 255, g: 255, b: 255 };
            }
        }

        async function render() {
            const imageData = ctx.createImageData(canvas.width, canvas.height);
            const data = imageData.data;

            const showLoading = document.createElement('div');
            showLoading.className = 'loading';
            showLoading.textContent = 'Rendering...';
            document.getElementById('canvas-container').appendChild(showLoading);

            // Small delay to show loading indicator
            await new Promise(resolve => setTimeout(resolve, 10));

            for (let py = 0; py < canvas.height; py++) {
                for (let px = 0; px < canvas.width; px++) {
                    const c = pixelToComplex(px, py);
                    let iteration;

                    switch (params.fractalType) {
                        case 'mandelbrot':
                            iteration = mandelbrot(c.x, c.y, params.maxIterations);
                            break;
                        case 'julia':
                            iteration = julia(c.x, c.y, params.juliaReal, params.juliaImag, params.maxIterations);
                            break;
                        case 'burning-ship':
                            iteration = burningShip(c.x, c.y, params.maxIterations);
                            break;
                        case 'tricorn':
                            iteration = tricorn(c.x, c.y, params.maxIterations);
                            break;
                    }

                    const color = getColor(iteration, params.maxIterations);
                    const index = (py * canvas.width + px) * 4;

                    data[index] = color.r;
                    data[index + 1] = color.g;
                    data[index + 2] = color.b;
                    data[index + 3] = 255;
                }

                // Update progress periodically
                if (py % 50 === 0) {
                    await new Promise(resolve => setTimeout(resolve, 0));
                }
            }

            ctx.putImageData(imageData, 0, 0);
            showLoading.remove();
            updateDisplay();
        }

        function updateDisplay() {
            document.getElementById('centerX').textContent = params.centerX.toFixed(10);
            document.getElementById('centerY').textContent = params.centerY.toFixed(10);
            document.getElementById('zoomLevel').textContent = params.zoom.toExponential(2);
        }

        function loadLocation(name) {
            const locations = {
                'mandelbrot-full': { centerX: -0.5, centerY: 0, zoom: 1, type: 'mandelbrot' },
                'seahorse-valley': { centerX: -0.7435, centerY: 0.1314, zoom: 1000, type: 'mandelbrot' },
                'elephant-valley': { centerX: 0.275, centerY: 0, zoom: 100, type: 'mandelbrot' },
                'spiral': { centerX: -0.7490, centerY: 0.1074, zoom: 50000, type: 'mandelbrot' },
                'mini-mandel': { centerX: -1.7700, centerY: 0.0, zoom: 15000, type: 'mandelbrot' }
            };

            const loc = locations[name];
            if (loc) {
                params.centerX = loc.centerX;
                params.centerY = loc.centerY;
                params.zoom = loc.zoom;
                params.fractalType = loc.type;
                document.getElementById('fractalType').value = loc.type;
                render();
            }
        }

        function resetView() {
            if (params.fractalType === 'mandelbrot') {
                params.centerX = -0.5;
                params.centerY = 0;
            } else {
                params.centerX = 0;
                params.centerY = 0;
            }
            params.zoom = 1;
            render();
        }

        function exportImage() {
            const link = document.createElement('a');
            link.download = `fractal-${params.fractalType}-${Date.now()}.png`;
            link.href = canvas.toDataURL();
            link.click();
        }

        // Event listeners
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const px = e.clientX - rect.left;
            const py = e.clientY - rect.top;
            const c = pixelToComplex(px, py);

            params.centerX = c.x;
            params.centerY = c.y;
            params.zoom *= 2;
            render();
        });

        canvas.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            params.zoom /= 2;
            render();
        });

        canvas.addEventListener('mousedown', (e) => {
            if (e.button === 1 || e.shiftKey) { // Middle mouse or shift+click for pan
                isDragging = true;
                dragStartX = e.clientX;
                dragStartY = e.clientY;
                dragStartCenterX = params.centerX;
                dragStartCenterY = params.centerY;
                canvas.style.cursor = 'grabbing';
                e.preventDefault();
            }
        });

        canvas.addEventListener('mousemove', (e) => {
            if (isDragging) {
                const dx = e.clientX - dragStartX;
                const dy = e.clientY - dragStartY;
                const range = 4 / params.zoom;

                params.centerX = dragStartCenterX - (dx / canvas.width) * range * (canvas.width / canvas.height);
                params.centerY = dragStartCenterY - (dy / canvas.height) * range;

                updateDisplay();
            }
        });

        canvas.addEventListener('mouseup', () => {
            if (isDragging) {
                isDragging = false;
                canvas.style.cursor = 'crosshair';
                render();
            }
        });

        canvas.addEventListener('wheel', (e) => {
            e.preventDefault();
            if (e.deltaY < 0) {
                params.zoom *= 1.2;
            } else {
                params.zoom /= 1.2;
            }
            render();
        });

        // Parameter controls
        document.getElementById('fractalType').addEventListener('change', (e) => {
            params.fractalType = e.target.value;
            resetView();
        });

        document.getElementById('maxIterations').addEventListener('input', (e) => {
            params.maxIterations = parseInt(e.target.value);
            document.getElementById('iterVal').textContent = params.maxIterations;
        });

        document.getElementById('maxIterations').addEventListener('change', render);

        document.getElementById('colorScheme').addEventListener('change', (e) => {
            params.colorScheme = e.target.value;
            render();
        });

        document.getElementById('colorDensity').addEventListener('input', (e) => {
            params.colorDensity = parseFloat(e.target.value);
            document.getElementById('colorDensityVal').textContent = params.colorDensity;
        });

        document.getElementById('colorDensity').addEventListener('change', render);

        document.getElementById('resolution').addEventListener('change', (e) => {
            params.resolution = e.target.value;
            resizeCanvas();
            render();
        });

        document.getElementById('juliaReal').addEventListener('input', (e) => {
            params.juliaReal = parseFloat(e.target.value);
            document.getElementById('juliaRealVal').textContent = params.juliaReal.toFixed(2);
        });

        document.getElementById('juliaReal').addEventListener('change', () => {
            if (params.fractalType === 'julia') render();
        });

        document.getElementById('juliaImag').addEventListener('input', (e) => {
            params.juliaImag = parseFloat(e.target.value);
            document.getElementById('juliaImagVal').textContent = params.juliaImag.toFixed(2);
        });

        document.getElementById('juliaImag').addEventListener('change', () => {
            if (params.fractalType === 'julia') render();
        });

        // Initialize
        resizeCanvas();
        render();
    </script>
</body>
</html>