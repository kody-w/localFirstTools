<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tilt Insurance - Dual View Demo Player</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background: #1a1a1a;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            color: #323130;
        }

        .video-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            background: #000;
            padding: 20px;
        }

        .screen-frame {
            width: 100%;
            max-width: 1600px;
            height: calc(100vh - 140px);
            max-height: 900px;
            background: #faf9f8;
            border-radius: 8px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            display: flex;
            overflow: hidden;
            position: relative;
        }

        .admin-button {
            position: absolute;
            left: -140px;
            top: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            z-index: 101;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .admin-button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        .step-indicator {
            position: absolute;
            top: -50px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            z-index: 100;
            font-weight: 600;
            transition: opacity 0.3s ease;
        }

        .narrator-overlay {
            position: absolute;
            top: 40px;
            right: 40px;
            width: 420px;
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 32px;
            border-radius: 16px;
            z-index: 1000;
            display: none;
            animation: slideIn 0.5s ease;
            box-shadow: 0 12px 48px rgba(0, 0, 0, 0.8);
            border: 2px solid rgba(102, 126, 234, 0.3);
        }

        .narrator-overlay.active {
            display: block;
        }

        .narrator-overlay.center {
            left: 50%;
            transform: translateX(-50%);
            top: 50%;
            transform: translate(-50%, -50%);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .narrator-title {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #8b9aff;
            line-height: 1.3;
        }

        .narrator-text {
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 20px;
            color: #ffffff;
        }

        .narrator-subtitle {
            font-size: 14px;
            color: #a0a0a0;
            margin-top: 16px;
            font-style: italic;
            padding-top: 16px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .narrator-continue {
            padding: 14px 32px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 20px;
        }

        .narrator-continue:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
        }

        .dual-view-container {
            display: flex;
            flex: 1;
            gap: 0;
            background: #e5e5e5;
        }

        .customer-view {
            flex: 0 0 420px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #2a2a2a;
            padding: 20px;
        }

        .mobile-frame {
            width: 375px;
            height: 812px;
            background: #1a1a1a;
            border-radius: 42px;
            padding: 12px;
            box-shadow: 
                0 0 0 2px #333,
                0 20px 60px rgba(0, 0, 0, 0.4);
            position: relative;
        }

        .mobile-notch {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 150px;
            height: 28px;
            background: #1a1a1a;
            border-radius: 0 0 20px 20px;
            z-index: 10;
        }

        .mobile-screen {
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 32px;
            overflow: hidden;
            position: relative;
        }

        .customer-label {
            margin-top: 16px;
            text-align: center;
            color: #fff;
            font-size: 13px;
            font-weight: 500;
            padding: 6px 16px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .mobile-content {
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .mobile-header {
            padding: 48px 20px 20px;
            background: linear-gradient(135deg, #4D5FFF 0%, #5B6FFF 100%);
            color: white;
            position: relative;
        }

        .mobile-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .tilt-logo {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }

        .mobile-subtitle {
            font-size: 14px;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .mobile-body {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .progress-dots {
            display: flex;
            gap: 8px;
            justify-content: center;
            padding: 16px 0;
        }

        .progress-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #E0E0E0;
            transition: all 0.3s;
        }

        .progress-dot.active {
            background: #4D5FFF;
            width: 24px;
            border-radius: 4px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #323130;
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #d2d0ce;
            border-radius: 8px;
            font-size: 15px;
            outline: none;
            transition: border-color 0.2s;
        }

        .form-input:focus {
            border-color: #4D5FFF;
        }

        .coverage-card {
            border: 2px solid #E0E0E0;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }

        .coverage-card:hover {
            border-color: #4D5FFF;
            background: #F7F8FF;
        }

        .coverage-card.selected {
            border-color: #4D5FFF;
            background: #F0F2FF;
        }

        .coverage-title {
            font-size: 16px;
            font-weight: 600;
            color: #323130;
            margin-bottom: 4px;
        }

        .coverage-desc {
            font-size: 13px;
            color: #605e5c;
        }

        .package-card {
            border: 2px solid #E0E0E0;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }

        .package-card:hover {
            border-color: #4D5FFF;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(77, 95, 255, 0.15);
        }

        .package-card.recommended {
            border-color: #4D5FFF;
            background: linear-gradient(135deg, #4D5FFF 0%, #5B6FFF 100%);
            color: white;
        }

        .package-card.recommended .package-name,
        .package-card.recommended .package-price,
        .package-card.recommended .package-features li {
            color: white;
        }

        .package-card.recommended::before {
            content: 'Selected';
            position: absolute;
            top: 16px;
            right: 16px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            letter-spacing: 0.3px;
        }

        .package-card.recommended::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
            pointer-events: none;
            border-radius: 16px;
        }

        .package-name {
            font-size: 18px;
            font-weight: 700;
            color: #323130;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }

        .package-price {
            font-size: 28px;
            font-weight: 700;
            color: #323130;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
        }

        .package-price span {
            font-size: 14px;
            color: #605e5c;
            font-weight: 500;
        }

        .package-card.recommended .package-price span {
            color: rgba(255, 255, 255, 0.8);
        }

        .package-features {
            list-style: none;
            margin-bottom: 16px;
            position: relative;
            z-index: 1;
        }

        .package-features li {
            padding: 6px 0;
            font-size: 14px;
            color: #323130;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .package-features li::before {
            content: 'âœ“';
            color: #10b981;
            font-weight: 600;
        }

        .package-card.recommended .package-features li::before {
            color: white;
        }

        .mobile-button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #4D5FFF, #5B6FFF);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .mobile-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(77, 95, 255, 0.3);
        }

        .mobile-button.secondary {
            background: white;
            color: #4D5FFF;
            border: 2px solid #4D5FFF;
        }

        .sync-indicator {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            color: #10b981;
            padding: 4px 10px;
            background: #d4edda;
            border-radius: 12px;
            margin-top: 8px;
        }

        .sync-indicator::before {
            content: '';
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #10b981;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .confirmation-container {
            text-align: center;
            padding: 40px 20px;
        }

        .success-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            margin: 0 auto 20px;
        }

        .confirmation-title {
            font-size: 24px;
            font-weight: 700;
            color: #323130;
            margin-bottom: 12px;
        }

        .confirmation-text {
            font-size: 15px;
            color: #605e5c;
            line-height: 1.6;
            margin-bottom: 24px;
        }

        .policy-details {
            background: #f8f9ff;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-size: 14px;
            color: #605e5c;
        }

        .detail-value {
            font-size: 14px;
            font-weight: 600;
            color: #323130;
        }

        .sidebar {
            width: 260px;
            background: #ffffff;
            display: flex;
            flex-direction: column;
            border-right: 1px solid #edebe9;
        }

        .sidebar-header {
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid #edebe9;
            height: 48px;
        }

        .copilot-icon {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #b4a0ff 0%, #ff7eb9 50%, #7ee7fc 100%);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .copilot-icon::before {
            content: '';
            position: absolute;
            width: 12px;
            height: 12px;
            background: white;
            border-radius: 2px;
            opacity: 0.9;
        }

        .sidebar-title {
            font-size: 14px;
            font-weight: 600;
            color: #323130;
        }

        .sidebar-button {
            margin-left: auto;
            background: none;
            border: none;
            padding: 4px;
            cursor: pointer;
            color: #605e5c;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            width: 32px;
            height: 32px;
        }

        .sidebar-button:hover {
            background: #f3f2f1;
        }

        .search-container {
            padding: 8px 16px;
            border-bottom: 1px solid #edebe9;
        }

        .search-box {
            position: relative;
            width: 100%;
        }

        .search-icon {
            position: absolute;
            left: 8px;
            top: 50%;
            transform: translateY(-50%);
            color: #605e5c;
            font-size: 14px;
        }

        .search-input {
            width: 100%;
            padding: 6px 8px 6px 32px;
            border: 1px solid #d2d0ce;
            border-radius: 4px;
            font-size: 14px;
            background: #faf9f8;
            outline: none;
            transition: all 0.2s;
        }

        .search-input:focus {
            border-color: #605e5c;
            background: #ffffff;
        }

        .nav-section {
            flex: 1;
            overflow-y: auto;
            padding: 4px 0;
        }

        .nav-item {
            padding: 8px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            font-size: 14px;
            color: #323130;
            transition: background 0.1s;
            position: relative;
            user-select: none;
        }

        .nav-item:hover {
            background: #f3f2f1;
        }

        .nav-item.active {
            background: #f3f2f1;
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 8px;
            bottom: 8px;
            width: 2px;
            background: #5b5fc7;
            border-radius: 1px;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .nav-icon-circle {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #e74856;
        }

        .nav-icon-bot {
            width: 16px;
            height: 16px;
            border-radius: 4px;
            background: #0078d4;
            position: relative;
        }

        .nav-icon-bot::before {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            right: 3px;
            height: 4px;
            background: white;
            border-radius: 1px;
        }

        .nav-icon-bot::after {
            content: '';
            position: absolute;
            bottom: 3px;
            left: 3px;
            right: 3px;
            height: 4px;
            background: white;
            border-radius: 1px;
        }

        .nav-expand {
            margin-left: auto;
            color: #605e5c;
            font-size: 10px;
            transition: transform 0.2s;
        }

        .nav-expand.expanded {
            transform: rotate(180deg);
        }

        .nav-dropdown {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.2s ease;
        }

        .nav-dropdown.expanded {
            max-height: 400px;
        }

        .dropdown-item {
            padding: 6px 16px 6px 48px;
            font-size: 14px;
            color: #605e5c;
            cursor: pointer;
            transition: background 0.1s;
        }

        .dropdown-item:hover {
            background: #f3f2f1;
            color: #323130;
        }

        .sidebar-bottom {
            border-top: 1px solid #edebe9;
            padding: 8px 0;
        }

        .user-section {
            padding: 8px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: background 0.1s;
        }

        .user-section:hover {
            background: #f3f2f1;
        }

        .user-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #5b5fc7;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }

        .user-name {
            font-size: 14px;
            color: #323130;
        }

        .user-menu {
            margin-left: auto;
            color: #605e5c;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #faf9f8;
            overflow: hidden;
        }

        .content-header {
            height: 48px;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #ffffff;
            border-bottom: 1px solid #edebe9;
        }

        .header-left {
            display: flex;
            align-items: center;
        }

        .header-title {
            font-size: 14px;
            color: #605e5c;
            font-weight: 400;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .gpt-selector {
            padding: 6px 12px;
            border: 1px solid #d2d0ce;
            border-radius: 4px;
            background: white;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            color: #323130;
            transition: all 0.2s;
        }

        .gpt-selector:hover {
            border-color: #605e5c;
        }

        .header-icon-button {
            width: 32px;
            height: 32px;
            border: none;
            background: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            color: #605e5c;
            transition: background 0.1s;
        }

        .header-icon-button:hover {
            background: #f3f2f1;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 14px;
            background: #f3f2f1;
            border-radius: 6px;
            font-size: 13px;
            color: #605e5c;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #10b981;
        }

        .status-dot.processing {
            background: #f59e0b;
            animation: pulse 1s infinite;
        }

        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px 60px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .chat-messages > * {
            max-width: 900px;
            width: 100%;
            margin: 0 auto;
        }

        .message {
            display: flex;
            opacity: 0;
            transform: translateY(10px);
            animation: messageSlide 0.5s forwards;
        }

        @keyframes messageSlide {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            justify-content: flex-end;
        }

        .message.user .message-wrapper {
            max-width: 60%;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .message.user .message-content-wrapper {
            background: #e3f2fd;
            padding: 12px 16px;
            border-radius: 12px 12px 4px 12px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .message.user .message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            flex-direction: row-reverse;
        }

        .message.user .message-content {
            margin: 0;
            text-align: left;
            font-size: 14px;
            line-height: 1.6;
            color: #323130;
            white-space: pre-wrap;
        }

        .message.agent {
            justify-content: flex-start;
        }

        .message.agent .message-wrapper {
            max-width: 60%;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .message.agent .message-content-wrapper {
            background: white;
            padding: 12px 16px;
            border-radius: 12px 12px 12px 4px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #edebe9;
        }

        .message.agent .message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .message.agent .message-content {
            font-size: 14px;
            line-height: 1.6;
            color: #323130;
            white-space: pre-wrap;
        }

        .message.system {
            justify-content: center;
        }

        .message.system .message-wrapper {
            max-width: 50%;
            background: #f3f2f1;
            padding: 8px 16px;
            border-radius: 16px;
            text-align: center;
        }

        .message.system .message-content {
            font-size: 13px;
            color: #605e5c;
            margin: 0;
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .message-avatar-user {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #5b5fc7;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }

        .message-avatar-agent {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            background: linear-gradient(135deg, #b4a0ff 0%, #ff7eb9 50%, #7ee7fc 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
        }

        .message-author {
            font-size: 14px;
            font-weight: 600;
            color: #323130;
        }

        .message-tag {
            padding: 2px 8px;
            background: #f3f2f1;
            border-radius: 4px;
            font-size: 12px;
            color: #605e5c;
        }

        .message-time {
            font-size: 12px;
            color: #a19f9d;
        }

        .message-content {
            font-size: 14px;
            line-height: 1.6;
            color: #323130;
            white-space: pre-wrap;
        }

        .agent-card {
            margin-top: 12px;
            background: white;
            border: 1px solid #edebe9;
            border-radius: 8px;
            overflow: hidden;
            opacity: 0;
            transform: scale(0.98);
            animation: cardAppear 0.5s forwards 0.3s;
        }

        @keyframes cardAppear {
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .agent-card-header {
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid #edebe9;
            background: linear-gradient(135deg, rgba(180, 160, 255, 0.05) 0%, rgba(255, 126, 185, 0.05) 100%);
            font-size: 14px;
        }

        .agent-card-title {
            font-size: 15px;
            font-weight: 600;
            color: #323130;
        }

        .agent-card-status {
            margin-left: auto;
            padding: 4px 12px;
            background: #10b981;
            color: white;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .agent-card-status.warning {
            background: #f59e0b;
        }

        .agent-card-status.critical {
            background: #ef4444;
        }

        .detail-list {
            list-style: none;
            padding: 16px;
        }

        .detail-item {
            padding: 8px 0;
            font-size: 14px;
            color: #323130;
            display: flex;
            gap: 10px;
            border-bottom: 1px solid #f3f2f1;
        }

        .detail-item:last-child {
            border-bottom: none;
        }

        .detail-item-label {
            font-weight: 600;
            min-width: 160px;
            color: #605e5c;
            font-size: 13px;
        }

        .detail-item-value {
            flex: 1;
            font-size: 13px;
        }

        .input-container {
            padding: 16px 20px;
            background: white;
            border-top: 1px solid #edebe9;
        }

        .input-wrapper {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
        }

        .input-field {
            width: 100%;
            padding: 10px 120px 10px 16px;
            border: 1px solid #d2d0ce;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            resize: none;
            outline: none;
            background: #faf9f8;
            transition: all 0.2s;
            min-height: 44px;
            max-height: 120px;
            line-height: 1.5;
        }

        .input-field:focus {
            border-color: #605e5c;
            background: white;
        }

        .input-actions {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: 4px;
        }

        .input-button {
            width: 28px;
            height: 28px;
            border: none;
            background: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            color: #605e5c;
            transition: all 0.1s;
        }

        .input-button:hover {
            background: #f3f2f1;
        }

        .input-button.send {
            color: #5b5fc7;
        }

        .input-button svg {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

        .video-controls {
            height: 100px;
            background: linear-gradient(to bottom, #2a2a2a, #1a1a1a);
            display: flex;
            align-items: center;
            padding: 0 30px;
            border-top: 1px solid #333;
        }

        .controls-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .control-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #333;
            border: 2px solid #444;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.2s;
        }

        .control-btn:hover:not(:disabled) {
            background: #444;
            border-color: #667eea;
            transform: scale(1.05);
        }

        .control-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .control-btn.play {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-color: #667eea;
            width: 56px;
            height: 56px;
        }

        .control-btn svg {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }

        .progress-container {
            flex: 1;
            margin: 0 40px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
            color: #999;
        }

        .progress-bar {
            height: 8px;
            background: #333;
            border-radius: 4px;
            position: relative;
            cursor: pointer;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, #667eea, #764ba2);
            border-radius: 4px;
            width: 0%;
            transition: width 0.3s ease;
        }

        .controls-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .mode-toggle {
            display: flex;
            background: #333;
            border-radius: 20px;
            padding: 4px;
        }

        .mode-btn {
            padding: 8px 16px;
            background: transparent;
            border: none;
            color: #999;
            cursor: pointer;
            border-radius: 16px;
            font-size: 13px;
            transition: all 0.2s;
        }

        .mode-btn.active {
            background: #667eea;
            color: white;
        }

        .narrator-toggle, .audio-toggle, .fullscreen-btn {
            padding: 8px 14px;
            background: #333;
            border: 1px solid #444;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
        }

        .narrator-toggle.active, .audio-toggle.active {
            background: #667eea;
            border-color: #667eea;
        }

        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            border-radius: 8px;
            padding: 16px 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            display: none;
            align-items: center;
            gap: 12px;
            z-index: 10001;
        }

        .toast.show {
            display: flex;
            animation: slideInRight 0.3s ease;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .toast-icon {
            font-size: 20px;
        }

        .toast.success .toast-icon {
            color: #10b981;
        }

        .toast.error .toast-icon {
            color: #ef4444;
        }

        .toast-message {
            font-size: 14px;
            color: #323130;
        }
    </style>
</head>
<body>
    <div class="narrator-overlay" id="narratorOverlay">
        <div class="narrator-title" id="narratorTitle">Welcome</div>
        <div class="narrator-text" id="narratorText">
            Load a demo script to begin your interactive presentation.
        </div>
        <div class="narrator-subtitle" id="narratorSubtitle">Demo narration</div>
        <button class="narrator-continue" id="narratorContinue" onclick="continueDemo()">Continue</button>
    </div>

    <div class="video-container">
        <button class="admin-button" onclick="openSettings()">Configure</button>

        <div class="step-indicator" id="stepIndicator">
            Step <span id="currentStep">1</span> of <span id="totalSteps">1</span>
        </div>

        <div class="screen-frame">
            <div class="dual-view-container">
                <div class="customer-view">
                    <div class="mobile-frame">
                        <div class="mobile-notch"></div>
                        <div class="mobile-screen" id="mobileScreen"></div>
                    </div>
                    <div class="customer-label">Customer View</div>
                </div>

                <div class="sidebar">
                    <div class="sidebar-header">
                        <div class="copilot-icon"></div>
                        <span class="sidebar-title">M365 Copilot</span>
                        <button class="sidebar-button">â˜°</button>
                    </div>

                    <div class="search-container">
                        <div class="search-box">
                            <span class="search-icon">ðŸ”</span>
                            <input type="text" class="search-input" placeholder="Search">
                        </div>
                    </div>

                    <div class="nav-section">
                        <div class="nav-item active">
                            <div class="nav-icon">
                                <div class="nav-icon-circle"></div>
                            </div>
                            <span>Chat</span>
                        </div>

                        <div class="nav-item" onclick="toggleDropdown('agents')">
                            <div class="nav-icon">
                                <div class="nav-icon-bot"></div>
                            </div>
                            <span>Agents</span>
                            <span class="nav-expand" id="agents-expand">â–¼</span>
                        </div>
                        <div class="nav-dropdown" id="agents-dropdown">
                            <div class="dropdown-item">Insurance AI Assistant</div>
                            <div class="dropdown-item">Coverage Analyzer</div>
                            <div class="dropdown-item">Quote Generator</div>
                            <div class="dropdown-item">Risk Assessor</div>
                            <div class="dropdown-item">Policy Advisor</div>
                            <div class="dropdown-item">Explore agents</div>
                        </div>

                        <div class="nav-item" onclick="toggleDropdown('conversations')">
                            <div class="nav-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M2 5C2 3.89543 2.89543 3 4 3H12C13.1046 3 14 3.89543 14 5V9C14 10.1046 13.1046 11 12 11H8.41421L5.70711 13.7071C5.31658 14.0976 4.68342 14.0976 4.29289 13.7071C4.10536 13.5196 4 13.2652 4 13V11C2.89543 11 2 10.1046 2 9V5Z"/>
                                </svg>
                            </div>
                            <span>Conversations</span>
                            <span class="nav-expand" id="conversations-expand">â–¼</span>
                        </div>
                        <div class="nav-dropdown" id="conversations-dropdown">
                            <div class="dropdown-item">Business Insurance Quote</div>
                            <div class="dropdown-item">Coverage Assessment</div>
                            <div class="dropdown-item">Policy Review</div>
                            <div class="dropdown-item">All conversations</div>
                        </div>

                        <div class="nav-item">
                            <div class="nav-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M3 2C2.44772 2 2 2.44772 2 3V13C2 13.5523 2.44772 14 3 14H13C13.5523 14 14 13.5523 14 13V5.41421C14 5.149 13.8946 4.89464 13.7071 4.70711L10.2929 1.29289C10.1054 1.10536 9.851 1 9.58579 1H3Z"/>
                                </svg>
                            </div>
                            <span>Pages</span>
                        </div>

                        <div class="nav-item">
                            <div class="nav-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M8 2C8.55228 2 9 2.44772 9 3V7H13C13.5523 7 14 7.44772 14 8C14 8.55228 13.5523 9 13 9H9V13C9 13.5523 8.55228 14 8 14C7.44772 14 7 13.5523 7 13V9H3C2.44772 9 2 8.55228 2 8C2 7.44772 2.44772 7 3 7H7V3C7 2.44772 7.44772 2 8 2Z"/>
                                </svg>
                            </div>
                            <span>Create</span>
                        </div>

                        <div class="nav-item">
                            <div class="nav-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <rect x="2" y="2" width="5" height="5" rx="1"/>
                                    <rect x="9" y="2" width="5" height="5" rx="1"/>
                                    <rect x="2" y="9" width="5" height="5" rx="1"/>
                                    <rect x="9" y="9" width="5" height="5" rx="1"/>
                                </svg>
                            </div>
                            <span>Apps</span>
                        </div>

                        <div class="nav-item">
                            <div class="nav-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M8 2C8.82843 2 9.5 2.67157 9.5 3.5C9.5 4.32843 8.82843 5 8 5C7.17157 5 6.5 4.32843 6.5 3.5C6.5 2.67157 7.17157 2 8 2ZM8 6.5C8.82843 6.5 9.5 7.17157 9.5 8C9.5 8.82843 8.82843 9.5 8 9.5C7.17157 9.5 6.5 8.82843 6.5 8C6.5 7.17157 7.17157 6.5 8 6.5ZM9.5 12.5C9.5 11.6716 8.82843 11 8 11C7.17157 11 6.5 11.6716 6.5 12.5C6.5 13.3284 7.17157 14 8 14C8.82843 14 9.5 13.3284 9.5 12.5Z" fill="currentColor"/>
                                </svg>
                            </div>
                            <span>Admin</span>
                        </div>
                    </div>

                    <div class="sidebar-bottom">
                        <div class="user-section">
                            <div class="user-avatar" id="userAvatar">SC</div>
                            <span class="user-name" id="userName">Sarah Chen</span>
                            <span class="user-menu">â‹¯</span>
                        </div>
                    </div>
                </div>

                <div class="main-content">
                    <div class="content-header">
                        <div class="header-left">
                            <div class="header-title">Tilt Insurance Agent Dashboard</div>
                        </div>
                        <div class="header-actions">
                            <div class="status-indicator">
                                <span class="status-dot" id="statusDot"></span>
                                <span id="statusText">Ready</span>
                            </div>
                            <button class="gpt-selector">
                                Try GPT-5
                                <span>â–¼</span>
                            </button>
                            <button class="header-icon-button">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <rect x="5" y="2" width="6" height="2" rx="1"/>
                                    <rect x="3" y="4" width="10" height="10" rx="1" fill="none" stroke="currentColor" stroke-width="1.5"/>
                                    <line x1="6" y1="8" x2="10" y2="8" stroke="currentColor" stroke-width="1"/>
                                    <line x1="6" y1="10" x2="10" y2="10" stroke="currentColor" stroke-width="1"/>
                                </svg>
                            </button>
                            <button class="header-icon-button">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M8 2C8.55228 2 9 2.44772 9 3V7.08296C10.8412 7.55904 12.1667 9.22161 12.1667 11.1667C12.1667 13.4679 10.3012 15.3333 8 15.3333C5.69881 15.3333 3.83333 13.4679 3.83333 11.1667C3.83333 9.22161 5.15877 7.55904 7 7.08296V3C7 2.44772 7.44772 2 8 2Z"/>
                                </svg>
                            </button>
                            <button class="header-icon-button">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <circle cx="8" cy="2" r="1.5"/>
                                    <circle cx="8" cy="8" r="1.5"/>
                                    <circle cx="8" cy="14" r="1.5"/>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="chat-container">
                        <div class="chat-messages" id="chatMessages"></div>

                        <div class="input-container">
                            <div class="input-wrapper">
                                <textarea class="input-field" id="messageInput" placeholder="Message Copilot" rows="1" readonly></textarea>
                                <div class="input-actions">
                                    <button class="input-button">
                                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                            <path d="M8 2C8.55228 2 9 2.44772 9 3V7H13C13.5523 7 14 7.44772 14 8C14 8.55228 13.5523 9 13 9H9V13C9 13.5523 8.55228 14 8 14C7.44772 14 7 13.5523 7 13V9H3C2.44772 9 2 8.55228 2 8C2 7.44772 2.44772 7 3 7H7V3C7 2.44772 7.44772 2 8 2Z"/>
                                        </svg>
                                    </button>
                                    <button class="input-button">
                                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                            <path d="M8 2C5.23858 2 3 4.23858 3 7C3 9.76142 5.23858 12 8 12C8.82843 12 9 12.6716 9 13.5V14C9 14.5523 8.55228 15 8 15C7.44772 15 7 14.5523 7 14V13.5C7 13.2239 6.77614 13 6.5 13C3.46243 13 1 10.5376 1 7.5C1 4.46243 3.46243 2 6.5 2H8Z"/>
                                            <circle cx="8" cy="7" r="2"/>
                                        </svg>
                                    </button>
                                    <button class="input-button send">
                                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                            <path d="M1.724 1.053a.5.5 0 0 0-.714.545l1.403 4.85a.5.5 0 0 0 .397.354l5.69.953c.268.053.268.437 0 .49l-5.69.953a.5.5 0 0 0-.397.354l-1.403 4.85a.5.5 0 0 0 .714.545l12.5-6.5a.5.5 0 0 0 0-.894l-12.5-6.5Z"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="video-controls">
        <div class="controls-left">
            <button class="control-btn play" id="playBtn" onclick="togglePlayPause()">
                <svg viewBox="0 0 24 24">
                    <path d="M8 5v14l11-7z"/>
                </svg>
            </button>
            <button class="control-btn" id="prevBtn" onclick="previousStep()">
                <svg viewBox="0 0 24 24">
                    <path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/>
                </svg>
            </button>
            <button class="control-btn" id="nextBtn" onclick="nextStep()">
                <svg viewBox="0 0 24 24">
                    <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/>
                </svg>
            </button>
        </div>

        <div class="progress-container">
            <div class="progress-info">
                <span id="currentTime">0:00</span>
                <span id="currentStepName">Introduction</span>
                <span id="duration">5:30</span>
            </div>
            <div class="progress-bar" onclick="seekToPosition(event)">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <div class="controls-right">
            <div class="mode-toggle">
                <button class="mode-btn" onclick="setMode('auto')">Auto Play</button>
                <button class="mode-btn active" onclick="setMode('manual')">Presenter</button>
            </div>
            <button class="narrator-toggle active" id="narratorToggle" onclick="toggleNarrator()">Narrator</button>
            <button class="audio-toggle active" id="audioToggle" onclick="toggleAudio()">Audio</button>
            <button class="fullscreen-btn" onclick="toggleFullscreen()">Fullscreen</button>
        </div>
    </div>

    <div class="toast" id="toast">
        <span class="toast-icon" id="toastIcon">âœ“</span>
        <span class="toast-message" id="toastMessage">Configuration loaded successfully</span>
    </div>

    <script>
        let demoState = {
            currentStep: 0,
            isPlaying: false,
            mode: 'manual',
            speed: 1,
            timer: null,
            narratorEnabled: true
        };

        let demoSteps = [];
        let demoConfig = {};
        let audioEnabled = true;
        let speechSynthesizer = null;
        let currentSpeaking = false;

        document.addEventListener('DOMContentLoaded', function() {
            loadDemoConfig();
            updateStepIndicator();
            showWelcomeScreen();
        });

        function getInitials(name) {
            if (!name) return 'U';
            const words = name.split(' ');
            if (words.length >= 2) {
                return words[0][0].toUpperCase() + words[1][0].toUpperCase();
            }
            return name.substring(0, 2).toUpperCase();
        }

        function toggleDropdown(name) {
            const dropdown = document.getElementById(name + '-dropdown');
            const expand = document.getElementById(name + '-expand');
            if (dropdown && expand) {
                dropdown.classList.toggle('expanded');
                expand.classList.toggle('expanded');
            }
        }

        function loadDemoConfig() {
            const stored = localStorage.getItem('tiltDemoConfig');
            if (stored) {
                try {
                    demoConfig = JSON.parse(stored);
                    demoSteps = demoConfig.demoSteps || [];
                    window.demoData = {
                        chatInteractions: demoConfig.chatInteractions || [],
                        agentCards: demoConfig.agentCards || [],
                        userName: demoConfig.userName || 'User'
                    };
                    initializeTTS();
                    
                    if (demoConfig.userName) {
                        document.getElementById('userName').textContent = demoConfig.userName;
                        document.getElementById('userAvatar').textContent = getInitials(demoConfig.userName);
                    }
                    
                    showToast('Demo configuration loaded', 'success');
                    return;
                } catch (e) {
                    console.error('Error loading stored config:', e);
                }
            }
            
            showToast('Load your Tilt demo configuration', 'info');
        }

        function initializeTTS() {
            if (demoConfig.azureTTS && window.SpeechSDK) {
                const speechConfig = window.SpeechSDK.SpeechConfig.fromSubscription(
                    demoConfig.azureTTS.key,
                    demoConfig.azureTTS.region
                );
                speechConfig.speechSynthesisVoiceName = demoConfig.azureTTS.voiceName;
                const audioConfig = window.SpeechSDK.AudioConfig.fromDefaultSpeakerOutput();
                speechSynthesizer = new window.SpeechSDK.SpeechSynthesizer(speechConfig, audioConfig);
            }
        }

        async function speakText(text) {
            if (!audioEnabled || !speechSynthesizer || currentSpeaking) return;
            
            currentSpeaking = true;
            return new Promise((resolve, reject) => {
                speechSynthesizer.speakTextAsync(
                    text,
                    result => {
                        currentSpeaking = false;
                        resolve();
                    },
                    error => {
                        currentSpeaking = false;
                        reject(error);
                    }
                );
            });
        }

        function stopSpeaking() {
            if (speechSynthesizer && currentSpeaking) {
                speechSynthesizer.close();
                initializeTTS();
                currentSpeaking = false;
            }
        }

        function showWelcomeScreen() {
            const mobileScreen = document.getElementById('mobileScreen');
            mobileScreen.innerHTML = `
                <div class="mobile-content">
                    <div class="mobile-header">
                        <div class="tilt-logo">Tilt</div>
                        <div class="mobile-subtitle">Your Progress</div>
                    </div>
                    <div class="mobile-body">
                        <div class="progress-dots">
                            <div class="progress-dot active"></div>
                            <div class="progress-dot"></div>
                            <div class="progress-dot"></div>
                            <div class="progress-dot"></div>
                        </div>
                        <h2 style="font-size: 22px; font-weight: 700; margin: 24px 0 12px;">1. Welcome</h2>
                        <p style="color: #605e5c; margin-bottom: 32px;">Let's get you covered with the right insurance for your business.</p>
                        <button class="mobile-button">Start Application</button>
                        <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid #e0e0e0;">
                            <div style="font-size: 13px; color: #605e5c; margin-bottom: 8px;">Quick links</div>
                            <div style="display: flex; flex-direction: column; gap: 8px;">
                                <button class="mobile-button secondary">Help</button>
                                <button class="mobile-button secondary">Legal</button>
                                <button class="mobile-button secondary">Contact us</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function showPersonalInfoScreen() {
            const mobileScreen = document.getElementById('mobileScreen');
            mobileScreen.innerHTML = `
                <div class="mobile-content">
                    <div class="mobile-header">
                        <div class="tilt-logo">Tilt</div>
                        <div class="mobile-subtitle">Personal Information</div>
                    </div>
                    <div class="mobile-body">
                        <div class="progress-dots">
                            <div class="progress-dot active"></div>
                            <div class="progress-dot active"></div>
                            <div class="progress-dot"></div>
                            <div class="progress-dot"></div>
                        </div>
                        <h2 style="font-size: 20px; font-weight: 700; margin: 20px 0 8px;">Your Personal Information</h2>
                        <p style="font-size: 13px; color: #605e5c; margin-bottom: 24px;">Please provide us with the following information</p>
                        
                        <div class="form-group">
                            <label class="form-label">First name</label>
                            <input type="text" class="form-input" value="Michael" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Last name</label>
                            <input type="text" class="form-input" value="Torres" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Date of Birth</label>
                            <input type="text" class="form-input" value="05/12/1985" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Business name</label>
                            <input type="text" class="form-input" value="Torres Consulting LLC" readonly>
                        </div>
                        
                        <div class="sync-indicator">Syncing with agent...</div>
                        
                        <button class="mobile-button" style="margin-top: 20px;">Next</button>
                    </div>
                </div>
            `;
        }

        function showCoverageScreen() {
            const mobileScreen = document.getElementById('mobileScreen');
            mobileScreen.innerHTML = `
                <div class="mobile-content">
                    <div class="mobile-header">
                        <div class="tilt-logo">Tilt</div>
                        <div class="mobile-subtitle">Your cover</div>
                    </div>
                    <div class="mobile-body">
                        <div class="progress-dots">
                            <div class="progress-dot active"></div>
                            <div class="progress-dot active"></div>
                            <div class="progress-dot active"></div>
                            <div class="progress-dot"></div>
                        </div>
                        <h2 style="font-size: 20px; font-weight: 700; margin: 20px 0 8px;">Select your coverage</h2>
                        <p style="font-size: 13px; color: #605e5c; margin-bottom: 20px;">Please select the cover you would like</p>
                        
                        <div class="coverage-card selected">
                            <div class="coverage-title">Public Liability</div>
                            <div class="coverage-desc">Cover for injury or property damage to third parties</div>
                        </div>
                        
                        <div class="coverage-card selected">
                            <div class="coverage-title">Professional Indemnity</div>
                            <div class="coverage-desc">Protection against claims of professional negligence</div>
                        </div>
                        
                        <div class="coverage-card selected">
                            <div class="coverage-title">Cyber Insurance</div>
                            <div class="coverage-desc">Coverage for data breaches and cyber attacks</div>
                        </div>
                        
                        <div class="coverage-card">
                            <div class="coverage-title">Employers Liability</div>
                            <div class="coverage-desc">Required if you have employees</div>
                        </div>
                        
                        <button class="mobile-button" style="margin-top: 20px;">Continue</button>
                    </div>
                </div>
            `;
        }

        function showPackageScreen() {
            const mobileScreen = document.getElementById('mobileScreen');
            mobileScreen.innerHTML = `
                <div class="mobile-content">
                    <div class="mobile-header">
                        <div class="tilt-logo">Select your package</div>
                    </div>
                    <div class="mobile-body">
                        <h2 style="font-size: 20px; font-weight: 700; margin: 20px 0 8px; color: #1a1a1a;">Choose your coverage</h2>
                        
                        <div class="package-card">
                            <div class="package-name">Essential</div>
                            <div class="package-price">Â£850<span>/year</span></div>
                            <ul class="package-features">
                                <li>Â£1M Professional Indemnity</li>
                                <li>Â£500K Cyber Coverage</li>
                                <li>Basic support</li>
                            </ul>
                        </div>
                        
                        <div class="package-card recommended">
                            <div class="package-name">Premium</div>
                            <div class="package-price">Â£234.56</div>
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                                <span style="font-size: 14px; opacity: 0.9;">Coverage score</span>
                                <div style="margin-left: auto; background: rgba(255,255,255,0.25); padding: 6px 14px; border-radius: 20px; font-size: 13px; font-weight: 600; border: 2px solid rgba(255,255,255,0.4);">Great</div>
                            </div>
                            <ul class="package-features">
                                <li>Â£2M Professional Indemnity</li>
                                <li>Â£1M Cyber Coverage</li>
                                <li>Â£2M Public Liability</li>
                                <li>Priority support</li>
                            </ul>
                        </div>
                        
                        <div class="package-card">
                            <div class="package-name">Pro</div>
                            <div class="package-price">Â£1,680<span>/year</span></div>
                            <ul class="package-features">
                                <li>Â£5M Professional Indemnity</li>
                                <li>Â£2M Cyber Coverage</li>
                                <li>Â£5M Public Liability</li>
                                <li>24/7 dedicated support</li>
                            </ul>
                        </div>
                    </div>
                </div>
            `;
        }

        function showConfirmationScreen() {
            const mobileScreen = document.getElementById('mobileScreen');
            mobileScreen.innerHTML = `
                <div class="mobile-content">
                    <div class="mobile-body" style="padding: 40px 20px;">
                        <div style="text-align: left;">
                            <div style="width: 60px; height: 60px; margin-bottom: 24px;">
                                <svg width="60" height="60" viewBox="0 0 60 60" fill="none">
                                    <path d="M30 7.5L35.7 18.975L48.3 20.85L39.15 29.775L41.4 42.3L30 36.3L18.6 42.3L20.85 29.775L11.7 20.85L24.3 18.975L30 7.5Z" fill="#1a1a1a" stroke="#1a1a1a" stroke-width="2"/>
                                    <path d="M30 20L22 28L30 36" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            
                            <h1 style="font-size: 36px; font-weight: 700; color: #1a1a1a; margin-bottom: 12px; line-height: 1.1;">You're insured</h1>
                            
                            <p style="font-size: 15px; color: #605e5c; margin-bottom: 32px;">Cover date: 30 June, 2025 - 19 February, 2026</p>
                            
                            <div style="padding: 16px 0; border-bottom: 1px solid #e0e0e0; display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <path d="M9 3H4C3.44772 3 3 3.44772 3 4V9C3 9.55228 3.44772 10 4 10H9C9.55228 10 10 9.55228 10 9V4C10 3.44772 9.55228 3 9 3Z" stroke="#1a1a1a" stroke-width="2"/>
                                    <path d="M9 14H4C3.44772 14 3 14.4477 3 15V20C3 20.5523 3.44772 21 4 21H9C9.55228 21 10 20.5523 10 20V15C10 14.4477 9.55228 14 9 14Z" stroke="#1a1a1a" stroke-width="2"/>
                                    <path d="M20 14H15C14.4477 14 14 14.4477 14 15V20C14 20.5523 14.4477 21 15 21H20C20.5523 21 21 20.5523 21 20V15C21 14.4477 20.5523 14 20 14Z" stroke="#1a1a1a" stroke-width="2"/>
                                    <path d="M20 3H15C14.4477 3 14 3.44772 14 4V9C14 9.55228 14.4477 10 15 10H20C20.5523 10 21 9.55228 21 9V4C21 3.44772 20.5523 3 20 3Z" stroke="#1a1a1a" stroke-width="2"/>
                                </svg>
                                <span style="font-size: 16px; color: #1a1a1a; font-weight: 500;">Your covers</span>
                                <svg style="margin-left: auto;" width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M7 4L13 10L7 16" stroke="#1a1a1a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            
                            <div style="padding: 16px 0; border-bottom: 1px solid #e0e0e0; display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <circle cx="12" cy="12" r="9" stroke="#1a1a1a" stroke-width="2"/>
                                    <path d="M12 8V12L15 15" stroke="#1a1a1a" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                <span style="font-size: 16px; color: #1a1a1a; font-weight: 500;">Terms and conditions</span>
                                <svg style="margin-left: auto;" width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M7 4L13 10L7 16" stroke="#1a1a1a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            
                            <div style="padding: 16px 0; display: flex; align-items: center; gap: 12px;">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                    <path d="M9 3H4C3.44772 3 3 3.44772 3 4V9C3 9.55228 3.44772 10 4 10H9C9.55228 10 10 9.55228 10 9V4C10 3.44772 9.55228 3 9 3Z" stroke="#1a1a1a" stroke-width="2"/>
                                    <path d="M9 14H4C3.44772 14 3 14.4477 3 15V20C3 20.5523 3.44772 21 4 21H9C9.55228 21 10 20.5523 10 20V15C10 14.4477 9.55228 14 9 14Z" stroke="#1a1a1a" stroke-width="2"/>
                                </svg>
                                <span style="font-size: 16px; color: #1a1a1a; font-weight: 500;">#18276343514</span>
                                <svg style="margin-left: auto;" width="20" height="20" viewBox="0 0 20 20" fill="#4D5FFF">
                                    <path d="M4 4H12V6H4V4Z" fill="#4D5FFF"/>
                                    <path d="M4 8H16V10H4V8Z" fill="#4D5FFF"/>
                                    <path d="M4 12H16V14H4V12Z" fill="#4D5FFF"/>
                                    <path d="M4 16H12V18H4V16Z" fill="#4D5FFF"/>
                                </svg>
                            </div>
                            
                            <div style="margin-top: 40px; background: linear-gradient(135deg, #4D5FFF 0%, #5B6FFF 100%); border-radius: 24px; padding: 32px 24px; position: relative; overflow: hidden;">
                                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.15) 0%, transparent 50%);"></div>
                                
                                <div style="position: relative; z-index: 1;">
                                    <h3 style="font-size: 32px; font-weight: 700; color: white; margin-bottom: 12px; line-height: 1.1;">Get instant access to your insurance. Dow...</h3>
                                    
                                    <button style="width: 100%; padding: 16px; background: white; color: #1a1a1a; border: none; border-radius: 16px; font-size: 16px; font-weight: 600; margin-top: 24px; display: flex; align-items: center; justify-content: center; gap: 8px;">
                                        <svg width="20" height="24" viewBox="0 0 20 24" fill="currentColor">
                                            <path d="M17.5 7.2c0 3-2.5 5.1-6 5.1s-6-2.1-6-5.1 2.5-5.7 6-5.7 6 2.7 6 5.7zM10 13.5c-3.3 0-6.5 1.8-7.5 4.5v4.5h15V18c-1-2.7-4.2-4.5-7.5-4.5z"/>
                                        </svg>
                                        Download on the App Store
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function displayChatMessages(messages) {
            const chatContainer = document.getElementById('chatMessages');
            if (!chatContainer) return;

            const userName = window.demoData?.userName || 'User';
            const userInitials = getInitials(userName);

            messages.forEach((msg, index) => {
                setTimeout(() => {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'message';

                    const time = new Date().toLocaleString('en-US', { 
                        hour: 'numeric', 
                        minute: '2-digit'
                    });

                    if (msg.type === 'system') {
                        messageDiv.className += ' system';
                        messageDiv.innerHTML = `
                            <div class="message-wrapper">
                                <div class="message-content">${msg.text}</div>
                            </div>
                        `;
                    } else if (msg.type === 'agent') {
                        messageDiv.className += ' agent';
                        messageDiv.innerHTML = `
                            <div class="message-wrapper">
                                <div class="message-header">
                                    <div class="message-avatar-agent">C</div>
                                    <span class="message-author">Copilot</span>
                                    <span class="message-time">${time}</span>
                                </div>
                                <div class="message-content-wrapper">
                                    <div class="message-content">${msg.text}</div>
                                </div>
                            </div>
                        `;
                    } else if (msg.type === 'user' || msg.type === 'customer') {
                        messageDiv.className += ' user';
                        messageDiv.innerHTML = `
                            <div class="message-wrapper">
                                <div class="message-header">
                                    <div class="message-avatar-user">${userInitials}</div>
                                    <span class="message-author">${userName}</span>
                                    <span class="message-time">${time}</span>
                                </div>
                                <div class="message-content-wrapper">
                                    <div class="message-content">${msg.text}</div>
                                </div>
                            </div>
                        `;
                    }

                    chatContainer.appendChild(messageDiv);
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                }, index * 500);
            });
        }

        function displayAgentCard(card) {
            const chatContainer = document.getElementById('chatMessages');
            if (!chatContainer) return;

            setTimeout(() => {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message agent';

                let detailsHTML = '';
                if (card.details) {
                    for (const [key, value] of Object.entries(card.details)) {
                        detailsHTML += `
                            <li class="detail-item">
                                <span class="detail-item-label">${key}:</span>
                                <span class="detail-item-value">${value}</span>
                            </li>
                        `;
                    }
                }

                const statusClass = card.status === 'CRITICAL' ? 'critical' : 
                                   card.status === 'WARNING' ? 'warning' : '';

                messageDiv.innerHTML = `
                    <div class="message-wrapper">
                        <div class="agent-card">
                            <div class="agent-card-header">
                                <span class="agent-card-title">${card.title}</span>
                                ${card.status ? `<span class="agent-card-status ${statusClass}">${card.status}</span>` : ''}
                            </div>
                            <ul class="detail-list">${detailsHTML}</ul>
                        </div>
                    </div>
                `;

                chatContainer.appendChild(messageDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }, 1000);
        }

        function clearChatMessages() {
            const chatContainer = document.getElementById('chatMessages');
            if (chatContainer) {
                chatContainer.innerHTML = '';
            }
        }

        function executeStepAction(action) {
            switch(action) {
                case 'showIncomingCall':
                case 'showWelcomeScreen':
                    showWelcomeScreen();
                    break;
                case 'showPersonalInfo':
                    showPersonalInfoScreen();
                    break;
                case 'showCoverageOptions':
                    showCoverageScreen();
                    break;
                case 'showPackagePresentation':
                case 'showPricePresentation':
                    showPackageScreen();
                    break;
                case 'showReviewConfirm':
                case 'showPaymentSetup':
                    showPersonalInfoScreen();
                    break;
                case 'showConfirmation':
                    showConfirmationScreen();
                    break;
            }
        }

        async function playCurrentStep() {
            if (demoState.currentStep >= demoSteps.length) {
                completeDemo();
                return;
            }

            const step = demoSteps[demoState.currentStep];
            
            updateStepIndicator();
            updateProgress();
            document.getElementById('currentStepName').textContent = step.name || 'Step ' + (demoState.currentStep + 1);
            
            const statusDot = document.getElementById('statusDot');
            const statusText = document.getElementById('statusText');
            if (step.id === 'call_incoming') {
                statusText.textContent = 'Incoming Call';
                statusDot.className = 'status-dot processing';
            } else if (step.id === 'confirmation') {
                statusText.textContent = 'Call Complete';
                statusDot.className = 'status-dot';
            } else if (step.id !== 'welcome' && step.id !== 'impact') {
                statusText.textContent = 'On Call';
                statusDot.className = 'status-dot';
            }
            
            if (step.action) {
                executeStepAction(step.action);
            }
            
            if (window.demoData && window.demoData.chatInteractions) {
                const stepInteractions = window.demoData.chatInteractions.find(i => i.stepId === step.id);
                if (stepInteractions && stepInteractions.messages) {
                    displayChatMessages(stepInteractions.messages);
                }
            }
            
            if (window.demoData && window.demoData.agentCards) {
                const stepCard = window.demoData.agentCards.find(c => c.stepId === step.id);
                if (stepCard && stepCard.card) {
                    displayAgentCard(stepCard.card);
                }
            }
            
            if (step.narrator && demoState.narratorEnabled) {
                showNarrator(step.narrator);
            }
            
            if (step.voiceText && audioEnabled) {
                try {
                    await speakText(step.voiceText);
                } catch (error) {
                    console.error('Error speaking:', error);
                }
            }
            
            if (demoState.mode === 'auto' && demoState.isPlaying) {
                demoState.timer = setTimeout(() => {
                    nextStep();
                }, step.duration || 5000);
            }
        }

        function togglePlayPause() {
            if (demoState.isPlaying) {
                pauseDemo();
            } else {
                playDemo();
            }
        }

        function playDemo() {
            if (demoSteps.length === 0) {
                showToast('No demo loaded', 'error');
                return;
            }
            demoState.isPlaying = true;
            document.getElementById('playBtn').innerHTML = '<svg viewBox="0 0 24 24"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>';
            playCurrentStep();
        }

        function pauseDemo() {
            demoState.isPlaying = false;
            document.getElementById('playBtn').innerHTML = '<svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>';
            clearTimeout(demoState.timer);
            stopSpeaking();
        }

        function nextStep() {
            if (demoState.currentStep < demoSteps.length - 1) {
                stopSpeaking();
                demoState.currentStep++;
                playCurrentStep();
            } else {
                completeDemo();
            }
        }

        function previousStep() {
            if (demoState.currentStep > 0) {
                stopSpeaking();
                demoState.currentStep--;
                playCurrentStep();
            }
        }

        function completeDemo() {
            demoState.isPlaying = false;
            document.getElementById('playBtn').innerHTML = '<svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>';
            stopSpeaking();
            showToast('Demo completed', 'success');
        }

        function continueDemo() {
            hideNarrator();
            if (demoState.isPlaying) {
                nextStep();
            }
        }

        function showNarrator(narrator) {
            if (!demoState.narratorEnabled) return;
            
            const overlay = document.getElementById('narratorOverlay');
            document.getElementById('narratorTitle').textContent = narrator.title || '';
            document.getElementById('narratorText').textContent = narrator.text || '';
            document.getElementById('narratorSubtitle').textContent = narrator.subtitle || '';
            
            overlay.classList.remove('center');
            if (narrator.position === 'center') {
                overlay.classList.add('center');
            }
            
            overlay.classList.add('active');
        }

        function hideNarrator() {
            document.getElementById('narratorOverlay').classList.remove('active');
        }

        function toggleNarrator() {
            demoState.narratorEnabled = !demoState.narratorEnabled;
            const btn = document.getElementById('narratorToggle');
            if (demoState.narratorEnabled) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
                hideNarrator();
            }
        }

        function toggleAudio() {
            audioEnabled = !audioEnabled;
            const btn = document.getElementById('audioToggle');
            if (audioEnabled) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
                stopSpeaking();
            }
        }

        function updateStepIndicator() {
            document.getElementById('currentStep').textContent = demoState.currentStep + 1;
            document.getElementById('totalSteps').textContent = demoSteps.length || 1;
        }

        function updateProgress() {
            if (demoSteps.length === 0) return;
            const progress = ((demoState.currentStep) / Math.max(demoSteps.length - 1, 1)) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function setMode(mode) {
            demoState.mode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        function seekToPosition(event) {
            if (demoSteps.length === 0) return;
            const rect = event.currentTarget.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const percentage = x / rect.width;
            demoState.currentStep = Math.min(Math.floor(percentage * demoSteps.length), demoSteps.length - 1);
            playCurrentStep();
        }

        function openSettings() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = event => {
                    try {
                        demoConfig = JSON.parse(event.target.result);
                        demoSteps = demoConfig.demoSteps || [];
                        window.demoData = {
                            chatInteractions: demoConfig.chatInteractions || [],
                            agentCards: demoConfig.agentCards || [],
                            userName: demoConfig.userName || 'User'
                        };
                        
                        if (demoConfig.userName) {
                            document.getElementById('userName').textContent = demoConfig.userName;
                            document.getElementById('userAvatar').textContent = getInitials(demoConfig.userName);
                        }
                        
                        localStorage.setItem('tiltDemoConfig', event.target.result);
                        initializeTTS();
                        demoState.currentStep = 0;
                        clearChatMessages();
                        playCurrentStep();
                        showToast('Demo configuration loaded successfully', 'success');
                    } catch (err) {
                        showToast('Error loading configuration', 'error');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const icon = document.getElementById('toastIcon');
            const msg = document.getElementById('toastMessage');

            msg.textContent = message;
            toast.className = `toast show ${type}`;
            icon.textContent = type === 'success' ? 'âœ“' : 'âœ—';

            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case ' ':
                    e.preventDefault();
                    togglePlayPause();
                    break;
                case 'ArrowRight':
                    nextStep();
                    break;
                case 'ArrowLeft':
                    previousStep();
                    break;
            }
        });

        window.addEventListener('beforeunload', () => {
            stopSpeaking();
            if (speechSynthesizer) {
                speechSynthesizer.close();
            }
        });
    </script>

    <script src="https://aka.ms/csspeech/jsbrowserpackageraw"></script>
</body>
</html>