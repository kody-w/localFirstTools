<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Code Playground</title>
    <meta name="description" content="Learn JavaScript through interactive coding challenges with live execution, visual output, and comprehensive tutorials for beginners to advanced programmers">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Monaco', 'Courier New', monospace;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            height: 100vh;
            overflow: hidden;
        }

        #app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        #header {
            background: rgba(20, 20, 40, 0.95);
            padding: 15px 30px;
            border-bottom: 2px solid #00ff88;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        h1 {
            font-size: 24px;
            color: #00ff88;
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
        }

        #header-controls {
            display: flex;
            gap: 10px;
        }

        button {
            padding: 8px 16px;
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
            color: #1a1a2e;
            border: none;
            border-radius: 5px;
            font-size: 13px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 136, 0.4);
        }

        button.secondary {
            background: linear-gradient(135deg, #667eea 0%, #4a5fc1 100%);
            color: #fff;
        }

        button.danger {
            background: linear-gradient(135deg, #ff006e 0%, #cc0055 100%);
            color: #fff;
        }

        #main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        #sidebar {
            width: 280px;
            background: rgba(20, 20, 40, 0.95);
            border-right: 1px solid rgba(0, 255, 136, 0.2);
            overflow-y: auto;
            padding: 20px;
        }

        .lesson-section {
            margin-bottom: 25px;
        }

        .lesson-section h3 {
            color: #00ff88;
            font-size: 14px;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .lesson-item {
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.03);
            border-left: 3px solid transparent;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 3px;
            font-size: 13px;
        }

        .lesson-item:hover {
            background: rgba(0, 255, 136, 0.1);
            border-left-color: #00ff88;
            transform: translateX(5px);
        }

        .lesson-item.active {
            background: rgba(0, 255, 136, 0.15);
            border-left-color: #00ff88;
        }

        .lesson-item.completed {
            opacity: 0.7;
        }

        .lesson-item.completed::after {
            content: "‚úì";
            float: right;
            color: #00ff88;
        }

        #workspace {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        #lesson-info {
            background: rgba(20, 20, 40, 0.95);
            padding: 20px 30px;
            border-bottom: 1px solid rgba(0, 255, 136, 0.2);
        }

        #lesson-info h2 {
            color: #00ff88;
            font-size: 20px;
            margin-bottom: 10px;
        }

        #lesson-info p {
            color: #aaa;
            line-height: 1.6;
            font-size: 14px;
        }

        #code-output-container {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        #code-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            border-right: 1px solid rgba(0, 255, 136, 0.2);
        }

        #code-toolbar {
            background: rgba(30, 30, 50, 0.95);
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(0, 255, 136, 0.2);
        }

        #code-toolbar span {
            color: #00ff88;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        #code-editor {
            flex: 1;
            background: #0a0a0a;
            padding: 20px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            color: #e0e0e0;
            overflow: auto;
            resize: none;
            border: none;
            outline: none;
        }

        #output-section {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        #output-toolbar {
            background: rgba(30, 30, 50, 0.95);
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(102, 126, 234, 0.2);
        }

        #output-toolbar span {
            color: #667eea;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        #output-display {
            flex: 1;
            background: #0a0a0a;
            padding: 20px;
            overflow: auto;
            font-size: 14px;
            line-height: 1.6;
        }

        #canvas-output {
            display: none;
            background: #000;
            width: 100%;
            height: 100%;
        }

        .console-line {
            margin-bottom: 8px;
            padding: 5px 10px;
            border-radius: 3px;
            font-family: 'Monaco', 'Courier New', monospace;
        }

        .console-log {
            color: #00ff88;
        }

        .console-error {
            color: #ff006e;
            background: rgba(255, 0, 110, 0.1);
        }

        .console-warn {
            color: #ffea00;
            background: rgba(255, 234, 0, 0.1);
        }

        .challenge-box {
            background: rgba(102, 126, 234, 0.1);
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-top: 15px;
            border-radius: 5px;
        }

        .challenge-box h4 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .challenge-box ul {
            list-style: none;
            padding-left: 0;
        }

        .challenge-box li {
            padding: 5px 0;
            color: #aaa;
            font-size: 13px;
        }

        .challenge-box li::before {
            content: "‚ñπ ";
            color: #667eea;
            font-weight: bold;
        }

        #stats-bar {
            background: rgba(20, 20, 40, 0.95);
            padding: 10px 30px;
            border-top: 1px solid rgba(0, 255, 136, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stat-label {
            color: #888;
            font-size: 11px;
            text-transform: uppercase;
        }

        .stat-value {
            color: #00ff88;
            font-size: 16px;
            font-weight: bold;
        }

        .hint-box {
            background: rgba(255, 234, 0, 0.1);
            border-left: 4px solid #ffea00;
            padding: 15px;
            margin-top: 15px;
            border-radius: 5px;
            display: none;
        }

        .hint-box h4 {
            color: #ffea00;
            margin-bottom: 10px;
            font-size: 14px;
        }

        @media (max-width: 1024px) {
            #main-content {
                flex-direction: column;
            }
            #sidebar {
                width: 100%;
                height: 200px;
            }
            #code-output-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div id="app-container">
        <div id="header">
            <h1>üíª Interactive Code Playground</h1>
            <div id="header-controls">
                <button id="runBtn">‚ñ∂Ô∏è Run Code</button>
                <button id="hintBtn" class="secondary">üí° Hint</button>
                <button id="resetBtn" class="danger">üîÑ Reset</button>
                <button id="exportBtn" class="secondary">üíæ Export Progress</button>
            </div>
        </div>

        <div id="main-content">
            <div id="sidebar">
                <div class="lesson-section">
                    <h3>üéØ Basics</h3>
                    <div class="lesson-item active" data-lesson="variables">Variables & Data Types</div>
                    <div class="lesson-item" data-lesson="operators">Operators & Math</div>
                    <div class="lesson-item" data-lesson="strings">Strings & Text</div>
                    <div class="lesson-item" data-lesson="conditionals">If/Else Statements</div>
                    <div class="lesson-item" data-lesson="loops">Loops & Iteration</div>
                </div>

                <div class="lesson-section">
                    <h3>üöÄ Intermediate</h3>
                    <div class="lesson-item" data-lesson="functions">Functions</div>
                    <div class="lesson-item" data-lesson="arrays">Arrays</div>
                    <div class="lesson-item" data-lesson="objects">Objects</div>
                    <div class="lesson-item" data-lesson="dom">DOM Manipulation</div>
                    <div class="lesson-item" data-lesson="events">Events & Handlers</div>
                </div>

                <div class="lesson-section">
                    <h3>‚ö° Advanced</h3>
                    <div class="lesson-item" data-lesson="async">Async & Promises</div>
                    <div class="lesson-item" data-lesson="classes">Classes & OOP</div>
                    <div class="lesson-item" data-lesson="canvas">Canvas Drawing</div>
                    <div class="lesson-item" data-lesson="algorithms">Algorithms</div>
                    <div class="lesson-item" data-lesson="game">Simple Game</div>
                </div>
            </div>

            <div id="workspace">
                <div id="lesson-info">
                    <h2 id="lessonTitle">Variables & Data Types</h2>
                    <p id="lessonDescription">Learn how to store and work with different types of data in JavaScript.</p>
                    <div class="challenge-box" id="challengeBox">
                        <h4>üìã Challenge:</h4>
                        <ul id="challengeList"></ul>
                    </div>
                    <div class="hint-box" id="hintBox">
                        <h4>üí° Hint:</h4>
                        <p id="hintText"></p>
                    </div>
                </div>

                <div id="code-output-container">
                    <div id="code-section">
                        <div id="code-toolbar">
                            <span>Code Editor</span>
                            <div>
                                <button id="clearBtn" class="danger" style="padding: 5px 10px; font-size: 11px;">Clear</button>
                            </div>
                        </div>
                        <textarea id="code-editor" spellcheck="false"></textarea>
                    </div>

                    <div id="output-section">
                        <div id="output-toolbar">
                            <span>Output</span>
                            <button id="clearOutputBtn" class="danger" style="padding: 5px 10px; font-size: 11px;">Clear</button>
                        </div>
                        <div id="output-display"></div>
                        <canvas id="canvas-output"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div id="stats-bar">
            <div class="stat-item">
                <span class="stat-label">Lessons Completed:</span>
                <span class="stat-value" id="completedCount">0/15</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Current Streak:</span>
                <span class="stat-value" id="streakCount">0 days</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">Total Lines:</span>
                <span class="stat-value" id="linesCount">0</span>
            </div>
        </div>
    </div>

    <script>
        // ========================================
        // Lesson Content Database
        // ========================================
        const lessons = {
            variables: {
                title: "Variables & Data Types",
                description: "Learn how to store and work with different types of data in JavaScript.",
                challenges: [
                    "Create a variable called 'name' with your name",
                    "Create a variable 'age' with a number",
                    "Create a variable 'isStudent' with a boolean",
                    "Log all three variables to the console"
                ],
                hint: "Use 'let' or 'const' to declare variables. Strings use quotes, numbers don't, and booleans are true/false.",
                starterCode: `// Variables store data\nlet name = "Your Name";\nlet age = 25;\nlet isStudent = true;\n\n// Log them to see the output\nconsole.log(name);\nconsole.log(age);\nconsole.log(isStudent);`,
                solution: `let name = "Alex";\nlet age = 25;\nlet isStudent = true;\n\nconsole.log(name);\nconsole.log(age);\nconsole.log(isStudent);`
            },
            operators: {
                title: "Operators & Math",
                description: "Perform calculations and comparisons using JavaScript operators.",
                challenges: [
                    "Create two numbers and add them",
                    "Multiply two numbers together",
                    "Check if one number is greater than another",
                    "Calculate the remainder of division"
                ],
                hint: "Use +, -, *, / for math. Use >, <, >=, <= for comparisons. Use % for remainder.",
                starterCode: `// Math operators\nlet a = 10;\nlet b = 5;\n\nconsole.log(a + b);  // Addition\nconsole.log(a * b);  // Multiplication\nconsole.log(a > b);  // Comparison\nconsole.log(a % b);  // Remainder`,
                solution: `let a = 10;\nlet b = 5;\n\nconsole.log(a + b);  // 15\nconsole.log(a * b);  // 50\nconsole.log(a > b);  // true\nconsole.log(a % b);  // 0`
            },
            strings: {
                title: "Strings & Text",
                description: "Work with text, including concatenation, template literals, and string methods.",
                challenges: [
                    "Create a string with your favorite color",
                    "Combine two strings together",
                    "Convert a string to uppercase",
                    "Get the length of a string"
                ],
                hint: "Use quotes for strings. Combine with + or template literals `${var}`. Use .toUpperCase() and .length",
                starterCode: `let color = "blue";\nlet message = "My favorite color is " + color;\n\nconsole.log(message);\nconsole.log(message.toUpperCase());\nconsole.log(message.length);`,
                solution: `let color = "blue";\nlet message = "My favorite color is " + color;\nlet altMessage = \`I love \${color}\`;\n\nconsole.log(message);\nconsole.log(message.toUpperCase());\nconsole.log(message.length);`
            },
            conditionals: {
                title: "If/Else Statements",
                description: "Make decisions in your code with conditional statements.",
                challenges: [
                    "Check if a number is positive or negative",
                    "Determine if someone can vote (age >= 18)",
                    "Check if a string is empty",
                    "Use else if for multiple conditions"
                ],
                hint: "Use if (condition) { } else { }. Conditions are expressions that evaluate to true/false.",
                starterCode: `let age = 20;\n\nif (age >= 18) {\n    console.log("Can vote!");\n} else {\n    console.log("Too young to vote");\n}`,
                solution: `let age = 20;\n\nif (age >= 18) {\n    console.log("Can vote!");\n} else {\n    console.log("Too young to vote");\n}\n\nlet score = 85;\nif (score >= 90) {\n    console.log("A");\n} else if (score >= 80) {\n    console.log("B");\n} else {\n    console.log("C or below");\n}`
            },
            loops: {
                title: "Loops & Iteration",
                description: "Repeat code multiple times with for and while loops.",
                challenges: [
                    "Count from 1 to 10 using a for loop",
                    "Create a countdown from 10 to 1",
                    "Loop through an array of colors",
                    "Use while loop until condition is met"
                ],
                hint: "for (let i = 0; i < 10; i++) { } repeats 10 times. while (condition) { } repeats while true.",
                starterCode: `// Count to 10\nfor (let i = 1; i <= 10; i++) {\n    console.log(i);\n}\n\n// Loop through array\nlet colors = ["red", "blue", "green"];\nfor (let color of colors) {\n    console.log(color);\n}`,
                solution: `// Count to 10\nfor (let i = 1; i <= 10; i++) {\n    console.log(i);\n}\n\n// Countdown\nfor (let i = 10; i >= 1; i--) {\n    console.log(i);\n}\n\n// Array loop\nlet colors = ["red", "blue", "green"];\nfor (let color of colors) {\n    console.log(color);\n}\n\n// While loop\nlet count = 0;\nwhile (count < 5) {\n    console.log(count);\n    count++;\n}`
            },
            functions: {
                title: "Functions",
                description: "Create reusable blocks of code with functions.",
                challenges: [
                    "Create a function that adds two numbers",
                    "Create a function that returns a greeting",
                    "Use arrow function syntax",
                    "Create a function with default parameters"
                ],
                hint: "function name(params) { return value; } or const name = (params) => { return value; }",
                starterCode: `// Regular function\nfunction add(a, b) {\n    return a + b;\n}\n\nconsole.log(add(5, 3));\n\n// Arrow function\nconst greet = (name) => {\n    return "Hello, " + name;\n};\n\nconsole.log(greet("Alex"));`,
                solution: `function add(a, b) {\n    return a + b;\n}\n\nconst greet = (name = "Friend") => {\n    return \`Hello, \${name}!\`;\n};\n\nconst multiply = (x, y) => x * y;\n\nconsole.log(add(5, 3));\nconsole.log(greet("Alex"));\nconsole.log(greet());\nconsole.log(multiply(4, 7));`
            },
            arrays: {
                title: "Arrays",
                description: "Store and manipulate lists of data with arrays.",
                challenges: [
                    "Create an array of your favorite foods",
                    "Add an item to the end of the array",
                    "Remove the first item",
                    "Use map() to transform array elements"
                ],
                hint: "Arrays use []. Methods: .push(), .pop(), .shift(), .unshift(), .map(), .filter()",
                starterCode: `let foods = ["pizza", "burger", "sushi"];\n\nfoods.push("tacos");\nconsole.log(foods);\n\nfoods.shift();\nconsole.log(foods);\n\nlet uppercase = foods.map(food => food.toUpperCase());\nconsole.log(uppercase);`,
                solution: `let foods = ["pizza", "burger", "sushi"];\n\n// Add to end\nfoods.push("tacos");\nconsole.log(foods);\n\n// Remove from start\nfoods.shift();\nconsole.log(foods);\n\n// Transform with map\nlet uppercase = foods.map(food => food.toUpperCase());\nconsole.log(uppercase);\n\n// Filter\nlet longNames = foods.filter(food => food.length > 5);\nconsole.log(longNames);`
            },
            objects: {
                title: "Objects",
                description: "Store structured data with key-value pairs in objects.",
                challenges: [
                    "Create an object representing a person",
                    "Access object properties",
                    "Add a new property to the object",
                    "Create a method inside an object"
                ],
                hint: "Objects use {}. Access with dot notation object.key or bracket notation object['key']",
                starterCode: `let person = {\n    name: "Alex",\n    age: 25,\n    city: "NYC"\n};\n\nconsole.log(person.name);\nperson.job = "Developer";\nconsole.log(person);`,
                solution: `let person = {\n    name: "Alex",\n    age: 25,\n    city: "NYC",\n    greet: function() {\n        return \`Hi, I'm \${this.name}\`;\n    }\n};\n\nconsole.log(person.name);\nperson.job = "Developer";\nconsole.log(person);\nconsole.log(person.greet());`
            },
            dom: {
                title: "DOM Manipulation",
                description: "Select and modify HTML elements dynamically.",
                challenges: [
                    "Select an element by ID (use output div)",
                    "Change the content of an element",
                    "Change the style of an element",
                    "Create and append a new element"
                ],
                hint: "Use document.getElementById(), element.innerHTML, element.style.color, document.createElement()",
                starterCode: `// Get the output display element\nlet output = document.getElementById('output-display');\n\n// Change content\noutput.innerHTML = '<div style="color: #00ff88; padding: 20px;">Hello from DOM!</div>';\n\nconsole.log("DOM manipulation complete!");`,
                solution: `let output = document.getElementById('output-display');\n\noutput.innerHTML = '<div style="color: #00ff88; padding: 20px;">Hello from DOM!</div>';\n\nlet newDiv = document.createElement('div');\nnewDiv.style.color = '#667eea';\nnewDiv.style.padding = '20px';\nnewDiv.textContent = 'New element created!';\noutput.appendChild(newDiv);\n\nconsole.log("DOM manipulation complete!");`
            },
            events: {
                title: "Events & Handlers",
                description: "Respond to user interactions like clicks and keyboard input.",
                challenges: [
                    "Add a click event listener",
                    "Log a message when clicked",
                    "Change element on interaction",
                    "Use event object properties"
                ],
                hint: "element.addEventListener('click', function(event) { })",
                starterCode: `let output = document.getElementById('output-display');\n\noutput.innerHTML = '<button id="testBtn" style="padding: 10px 20px; font-size: 16px; cursor: pointer; background: #00ff88; border: none; border-radius: 5px;">Click Me!</button>';\n\nlet btn = document.getElementById('testBtn');\nbtn.addEventListener('click', () => {\n    console.log('Button clicked!');\n    btn.textContent = 'Clicked!';\n});`,
                solution: `let output = document.getElementById('output-display');\n\noutput.innerHTML = '<button id="testBtn" style="padding: 10px 20px; font-size: 16px; cursor: pointer; background: #00ff88; border: none; border-radius: 5px;">Click Me!</button>';\n\nlet btn = document.getElementById('testBtn');\nlet clicks = 0;\n\nbtn.addEventListener('click', (event) => {\n    clicks++;\n    console.log(\`Button clicked \${clicks} times!\`);\n    btn.textContent = \`Clicked \${clicks} times\`;\n});`
            },
            async: {
                title: "Async & Promises",
                description: "Handle asynchronous operations with promises and async/await.",
                challenges: [
                    "Create a promise",
                    "Use .then() to handle promise",
                    "Use async/await syntax",
                    "Handle errors with try/catch"
                ],
                hint: "new Promise((resolve, reject) => { }), async function() { await promise; }",
                starterCode: `// Promise\nlet promise = new Promise((resolve) => {\n    setTimeout(() => {\n        resolve("Data loaded!");\n    }, 1000);\n});\n\npromise.then(result => {\n    console.log(result);\n});\n\n// Async/await\nasync function fetchData() {\n    console.log("Fetching...");\n    await promise;\n    console.log("Complete!");\n}\n\nfetchData();`,
                solution: `let promise = new Promise((resolve) => {\n    setTimeout(() => {\n        resolve("Data loaded!");\n    }, 1000);\n});\n\npromise.then(result => {\n    console.log(result);\n});\n\nasync function fetchData() {\n    try {\n        console.log("Fetching...");\n        let result = await promise;\n        console.log(result);\n        console.log("Complete!");\n    } catch (error) {\n        console.error("Error:", error);\n    }\n}\n\nfetchData();`
            },
            classes: {
                title: "Classes & OOP",
                description: "Create objects using classes and object-oriented programming.",
                challenges: [
                    "Create a class with constructor",
                    "Add methods to the class",
                    "Create instances of the class",
                    "Use inheritance with extends"
                ],
                hint: "class Name { constructor(params) { this.prop = value; } method() { } }",
                starterCode: `class Person {\n    constructor(name, age) {\n        this.name = name;\n        this.age = age;\n    }\n    \n    greet() {\n        return \`Hi, I'm \${this.name}\`;\n    }\n}\n\nlet person = new Person("Alex", 25);\nconsole.log(person.greet());\nconsole.log(person.age);`,
                solution: `class Person {\n    constructor(name, age) {\n        this.name = name;\n        this.age = age;\n    }\n    \n    greet() {\n        return \`Hi, I'm \${this.name}\`;\n    }\n}\n\nclass Student extends Person {\n    constructor(name, age, grade) {\n        super(name, age);\n        this.grade = grade;\n    }\n    \n    study() {\n        return \`\${this.name} is studying\`;\n    }\n}\n\nlet student = new Student("Alex", 20, "A");\nconsole.log(student.greet());\nconsole.log(student.study());\nconsole.log(student.grade);`
            },
            canvas: {
                title: "Canvas Drawing",
                description: "Draw graphics and animations using the HTML5 Canvas API.",
                challenges: [
                    "Draw a rectangle",
                    "Draw a circle",
                    "Draw text",
                    "Create an animation loop"
                ],
                hint: "ctx.fillRect(x, y, w, h), ctx.arc(x, y, r, 0, Math.PI*2), ctx.fillText(text, x, y)",
                starterCode: `let canvas = document.getElementById('canvas-output');\nlet output = document.getElementById('output-display');\ncanvas.style.display = 'block';\noutput.style.display = 'none';\ncanvas.width = 600;\ncanvas.height = 400;\n\nlet ctx = canvas.getContext('2d');\n\n// Draw rectangle\nctx.fillStyle = '#00ff88';\nctx.fillRect(50, 50, 100, 100);\n\n// Draw circle\nctx.fillStyle = '#667eea';\nctx.beginPath();\nctx.arc(300, 100, 50, 0, Math.PI * 2);\nctx.fill();\n\nconsole.log("Canvas drawing complete!");`,
                solution: `let canvas = document.getElementById('canvas-output');\nlet output = document.getElementById('output-display');\ncanvas.style.display = 'block';\noutput.style.display = 'none';\ncanvas.width = 600;\ncanvas.height = 400;\n\nlet ctx = canvas.getContext('2d');\n\nlet x = 50;\nfunction animate() {\n    ctx.fillStyle = '#0a0a0a';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    \n    ctx.fillStyle = '#00ff88';\n    ctx.fillRect(x, 150, 50, 50);\n    \n    x += 2;\n    if (x > canvas.width) x = -50;\n    \n    requestAnimationFrame(animate);\n}\n\nanimate();\nconsole.log("Animation running!");`
            },
            algorithms: {
                title: "Algorithms",
                description: "Implement common algorithms like sorting and searching.",
                challenges: [
                    "Implement bubble sort",
                    "Find maximum value in array",
                    "Reverse a string",
                    "Check if number is prime"
                ],
                hint: "Use loops, comparisons, and array methods. Think step-by-step.",
                starterCode: `// Bubble sort\nfunction bubbleSort(arr) {\n    for (let i = 0; i < arr.length; i++) {\n        for (let j = 0; j < arr.length - i - 1; j++) {\n            if (arr[j] > arr[j + 1]) {\n                let temp = arr[j];\n                arr[j] = arr[j + 1];\n                arr[j + 1] = temp;\n            }\n        }\n    }\n    return arr;\n}\n\nlet numbers = [64, 34, 25, 12, 22, 11, 90];\nconsole.log(bubbleSort(numbers));`,
                solution: `function bubbleSort(arr) {\n    for (let i = 0; i < arr.length; i++) {\n        for (let j = 0; j < arr.length - i - 1; j++) {\n            if (arr[j] > arr[j + 1]) {\n                [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];\n            }\n        }\n    }\n    return arr;\n}\n\nfunction findMax(arr) {\n    return Math.max(...arr);\n}\n\nfunction reverseString(str) {\n    return str.split('').reverse().join('');\n}\n\nfunction isPrime(n) {\n    if (n <= 1) return false;\n    for (let i = 2; i <= Math.sqrt(n); i++) {\n        if (n % i === 0) return false;\n    }\n    return true;\n}\n\nconsole.log(bubbleSort([64, 34, 25, 12]));\nconsole.log(findMax([64, 34, 25, 12]));\nconsole.log(reverseString("hello"));\nconsole.log(isPrime(17));`
            },
            game: {
                title: "Simple Game",
                description: "Build a complete interactive game with graphics and user input.",
                challenges: [
                    "Create a player that moves",
                    "Add collision detection",
                    "Implement scoring system",
                    "Add game over condition"
                ],
                hint: "Use canvas, event listeners for keyboard input, and game loop with requestAnimationFrame",
                starterCode: `let canvas = document.getElementById('canvas-output');\nlet output = document.getElementById('output-display');\ncanvas.style.display = 'block';\noutput.style.display = 'none';\ncanvas.width = 600;\ncanvas.height = 400;\n\nlet ctx = canvas.getContext('2d');\n\nlet player = { x: 300, y: 350, width: 30, height: 30, speed: 5 };\nlet score = 0;\n\nlet keys = {};\nwindow.addEventListener('keydown', e => keys[e.key] = true);\nwindow.addEventListener('keyup', e => keys[e.key] = false);\n\nfunction gameLoop() {\n    // Clear\n    ctx.fillStyle = '#0a0a0a';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    \n    // Move player\n    if (keys['ArrowLeft'] && player.x > 0) player.x -= player.speed;\n    if (keys['ArrowRight'] && player.x < canvas.width - player.width) player.x += player.speed;\n    \n    // Draw player\n    ctx.fillStyle = '#00ff88';\n    ctx.fillRect(player.x, player.y, player.width, player.height);\n    \n    // Draw score\n    ctx.fillStyle = '#fff';\n    ctx.font = '20px Monaco';\n    ctx.fillText('Score: ' + score, 10, 30);\n    \n    requestAnimationFrame(gameLoop);\n}\n\ngameLoop();\nconsole.log("Game started! Use arrow keys to move.");`,
                solution: `let canvas = document.getElementById('canvas-output');\nlet output = document.getElementById('output-display');\ncanvas.style.display = 'block';\noutput.style.display = 'none';\ncanvas.width = 600;\ncanvas.height = 400;\n\nlet ctx = canvas.getContext('2d');\n\nlet player = { x: 285, y: 350, width: 30, height: 30, speed: 5 };\nlet enemy = { x: 285, y: 0, width: 30, height: 30, speed: 2 };\nlet score = 0;\nlet gameOver = false;\n\nlet keys = {};\nwindow.addEventListener('keydown', e => keys[e.key] = true);\nwindow.addEventListener('keyup', e => keys[e.key] = false);\n\nfunction gameLoop() {\n    if (gameOver) {\n        ctx.fillStyle = '#ff006e';\n        ctx.font = '40px Monaco';\n        ctx.fillText('GAME OVER', 180, 200);\n        return;\n    }\n    \n    ctx.fillStyle = '#0a0a0a';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    \n    if (keys['ArrowLeft'] && player.x > 0) player.x -= player.speed;\n    if (keys['ArrowRight'] && player.x < canvas.width - player.width) player.x += player.speed;\n    \n    enemy.y += enemy.speed;\n    if (enemy.y > canvas.height) {\n        enemy.y = 0;\n        enemy.x = Math.random() * (canvas.width - enemy.width);\n        score++;\n    }\n    \n    if (player.x < enemy.x + enemy.width &&\n        player.x + player.width > enemy.x &&\n        player.y < enemy.y + enemy.height &&\n        player.y + player.height > enemy.y) {\n        gameOver = true;\n    }\n    \n    ctx.fillStyle = '#00ff88';\n    ctx.fillRect(player.x, player.y, player.width, player.height);\n    \n    ctx.fillStyle = '#ff006e';\n    ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);\n    \n    ctx.fillStyle = '#fff';\n    ctx.font = '20px Monaco';\n    ctx.fillText('Score: ' + score, 10, 30);\n    \n    requestAnimationFrame(gameLoop);\n}\n\ngameLoop();`
            }
        };

        // ========================================
        // State Management
        // ========================================
        let currentLesson = 'variables';
        let completedLessons = JSON.parse(localStorage.getItem('completedLessons')) || [];
        let totalLines = parseInt(localStorage.getItem('totalLines')) || 0;

        // ========================================
        // Load Lesson
        // ========================================
        function loadLesson(lessonKey) {
            currentLesson = lessonKey;
            const lesson = lessons[lessonKey];

            document.getElementById('lessonTitle').textContent = lesson.title;
            document.getElementById('lessonDescription').textContent = lesson.description;

            const challengeList = document.getElementById('challengeList');
            challengeList.innerHTML = '';
            lesson.challenges.forEach(challenge => {
                const li = document.createElement('li');
                li.textContent = challenge;
                challengeList.appendChild(li);
            });

            document.getElementById('hintText').textContent = lesson.hint;
            document.getElementById('hintBox').style.display = 'none';

            document.getElementById('code-editor').value = lesson.starterCode;

            // Reset canvas/output display
            document.getElementById('canvas-output').style.display = 'none';
            document.getElementById('output-display').style.display = 'block';
            clearOutput();

            // Update active lesson
            document.querySelectorAll('.lesson-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.lesson === lessonKey) {
                    item.classList.add('active');
                }
            });

            updateStats();
        }

        // ========================================
        // Code Execution
        // ========================================
        const outputDisplay = document.getElementById('output-display');

        function clearOutput() {
            outputDisplay.innerHTML = '';
        }

        function addConsoleOutput(message, type = 'log') {
            const line = document.createElement('div');
            line.className = `console-line console-${type}`;
            line.textContent = typeof message === 'object' ? JSON.stringify(message, null, 2) : String(message);
            outputDisplay.appendChild(line);
            outputDisplay.scrollTop = outputDisplay.scrollHeight;
        }

        function runCode() {
            clearOutput();

            const code = document.getElementById('code-editor').value;

            // Override console methods
            const originalLog = console.log;
            const originalError = console.error;
            const originalWarn = console.warn;

            console.log = (...args) => {
                args.forEach(arg => addConsoleOutput(arg, 'log'));
            };

            console.error = (...args) => {
                args.forEach(arg => addConsoleOutput(arg, 'error'));
            };

            console.warn = (...args) => {
                args.forEach(arg => addConsoleOutput(arg, 'warn'));
            };

            try {
                // Execute code
                eval(code);

                // Mark lesson as completed if not already
                if (!completedLessons.includes(currentLesson)) {
                    completedLessons.push(currentLesson);
                    localStorage.setItem('completedLessons', JSON.stringify(completedLessons));

                    const lessonItem = document.querySelector(`[data-lesson="${currentLesson}"]`);
                    if (lessonItem) {
                        lessonItem.classList.add('completed');
                    }
                }

                // Update line count
                const lines = code.split('\n').length;
                totalLines += lines;
                localStorage.setItem('totalLines', totalLines);

                updateStats();

            } catch (error) {
                addConsoleOutput(`Error: ${error.message}`, 'error');
            }

            // Restore console methods
            console.log = originalLog;
            console.error = originalError;
            console.warn = originalWarn;
        }

        // ========================================
        // UI Event Handlers
        // ========================================
        document.getElementById('runBtn').addEventListener('click', runCode);

        document.getElementById('clearBtn').addEventListener('click', () => {
            document.getElementById('code-editor').value = '';
        });

        document.getElementById('clearOutputBtn').addEventListener('click', clearOutput);

        document.getElementById('hintBtn').addEventListener('click', () => {
            const hintBox = document.getElementById('hintBox');
            hintBox.style.display = hintBox.style.display === 'none' ? 'block' : 'none';
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            loadLesson(currentLesson);
        });

        document.querySelectorAll('.lesson-item').forEach(item => {
            item.addEventListener('click', () => {
                loadLesson(item.dataset.lesson);
            });
        });

        // Keyboard shortcut: Ctrl+Enter to run
        document.getElementById('code-editor').addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                runCode();
            }
        });

        // ========================================
        // Stats Update
        // ========================================
        function updateStats() {
            const total = Object.keys(lessons).length;
            const completed = completedLessons.length;
            document.getElementById('completedCount').textContent = `${completed}/${total}`;
            document.getElementById('linesCount').textContent = totalLines;

            // Calculate streak (simplified - days user has returned)
            const lastVisit = localStorage.getItem('lastVisit');
            const today = new Date().toDateString();

            if (lastVisit !== today) {
                localStorage.setItem('lastVisit', today);
                let streak = parseInt(localStorage.getItem('streak')) || 0;
                streak++;
                localStorage.setItem('streak', streak);
            }

            const streak = parseInt(localStorage.getItem('streak')) || 0;
            document.getElementById('streakCount').textContent = `${streak} days`;

            // Mark completed lessons
            completedLessons.forEach(lessonKey => {
                const item = document.querySelector(`[data-lesson="${lessonKey}"]`);
                if (item) {
                    item.classList.add('completed');
                }
            });
        }

        // ========================================
        // Data Management
        // ========================================
        document.getElementById('exportBtn').addEventListener('click', () => {
            const data = {
                completedLessons,
                totalLines,
                streak: localStorage.getItem('streak'),
                timestamp: new Date().toISOString()
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `coding-progress-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
        });

        // Initialize
        loadLesson('variables');
        updateStats();
    </script>
</body>
</html>