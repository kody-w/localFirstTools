<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Presentation Suite</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #000000;
            color: #ffffff;
            overflow: hidden;
            position: relative;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Welcome Screen */
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1;
        }

        .welcome-content {
            text-align: center;
            max-width: 800px;
            padding: 40px;
        }

        .welcome-content h1 {
            font-size: 64px;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #00a4ef 0%, #0078d4 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .welcome-content p {
            font-size: 24px;
            color: #888;
            margin-bottom: 40px;
        }

        .welcome-actions {
            display: flex;
            gap: 20px;
            justify-content: center;
        }

        .welcome-btn {
            padding: 15px 30px;
            font-size: 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .welcome-btn.primary {
            background: #0078d4;
            color: white;
        }

        .welcome-btn.primary:hover {
            background: #00a4ef;
            transform: translateY(-2px);
        }

        .welcome-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .welcome-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Full Screen Presentation Mode */
        .presentation-mode {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #000000;
            z-index: 9999;
            display: none;
        }

        .presentation-mode.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .presentation-container {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .slide {
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 80px;
            position: relative;
            background: #000000;
        }

        .slide.active {
            display: flex;
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(60px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Typography for Presentations */
        .slide h1 {
            font-size: 72px;
            font-weight: 600;
            margin-bottom: 40px;
            color: #ffffff;
            line-height: 1.2;
        }

        .slide-title h1 {
            font-size: 88px;
            font-weight: 700;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #00a4ef 0%, #0078d4 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .slide h2 {
            font-size: 48px;
            font-weight: 300;
            color: #b0b0b0;
            margin-bottom: 60px;
        }

        .slide h3 {
            font-size: 36px;
            margin-bottom: 30px;
            font-weight: 500;
        }

        .slide p {
            font-size: 24px;
            color: #888;
            line-height: 1.6;
        }

        .slide ul {
            list-style: none;
            text-align: left;
            max-width: 1000px;
            width: 100%;
        }

        .slide li {
            font-size: 32px;
            line-height: 1.8;
            margin-bottom: 30px;
            padding-left: 50px;
            position: relative;
            color: #e0e0e0;
        }

        .slide li:before {
            content: "▸";
            position: absolute;
            left: 0;
            color: #00a4ef;
            font-size: 40px;
        }

        /* Special Elements */
        .demo-prompt {
            background: #0078d4;
            color: white;
            padding: 40px 80px;
            border-radius: 60px;
            font-size: 40px;
            font-weight: 600;
            box-shadow: 0 15px 40px rgba(0, 120, 212, 0.4);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .transformation-table {
            width: 100%;
            max-width: 1000px;
            margin: 50px auto;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .transformation-table th {
            background: #0078d4;
            color: white;
            padding: 30px;
            font-size: 32px;
            font-weight: 600;
        }

        .transformation-table td {
            padding: 30px;
            font-size: 28px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .transformation-table tr:last-child td {
            border-bottom: none;
        }

        .transformation-table td:first-child {
            color: #888;
        }

        .transformation-table td:last-child {
            color: #00ff88;
            font-weight: 600;
        }

        .market-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 50px;
            margin: 50px 0;
            width: 100%;
            max-width: 1000px;
        }

        .stat-box {
            background: rgba(0, 164, 239, 0.1);
            border: 3px solid #00a4ef;
            border-radius: 20px;
            padding: 40px;
            transition: transform 0.3s ease;
        }

        .stat-box:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 56px;
            font-weight: 700;
            color: #00a4ef;
            margin-bottom: 15px;
        }

        .stat-label {
            font-size: 24px;
            color: #b0b0b0;
        }

        .testimonial {
            background: rgba(0, 255, 136, 0.1);
            border-left: 5px solid #00ff88;
            padding: 40px;
            margin: 30px auto;
            text-align: left;
            font-style: italic;
            border-radius: 12px;
            max-width: 900px;
            font-size: 32px;
        }

        .testimonial-source {
            text-align: right;
            font-size: 24px;
            color: #888;
            margin-top: 20px;
            font-style: normal;
        }

        .highlight {
            color: #00ff88;
            font-weight: 600;
        }

        .subtext {
            font-size: 24px;
            color: #888;
            margin-top: 30px;
        }

        /* Keyboard shortcut display */
        .keyboard-display {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #00a4ef;
            border-radius: 12px;
            padding: 30px;
            display: inline-block;
            font-family: 'Courier New', monospace;
            font-size: 28px;
            margin: 20px 0;
        }

        .feature-box {
            background: rgba(0, 120, 212, 0.1);
            border: 2px solid #0078d4;
            border-radius: 12px;
            padding: 30px;
            margin: 20px auto;
            max-width: 800px;
            text-align: left;
        }

        .feature-box h3 {
            color: #00a4ef;
            margin-bottom: 20px;
        }

        /* Presentation Navigation */
        .presentation-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: linear-gradient(to top, rgba(0,0,0,0.9), rgba(0,0,0,0));
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 10000;
        }

        .presentation-mode:hover .presentation-nav {
            opacity: 1;
        }

        .nav-btn {
            background: rgba(0, 120, 212, 0.8);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 30px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
        }

        .nav-btn:hover {
            background: rgba(0, 164, 239, 0.9);
            transform: translateY(-2px);
        }

        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .slide-indicator {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .slide-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .slide-dot.active {
            width: 24px;
            border-radius: 4px;
            background: #00a4ef;
        }

        /* Control Panel */
        .control-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 15px;
            z-index: 1000;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: #00a4ef;
        }

        .control-btn.primary {
            background: #0078d4;
            border-color: #0078d4;
        }

        .control-btn.primary:hover {
            background: #00a4ef;
            border-color: #00a4ef;
        }

        /* Edit Mode */
        .edit-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 200px;
            background: #1a1a1a;
            border-top: 1px solid #333;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            z-index: 999;
            padding: 20px;
            overflow-y: auto;
        }

        .edit-panel.active {
            transform: translateY(0);
        }

        .edit-controls {
            display: flex;
            gap: 20px;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .edit-input {
            flex: 1;
            padding: 12px;
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 8px;
            color: white;
            font-size: 16px;
        }

        .edit-input:focus {
            outline: none;
            border-color: #0078d4;
        }

        .edit-label {
            font-size: 14px;
            color: #888;
            min-width: 100px;
        }

        /* Microsoft Logo */
        .logo {
            position: fixed;
            top: 30px;
            left: 30px;
            width: 48px;
            height: 48px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4px;
            opacity: 0.8;
            z-index: 100;
        }

        .logo-square {
            width: 22px;
            height: 22px;
        }

        .logo-square.red { background: #f25022; }
        .logo-square.green { background: #7fba00; }
        .logo-square.blue { background: #00a4ef; }
        .logo-square.yellow { background: #ffb900; }

        /* Timer Display */
        .timer-display {
            position: fixed;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            color: #666;
            display: none;
            z-index: 10001;
        }

        .presentation-mode .timer-display {
            display: block;
        }

        /* Quick Access Thumbnails */
        .slide-thumbnails {
            position: fixed;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            display: none;
            flex-direction: column;
            gap: 10px;
            z-index: 10001;
            max-height: 80vh;
            overflow-y: auto;
        }

        .presentation-mode .slide-thumbnails {
            display: flex;
        }

        .thumbnail {
            width: 60px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .thumbnail:hover {
            border-color: #00a4ef;
            background: rgba(255, 255, 255, 0.2);
        }

        .thumbnail.active {
            border-color: #00a4ef;
            background: rgba(0, 120, 212, 0.3);
        }

        /* Loading State */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 20000;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: #00a4ef;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* File Input */
        input[type="file"] {
            display: none;
        }

        /* Export Modal */
        .export-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1a1a1a;
            border: 2px solid #333;
            border-radius: 12px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            display: none;
            z-index: 10002;
        }

        .export-modal.active {
            display: block;
        }

        .export-modal h3 {
            margin-bottom: 20px;
            color: #00a4ef;
        }

        .export-options {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .export-btn {
            flex: 1;
            padding: 15px;
            background: #0078d4;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .export-btn:hover {
            background: #00a4ef;
        }

        .export-btn.secondary {
            background: #333;
        }

        .export-btn.secondary:hover {
            background: #444;
        }

        /* Tutorial specific styles */
        .tutorial-icon {
            font-size: 100px;
            margin-bottom: 30px;
        }

        .code-block {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 20px;
            text-align: left;
            max-width: 800px;
            margin: 20px auto;
            overflow-x: auto;
        }

        /* Keyboard Hints */
        .keyboard-hints {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 8px;
            font-size: 12px;
            color: #666;
            display: none;
            backdrop-filter: blur(10px);
        }

        .keyboard-hints.visible {
            display: block;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide > * {
            animation: fadeIn 0.6s ease-out backwards;
        }

        .slide > *:nth-child(1) { animation-delay: 0.1s; }
        .slide > *:nth-child(2) { animation-delay: 0.2s; }
        .slide > *:nth-child(3) { animation-delay: 0.3s; }
        .slide > *:nth-child(4) { animation-delay: 0.4s; }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .slide h1 { font-size: 56px; }
            .slide-title h1 { font-size: 64px; }
            .slide h2 { font-size: 36px; }
            .slide li { font-size: 24px; }
            .stat-number { font-size: 42px; }
        }
    </style>
</head>
<body>
    <!-- Welcome Screen -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-content">
            <h1>Presentation Suite</h1>
            <p>Professional presentations made simple</p>
            <div class="welcome-actions">
                <button class="welcome-btn primary" onclick="startTutorial()">Start Tutorial</button>
                <button class="welcome-btn secondary" onclick="importPresentation()">Import JSON</button>
            </div>
        </div>
    </div>

    <!-- Microsoft Logo -->
    <div class="logo">
        <div class="logo-square red"></div>
        <div class="logo-square green"></div>
        <div class="logo-square blue"></div>
        <div class="logo-square yellow"></div>
    </div>

    <!-- Control Panel -->
    <div class="control-panel">
        <button class="control-btn" onclick="importPresentation()">📥 Import JSON</button>
        <button class="control-btn" onclick="showExportModal()">💾 Export</button>
        <button class="control-btn" onclick="toggleEditMode()">✏️ Quick Edit</button>
        <button class="control-btn primary" onclick="startPresentation()">▶️ Start Presentation</button>
    </div>

    <!-- Main Presentation Container -->
    <div class="presentation-mode" id="presentationMode">
        <div class="presentation-container" id="presentationContainer">
            <!-- Slides will be dynamically loaded here -->
        </div>

        <!-- Timer Display -->
        <div class="timer-display" id="timerDisplay">00:00</div>

        <!-- Slide Thumbnails -->
        <div class="slide-thumbnails" id="slideThumbnails"></div>

        <!-- Presentation Navigation -->
        <div class="presentation-nav">
            <button class="nav-btn" onclick="previousSlide()">◀ Previous</button>
            <div class="slide-indicator" id="slideIndicator"></div>
            <button class="nav-btn" onclick="nextSlide()">Next ▶</button>
            <button class="nav-btn" onclick="exitPresentation()">Exit</button>
        </div>
    </div>

    <!-- Edit Panel -->
    <div class="edit-panel" id="editPanel">
        <div class="edit-controls">
            <label class="edit-label">Quick Edit:</label>
            <input type="text" class="edit-input" id="quickEditInput" placeholder="Edit current slide title">
            <button class="control-btn" onclick="applyQuickEdit()">Apply</button>
            <button class="control-btn" onclick="toggleEditMode()">Close</button>
        </div>
    </div>

    <!-- Export Modal -->
    <div class="export-modal" id="exportModal">
        <h3>Export Presentation</h3>
        <div class="export-options">
            <button class="export-btn" onclick="exportJSON()">📄 Export as JSON</button>
            <button class="export-btn" onclick="exportHTML()">🌐 Export as HTML</button>
        </div>
        <button class="export-btn secondary" onclick="closeExportModal()">Cancel</button>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Keyboard Hints -->
    <div class="keyboard-hints" id="keyboardHints">
        <strong>Keyboard Shortcuts:</strong><br>
        Space/→: Next slide<br>
        ←: Previous slide<br>
        F: Fullscreen<br>
        ESC: Exit<br>
        1-9: Jump to slide
    </div>

    <!-- Hidden File Input -->
    <input type="file" id="fileInput" accept=".json" onchange="handleFileImport(event)">

    <script>
        // Global Variables
        let slides = [];
        let currentSlideIndex = 0;
        let presentationActive = false;
        let timerInterval = null;
        let startTime = null;

        // Tutorial presentation data
        const tutorialSlides = [
            {
                index: 1,
                html: `
                    <div class="slide-title">
                        <div class="tutorial-icon">🎯</div>
                        <h1>Welcome to Presentation Suite</h1>
                        <h2>Your Professional Presentation Tool</h2>
                        <p>Press SPACE or click Next to continue</p>
                    </div>
                `
            },
            {
                index: 2,
                html: `
                    <h1>Getting Started</h1>
                    <div class="feature-box">
                        <h3>📥 Import Your Presentation</h3>
                        <p>Click the "Import JSON" button to load your slides</p>
                    </div>
                    <div class="feature-box">
                        <h3>▶️ Start Presenting</h3>
                        <p>Click "Start Presentation" or press F for fullscreen mode</p>
                    </div>
                    <div class="feature-box">
                        <h3>💾 Export Your Work</h3>
                        <p>Save as JSON for editing or HTML for sharing</p>
                    </div>
                `
            },
            {
                index: 3,
                html: `
                    <h1>Navigation Controls</h1>
                    <h2>Use these keyboard shortcuts:</h2>
                    <div class="keyboard-display">Space or →</div>
                    <p>Next slide</p>
                    <div class="keyboard-display">←</div>
                    <p>Previous slide</p>
                    <div class="keyboard-display">1-9</div>
                    <p>Jump to specific slide</p>
                    <div class="keyboard-display">F</div>
                    <p>Toggle fullscreen</p>
                    <div class="keyboard-display">ESC</div>
                    <p>Exit presentation</p>
                `
            },
            {
                index: 4,
                html: `
                    <h1>Professional Features</h1>
                    <ul>
                        <li>⏱️ Built-in presentation timer</li>
                        <li>📊 Smooth slide transitions</li>
                        <li>🎨 Professional typography</li>
                        <li>📱 Touch gesture support</li>
                        <li>🖱️ Auto-hiding navigation</li>
                    </ul>
                `
            },
            {
                index: 5,
                html: `
                    <h1>Quick Edit Mode</h1>
                    <div class="demo-prompt">
                        ✏️ Make Last-Minute Changes
                    </div>
                    <p class="subtext">Click "Quick Edit" to modify slide titles without leaving the app</p>
                    <div class="feature-box">
                        <p>Perfect for:</p>
                        <ul style="font-size: 24px; margin-top: 20px;">
                            <li style="font-size: 24px;">Fixing typos</li>
                            <li style="font-size: 24px;">Updating numbers</li>
                            <li style="font-size: 24px;">Personalizing for your audience</li>
                        </ul>
                    </div>
                `
            },
            {
                index: 6,
                html: `
                    <h1>JSON Format</h1>
                    <p>Your presentations use this simple format:</p>
                    <div class="code-block">
[
  {
    "index": 1,
    "html": "&lt;h1&gt;Slide Title&lt;/h1&gt;..."
  },
  {
    "index": 2,
    "html": "&lt;h1&gt;Another Slide&lt;/h1&gt;..."
  }
]
                    </div>
                    <p class="subtext">Import existing presentations or create your own!</p>
                `
            },
            {
                index: 7,
                html: `
                    <h1>Export Options</h1>
                    <div class="market-stats">
                        <div class="stat-box">
                            <div class="stat-number">📄</div>
                            <div class="stat-label">JSON Export</div>
                            <p style="font-size: 18px; margin-top: 10px;">Edit and reimport later</p>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">🌐</div>
                            <div class="stat-label">HTML Export</div>
                            <p style="font-size: 18px; margin-top: 10px;">Share standalone file</p>
                        </div>
                    </div>
                `
            },
            {
                index: 8,
                html: `
                    <h1>Pro Tips</h1>
                    <div class="testimonial">
                        "Use number keys 1-9 for quick navigation during Q&A"
                        <div class="testimonial-source">- Power User Tip</div>
                    </div>
                    <div class="testimonial">
                        "Hover at the bottom to see navigation controls"
                        <div class="testimonial-source">- UI Tip</div>
                    </div>
                    <div class="testimonial">
                        "Export as HTML to share without needing this app"
                        <div class="testimonial-source">- Sharing Tip</div>
                    </div>
                `
            },
            {
                index: 9,
                html: `
                    <div class="slide-title">
                        <h1>Ready to Present!</h1>
                        <h2 class="highlight">You're all set to give amazing presentations</h2>
                        <div style="margin-top: 60px;">
                            <p style="font-size: 32px; margin-bottom: 30px;">Next steps:</p>
                            <ul style="display: inline-block; text-align: left;">
                                <li style="font-size: 28px;">1. Import your JSON presentation</li>
                                <li style="font-size: 28px;">2. Click "Start Presentation"</li>
                                <li style="font-size: 28px;">3. Impress your audience! 🎉</li>
                            </ul>
                        </div>
                    </div>
                `
            }
        ];

        // Initialize
        function initialize() {
            // Start with empty slides - user will choose
            slides = [];
            setupKeyboardShortcuts();
            setupTouchGestures();
        }

        // Start tutorial
        function startTutorial() {
            document.getElementById('welcomeScreen').style.display = 'none';
            slides = tutorialSlides;
            renderSlides();
            startPresentation();
        }

        // Import presentation
        function importPresentation() {
            document.getElementById('fileInput').click();
        }

        // Handle file import
        function handleFileImport(event) {
            const file = event.target.files[0];
            if (!file) return;

            showLoading(true);
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    slides = data;
                    currentSlideIndex = 0;
                    renderSlides();
                    showLoading(false);
                    
                    // Hide welcome screen if visible
                    document.getElementById('welcomeScreen').style.display = 'none';
                    
                    // Show success message
                    alert('Presentation loaded successfully! Click "Start Presentation" when ready.');
                } catch (error) {
                    alert('Error loading presentation file. Please check the JSON format.');
                    showLoading(false);
                }
            };
            reader.readAsText(file);
            
            // Reset file input
            event.target.value = '';
        }

        // Export functions
        function showExportModal() {
            if (slides.length === 0) {
                alert('No presentation to export. Please load a presentation first.');
                return;
            }
            document.getElementById('exportModal').classList.add('active');
        }

        function closeExportModal() {
            document.getElementById('exportModal').classList.remove('active');
        }

        function exportJSON() {
            const dataStr = JSON.stringify(slides, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', 'presentation.json');
            linkElement.click();
            
            closeExportModal();
        }

        function exportHTML() {
            // Get all slide HTML
            const slideElements = document.querySelectorAll('.slide');
            let slidesHTML = '';
            
            slideElements.forEach((slide, index) => {
                slidesHTML += `
        <div class="slide ${index === 0 ? 'active' : ''}">
            ${slide.innerHTML}
        </div>`;
            });

            // Create standalone HTML
            const htmlContent = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Presentation</title>
    <style>
        ${document.querySelector('style').textContent}
        
        /* Standalone specific styles */
        .control-panel, .edit-panel, .export-modal, .welcome-screen { display: none !important; }
        .presentation-mode { display: flex !important; position: relative !important; }
    </style>
</head>
<body>
    <div class="logo">
        <div class="logo-square red"></div>
        <div class="logo-square green"></div>
        <div class="logo-square blue"></div>
        <div class="logo-square yellow"></div>
    </div>

    <div class="presentation-mode active">
        <div class="presentation-container">
            ${slidesHTML}
        </div>

        <div class="timer-display" id="timerDisplay">00:00</div>
        <div class="slide-thumbnails" id="slideThumbnails"></div>

        <div class="presentation-nav">
            <button class="nav-btn" onclick="previousSlide()">◀ Previous</button>
            <div class="slide-indicator" id="slideIndicator"></div>
            <button class="nav-btn" onclick="nextSlide()">Next ▶</button>
        </div>
    </div>

    <script>
        let currentSlideIndex = 0;
        let slides = document.querySelectorAll('.slide');
        let timerInterval = null;
        let startTime = Date.now();

        function showSlide(index) {
            if (index >= slides.length) index = 0;
            if (index < 0) index = slides.length - 1;
            
            currentSlideIndex = index;
            
            slides.forEach((slide, i) => {
                slide.classList.toggle('active', i === index);
            });
            
            updateSlideIndicator();
            updateNavigationButtons();
            updateThumbnails();
        }

        function nextSlide() {
            if (currentSlideIndex < slides.length - 1) {
                showSlide(currentSlideIndex + 1);
            }
        }

        function previousSlide() {
            if (currentSlideIndex > 0) {
                showSlide(currentSlideIndex - 1);
            }
        }

        function updateSlideIndicator() {
            const indicator = document.getElementById('slideIndicator');
            indicator.innerHTML = '';
            
            for (let i = 0; i < slides.length; i++) {
                const dot = document.createElement('div');
                dot.className = 'slide-dot' + (i === currentSlideIndex ? ' active' : '');
                dot.onclick = () => showSlide(i);
                indicator.appendChild(dot);
            }
        }

        function updateThumbnails() {
            const thumbnails = document.getElementById('slideThumbnails');
            thumbnails.innerHTML = '';
            
            for (let i = 0; i < slides.length; i++) {
                const thumb = document.createElement('div');
                thumb.className = 'thumbnail' + (i === currentSlideIndex ? ' active' : '');
                thumb.textContent = i + 1;
                thumb.onclick = () => showSlide(i);
                thumbnails.appendChild(thumb);
            }
        }

        function updateNavigationButtons() {
            const prevBtn = document.querySelector('.presentation-nav button:first-child');
            const nextBtn = document.querySelector('.presentation-nav button:nth-child(3)');
            
            prevBtn.disabled = currentSlideIndex === 0;
            nextBtn.disabled = currentSlideIndex === slides.length - 1;
        }

        function updateTimer() {
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            
            document.getElementById('timerDisplay').textContent = 
                minutes.toString().padStart(2, '0') + ':' + seconds.toString().padStart(2, '0');
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'ArrowRight':
                case ' ':
                    e.preventDefault();
                    nextSlide();
                    break;
                case 'ArrowLeft':
                    e.preventDefault();
                    previousSlide();
                    break;
                case '1': case '2': case '3': case '4': case '5':
                case '6': case '7': case '8': case '9':
                    const slideNum = parseInt(e.key) - 1;
                    if (slideNum < slides.length) {
                        showSlide(slideNum);
                    }
                    break;
            }
        });

        // Touch support
        let touchStartX = 0;
        let touchEndX = 0;
        
        document.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        });
        
        document.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            if (touchEndX < touchStartX - 50) nextSlide();
            if (touchEndX > touchStartX + 50) previousSlide();
        });

        // Initialize
        updateSlideIndicator();
        updateNavigationButtons();
        updateThumbnails();
        timerInterval = setInterval(updateTimer, 1000);
        updateTimer();
    <\/script>
</body>
</html>`;

            // Download HTML file
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', url);
            linkElement.setAttribute('download', 'presentation-standalone.html');
            linkElement.click();
            
            URL.revokeObjectURL(url);
            closeExportModal();
        }

        // Render slides
        function renderSlides() {
            const container = document.getElementById('presentationContainer');
            container.innerHTML = '';
            
            slides.forEach((slide, index) => {
                const slideDiv = document.createElement('div');
                slideDiv.className = `slide ${index === 0 ? 'active' : ''}`;
                slideDiv.innerHTML = slide.html || '';
                container.appendChild(slideDiv);
            });
            
            updateSlideIndicator();
            updateThumbnails();
        }

        // Start presentation
        function startPresentation() {
            if (slides.length === 0) {
                alert('No presentation loaded. Please import a JSON file or start the tutorial.');
                return;
            }
            
            presentationActive = true;
            document.getElementById('presentationMode').classList.add('active');
            currentSlideIndex = 0;
            showSlide(currentSlideIndex);
            startTimer();
            
            // Request fullscreen with error handling
            const elem = document.getElementById('presentationMode');
            if (elem.requestFullscreen) {
                elem.requestFullscreen().catch(err => {
                    console.log('Fullscreen request failed:', err);
                });
            } else if (elem.webkitRequestFullscreen) {
                elem.webkitRequestFullscreen();
            } else if (elem.msRequestFullscreen) {
                elem.msRequestFullscreen();
            }
            
            // Show keyboard hints briefly
            showKeyboardHints();
        }

        // Exit presentation
        function exitPresentation() {
            presentationActive = false;
            document.getElementById('presentationMode').classList.remove('active');
            stopTimer();
            
            // Exit fullscreen
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.webkitExitFullscreen) {
                document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) {
                document.msExitFullscreen();
            }
        }

        // Show specific slide
        function showSlide(index) {
            const slideElements = document.querySelectorAll('.slide');
            
            if (index >= slides.length) index = 0;
            if (index < 0) index = slides.length - 1;
            
            currentSlideIndex = index;
            
            slideElements.forEach((slide, i) => {
                slide.classList.toggle('active', i === index);
            });
            
            updateSlideIndicator();
            updateThumbnails();
            updateNavigationButtons();
        }

        // Navigation functions
        function nextSlide() {
            if (currentSlideIndex < slides.length - 1) {
                showSlide(currentSlideIndex + 1);
            }
        }

        function previousSlide() {
            if (currentSlideIndex > 0) {
                showSlide(currentSlideIndex - 1);
            }
        }

        function goToSlide(index) {
            showSlide(index);
        }

        // Update slide indicator
        function updateSlideIndicator() {
            const indicator = document.getElementById('slideIndicator');
            if (!indicator) return;
            
            indicator.innerHTML = '';
            
            slides.forEach((_, index) => {
                const dot = document.createElement('div');
                dot.className = `slide-dot ${index === currentSlideIndex ? 'active' : ''}`;
                dot.onclick = () => goToSlide(index);
                indicator.appendChild(dot);
            });
        }

        // Update thumbnails
        function updateThumbnails() {
            const thumbnails = document.getElementById('slideThumbnails');
            if (!thumbnails) return;
            
            thumbnails.innerHTML = '';
            
            slides.forEach((_, index) => {
                const thumb = document.createElement('div');
                thumb.className = `thumbnail ${index === currentSlideIndex ? 'active' : ''}`;
                thumb.textContent = index + 1;
                thumb.onclick = () => goToSlide(index);
                thumbnails.appendChild(thumb);
            });
        }

        // Update navigation buttons
        function updateNavigationButtons() {
            const prevBtn = document.querySelector('.presentation-nav button:first-child');
            const nextBtn = document.querySelector('.presentation-nav button:nth-child(3)');
            
            if (prevBtn) prevBtn.disabled = currentSlideIndex === 0;
            if (nextBtn) nextBtn.disabled = currentSlideIndex === slides.length - 1;
        }

        // Timer functions
        function startTimer() {
            startTime = Date.now();
            timerInterval = setInterval(updateTimer, 1000);
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }

        function updateTimer() {
            if (!startTime) return;
            
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            
            const timerDisplay = document.getElementById('timerDisplay');
            if (timerDisplay) {
                timerDisplay.textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
        }

        // Edit mode
        function toggleEditMode() {
            if (slides.length === 0) {
                alert('No presentation loaded. Please import a presentation first.');
                return;
            }
            
            const editPanel = document.getElementById('editPanel');
            editPanel.classList.toggle('active');
            
            if (editPanel.classList.contains('active')) {
                const titleElement = document.querySelector('.slide.active h1');
                if (titleElement) {
                    document.getElementById('quickEditInput').value = titleElement.textContent;
                }
            }
        }

        function applyQuickEdit() {
            const newTitle = document.getElementById('quickEditInput').value;
            const titleElement = document.querySelector('.slide.active h1');
            
            if (titleElement && newTitle) {
                titleElement.textContent = newTitle;
                // Update the slides data
                const currentSlide = document.querySelector('.slide.active');
                slides[currentSlideIndex].html = currentSlide.innerHTML;
            }
        }

        // Keyboard shortcuts
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                if (!presentationActive && !document.getElementById('editPanel').classList.contains('active')) {
                    // Global shortcuts when not presenting
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        startPresentation();
                    }
                    return;
                }
                
                if (!presentationActive) return;
                
                switch(e.key) {
                    case 'ArrowRight':
                    case ' ':
                        e.preventDefault();
                        nextSlide();
                        break;
                    case 'ArrowLeft':
                        e.preventDefault();
                        previousSlide();
                        break;
                    case 'Escape':
                        exitPresentation();
                        break;
                    case 'f':
                    case 'F':
                        toggleFullscreen();
                        break;
                    case '1':
                    case '2':
                    case '3':
                    case '4':
                    case '5':
                    case '6':
                    case '7':
                    case '8':
                    case '9':
                        const slideNum = parseInt(e.key) - 1;
                        if (slideNum < slides.length) {
                            goToSlide(slideNum);
                        }
                        break;
                }
            });
        }

        // Touch gestures
        function setupTouchGestures() {
            let touchStartX = 0;
            let touchEndX = 0;
            
            document.addEventListener('touchstart', (e) => {
                touchStartX = e.changedTouches[0].screenX;
            });
            
            document.addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            });
            
            function handleSwipe() {
                if (!presentationActive) return;
                
                if (touchEndX < touchStartX - 50) {
                    nextSlide();
                }
                if (touchEndX > touchStartX + 50) {
                    previousSlide();
                }
            }
        }

        // Fullscreen toggle
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log('Fullscreen request failed:', err);
                });
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        }

        // Show loading
        function showLoading(show) {
            document.getElementById('loadingOverlay').classList.toggle('active', show);
        }

        // Show keyboard hints
        function showKeyboardHints() {
            const hints = document.getElementById('keyboardHints');
            hints.classList.add('visible');
            setTimeout(() => {
                hints.classList.remove('visible');
            }, 3000);
        }

        // Initialize on load
        window.addEventListener('load', initialize);
    </script>
</body>
</html>