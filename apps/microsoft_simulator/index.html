<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Macrohard AI - Autonomous Microsoft Simulation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0078d4;
            --secondary: #106ebe;
            --success: #107c10;
            --warning: #ffb900;
            --danger: #d13438;
            --dark: #323130;
            --light: #f3f2f1;
            --white: #ffffff;
            --shadow: 0 1.6px 3.6px 0 rgba(0,0,0,0.132), 0 0.3px 0.9px 0 rgba(0,0,0,0.108);
            --border-radius: 4px;
            --font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            --animation-speed: 0.3s;
        }

        body {
            font-family: var(--font-family);
            background: linear-gradient(135deg, #0078d4 0%, #40e0d0 100%);
            min-height: 100vh;
            color: var(--dark);
            overflow-x: hidden;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #0078d4, #40e0d0, #0078d4);
            animation: gradient 3s ease infinite;
        }

        @keyframes gradient {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #0078d4, #40e0d0);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 24px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .logo-text h1 {
            font-size: 32px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 4px;
        }

        .logo-text p {
            font-size: 14px;
            color: var(--dark);
            opacity: 0.8;
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--animation-speed);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: var(--shadow);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: var(--dark);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .simulation-speed {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: var(--light);
            border-radius: var(--border-radius);
        }

        .simulation-speed input {
            width: 150px;
        }

        .stats-bar {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-card {
            text-align: center;
            padding: 15px;
            background: var(--light);
            border-radius: var(--border-radius);
            transition: transform var(--animation-speed);
        }

        .stat-card:hover {
            transform: translateY(-3px);
        }

        .stat-value {
            font-size: 28px;
            font-weight: 600;
            color: var(--primary);
            display: block;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: var(--dark);
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 300px 1fr 350px;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .panel-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 15px 20px;
            font-weight: 500;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-body {
            padding: 20px;
            max-height: 600px;
            overflow-y: auto;
        }

        .agent-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .agent-item {
            padding: 12px;
            background: var(--light);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all var(--animation-speed);
            border: 2px solid transparent;
        }

        .agent-item:hover {
            background: white;
            border-color: var(--primary);
            transform: translateX(5px);
        }

        .agent-item.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .agent-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .agent-name {
            font-weight: 500;
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            animation: blink 2s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .status-idle { background: var(--warning); }
        .status-working { background: var(--success); }
        .status-error { background: var(--danger); }

        .agent-task {
            font-size: 12px;
            opacity: 0.8;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .transcript-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .transcript-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            padding: 12px 16px;
            border-radius: var(--border-radius);
            max-width: 80%;
            animation: slideIn var(--animation-speed);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-agent {
            background: var(--primary);
            color: white;
            align-self: flex-start;
        }

        .message-system {
            background: var(--light);
            color: var(--dark);
            align-self: flex-end;
        }

        .message-header {
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 4px;
        }

        .message-content {
            font-size: 14px;
            line-height: 1.5;
        }

        .input-container {
            padding: 20px;
            border-top: 1px solid var(--light);
            display: flex;
            gap: 10px;
        }

        .input-container input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid var(--light);
            border-radius: var(--border-radius);
            font-size: 14px;
            transition: border-color var(--animation-speed);
        }

        .input-container input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .pipeline-view {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .pipeline-stage {
            background: var(--light);
            border-radius: var(--border-radius);
            padding: 15px;
            transition: all var(--animation-speed);
        }

        .pipeline-stage.active {
            background: linear-gradient(135deg, rgba(0, 120, 212, 0.1), rgba(64, 224, 208, 0.1));
            border: 2px solid var(--primary);
        }

        .stage-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .stage-name {
            font-weight: 500;
            color: var(--primary);
        }

        .stage-progress {
            width: 100%;
            height: 8px;
            background: var(--light);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--success));
            transition: width 0.5s ease;
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { opacity: 0.8; }
            50% { opacity: 1; }
            100% { opacity: 0.8; }
        }

        .stage-tasks {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .task-badge {
            padding: 4px 8px;
            background: white;
            border-radius: 12px;
            font-size: 11px;
            color: var(--dark);
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .metric-card {
            background: var(--light);
            border-radius: var(--border-radius);
            padding: 15px;
            text-align: center;
        }

        .metric-value {
            font-size: 24px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 12px;
            color: var(--dark);
            opacity: 0.7;
        }

        .chart-container {
            background: var(--light);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 15px;
            height: 200px;
            display: flex;
            align-items: flex-end;
            gap: 10px;
        }

        .chart-bar {
            flex: 1;
            background: linear-gradient(to top, var(--primary), var(--success));
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            transition: height 0.5s ease;
            position: relative;
        }

        .chart-bar:hover {
            opacity: 0.8;
        }

        .chart-label {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            white-space: nowrap;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            display: none;
            align-items: center;
            gap: 10px;
            max-width: 400px;
            z-index: 1000;
            animation: slideInRight 0.3s ease;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification.show {
            display: flex;
        }

        .notification-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .notification-success { background: var(--success); }
        .notification-error { background: var(--danger); }
        .notification-warning { background: var(--warning); }

        .floating-action {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 100;
        }

        .fab {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            border: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--animation-speed);
            font-size: 24px;
        }

        .fab:hover {
            transform: scale(1.1);
            background: var(--secondary);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            animation: scaleIn 0.3s ease;
        }

        @keyframes scaleIn {
            from {
                transform: scale(0.9);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .modal-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--light);
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--primary);
        }

        .modal-body {
            margin-bottom: 20px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .loader {
            border: 3px solid var(--light);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .product-card {
            background: var(--light);
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            transition: transform var(--animation-speed);
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }

        .product-icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 15px;
            background: linear-gradient(135deg, var(--primary), var(--success));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
        }

        .product-name {
            font-weight: 500;
            margin-bottom: 5px;
        }

        .product-status {
            font-size: 12px;
            color: var(--dark);
            opacity: 0.7;
        }

        .timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--light);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 20px;
            padding: 15px;
            background: var(--light);
            border-radius: var(--border-radius);
            animation: fadeIn 0.5s ease;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -24px;
            top: 20px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--primary);
            border: 2px solid white;
        }

        .timeline-time {
            font-size: 12px;
            color: var(--dark);
            opacity: 0.7;
            margin-bottom: 5px;
        }

        .timeline-content {
            font-size: 14px;
            color: var(--dark);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateX(-10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">M</div>
                    <div class="logo-text">
                        <h1>Macrohard AI</h1>
                        <p>Autonomous Microsoft Simulation • 100% AI-Powered</p>
                    </div>
                </div>
                <div class="controls">
                    <button class="btn btn-primary" onclick="startSimulation()">
                        <span>▶</span> Start Simulation
                    </button>
                    <button class="btn btn-warning" onclick="pauseSimulation()">
                        <span>⏸</span> Pause
                    </button>
                    <button class="btn btn-danger" onclick="resetSimulation()">
                        <span>⏹</span> Reset
                    </button>
                    <div class="simulation-speed">
                        <label>Speed:</label>
                        <input type="range" id="speedControl" min="1" max="100" value="10" onchange="updateSpeed(this.value)">
                        <span id="speedDisplay">10x</span>
                    </div>
                    <button class="btn btn-success" onclick="exportState()">
                        <span>💾</span> Export
                    </button>
                    <button class="btn btn-primary" onclick="document.getElementById('importFile').click()">
                        <span>📁</span> Import
                    </button>
                    <input type="file" id="importFile" style="display: none;" onchange="importState(event)">
                </div>
            </div>
        </div>

        <!-- Stats Bar -->
        <div class="stats-bar">
            <div class="stat-card">
                <span class="stat-value" id="activeAgents">0</span>
                <span class="stat-label">Active Agents</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="tasksCompleted">0</span>
                <span class="stat-label">Tasks Completed</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="productsLaunched">0</span>
                <span class="stat-label">Products Launched</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="revenueGenerated">$0</span>
                <span class="stat-label">Revenue (Simulated)</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="timeElapsed">00:00</span>
                <span class="stat-label">Time Elapsed</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="efficiency">0%</span>
                <span class="stat-label">AI Efficiency</span>
            </div>
        </div>

        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Agents Panel -->
            <div class="panel">
                <div class="panel-header">
                    <span>AI Agents</span>
                    <span id="agentCount">0</span>
                </div>
                <div class="panel-body">
                    <div class="agent-list" id="agentList">
                        <!-- Agents will be dynamically added here -->
                    </div>
                </div>
            </div>

            <!-- Central Transcript -->
            <div class="panel">
                <div class="panel-header">
                    <span>Agent Communications</span>
                    <button class="btn btn-primary" style="padding: 5px 10px; font-size: 12px;" onclick="clearTranscript()">Clear</button>
                </div>
                <div class="transcript-container">
                    <div class="transcript-messages" id="transcript">
                        <!-- Messages will appear here -->
                    </div>
                    <div class="input-container">
                        <input type="text" id="commandInput" placeholder="Enter command or query..." onkeypress="handleCommand(event)">
                        <button class="btn btn-primary" onclick="sendCommand()">Send</button>
                    </div>
                </div>
            </div>

            <!-- Pipeline & Metrics -->
            <div class="panel">
                <div class="panel-header">
                    <span>Development Pipeline</span>
                </div>
                <div class="panel-body">
                    <div class="pipeline-view" id="pipeline">
                        <!-- Pipeline stages will be added here -->
                    </div>
                    
                    <h3 style="margin: 20px 0 10px; color: var(--primary);">Performance Metrics</h3>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-value" id="codeLines">0</div>
                            <div class="metric-label">Lines of Code</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="bugsFixed">0</div>
                            <div class="metric-label">Bugs Fixed</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="testsRun">0</div>
                            <div class="metric-label">Tests Run</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="deployments">0</div>
                            <div class="metric-label">Deployments</div>
                        </div>
                    </div>

                    <div class="chart-container" id="performanceChart">
                        <!-- Chart bars will be added here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Products Section -->
        <div class="panel">
            <div class="panel-header">
                <span>Simulated Product Launches</span>
            </div>
            <div class="panel-body">
                <div class="product-grid" id="productGrid">
                    <!-- Products will be added here -->
                </div>
            </div>
        </div>

        <!-- Timeline -->
        <div class="panel">
            <div class="panel-header">
                <span>Event Timeline</span>
            </div>
            <div class="panel-body">
                <div class="timeline" id="timeline">
                    <!-- Timeline events will be added here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <div class="notification-icon" id="notificationIcon"></div>
        <div>
            <div id="notificationTitle" style="font-weight: 500;"></div>
            <div id="notificationMessage" style="font-size: 14px; opacity: 0.9;"></div>
        </div>
    </div>

    <!-- Floating Actions -->
    <div class="floating-action">
        <button class="fab" onclick="showProductModal()">🚀</button>
        <button class="fab" onclick="showAgentModal()">🤖</button>
    </div>

    <!-- Modal -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Modal Title</h2>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Modal content -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="closeModal()">Close</button>
            </div>
        </div>
    </div>

    <script>
        // Simulation State
        let simulationState = {
            running: false,
            speed: 10,
            startTime: null,
            elapsedTime: 0,
            agents: [],
            tasks: [],
            products: [],
            metrics: {
                activeAgents: 0,
                tasksCompleted: 0,
                productsLaunched: 0,
                revenueGenerated: 0,
                codeLines: 0,
                bugsFixed: 0,
                testsRun: 0,
                deployments: 0,
                efficiency: 0
            },
            transcript: [],
            timeline: [],
            pipeline: [
                { name: 'Requirements', progress: 0, tasks: [] },
                { name: 'Design', progress: 0, tasks: [] },
                { name: 'Development', progress: 0, tasks: [] },
                { name: 'Testing', progress: 0, tasks: [] },
                { name: 'Deployment', progress: 0, tasks: [] },
                { name: 'Marketing', progress: 0, tasks: [] },
                { name: 'Support', progress: 0, tasks: [] }
            ]
        };

        // Agent Definitions
        const agentTypes = [
            { id: 'ceo', name: 'CEO Agent', role: 'Strategic Planning', icon: '👔' },
            { id: 'cto', name: 'CTO Agent', role: 'Technical Architecture', icon: '🔧' },
            { id: 'pm', name: 'Product Manager Agent', role: 'Product Strategy', icon: '📊' },
            { id: 'dev-senior', name: 'Senior Developer Agent', role: 'Core Development', icon: '👨‍💻' },
            { id: 'dev-frontend', name: 'Frontend Developer Agent', role: 'UI Development', icon: '🎨' },
            { id: 'dev-backend', name: 'Backend Developer Agent', role: 'API Development', icon: '⚙️' },
            { id: 'dev-ml', name: 'ML Engineer Agent', role: 'AI/ML Features', icon: '🤖' },
            { id: 'qa', name: 'QA Engineer Agent', role: 'Quality Assurance', icon: '🔍' },
            { id: 'devops', name: 'DevOps Engineer Agent', role: 'CI/CD Pipeline', icon: '🚀' },
            { id: 'security', name: 'Security Engineer Agent', role: 'Security Auditing', icon: '🔒' },
            { id: 'designer', name: 'UX Designer Agent', role: 'User Experience', icon: '🎯' },
            { id: 'marketing', name: 'Marketing Manager Agent', role: 'Product Marketing', icon: '📣' },
            { id: 'sales', name: 'Sales Director Agent', role: 'Sales Strategy', icon: '💼' },
            { id: 'support', name: 'Support Lead Agent', role: 'Customer Support', icon: '🤝' },
            { id: 'data', name: 'Data Scientist Agent', role: 'Analytics', icon: '📈' },
            { id: 'legal', name: 'Legal Advisor Agent', role: 'Compliance', icon: '⚖️' },
            { id: 'hr', name: 'HR Manager Agent', role: 'Team Management', icon: '👥' },
            { id: 'finance', name: 'CFO Agent', role: 'Financial Planning', icon: '💰' }
        ];

        // Product Templates
        const productTemplates = [
            { name: 'Azure AI Services', category: 'Cloud', revenue: 12000000 },
            { name: 'Office 365 AI', category: 'Productivity', revenue: 8000000 },
            { name: 'Teams AI Assistant', category: 'Collaboration', revenue: 6000000 },
            { name: 'Visual Studio Copilot', category: 'Development', revenue: 4000000 },
            { name: 'Windows AI Core', category: 'Operating System', revenue: 15000000 },
            { name: 'Xbox Game AI', category: 'Gaming', revenue: 7000000 },
            { name: 'Dynamics AI CRM', category: 'Business', revenue: 9000000 },
            { name: 'Power BI Intelligence', category: 'Analytics', revenue: 5000000 },
            { name: 'GitHub AI Tools', category: 'Development', revenue: 3000000 },
            { name: 'LinkedIn AI Recruiter', category: 'Professional', revenue: 4500000 }
        ];

        // Initialize Simulation
        function initializeSimulation() {
            // Create initial agents
            agentTypes.forEach((type, index) => {
                setTimeout(() => createAgent(type), index * 100);
            });

            // Initialize pipeline
            renderPipeline();
            
            // Start background processes
            setInterval(updateMetrics, 1000);
            setInterval(simulationTick, 100);
        }

        // Create Agent
        function createAgent(type) {
            const agent = {
                id: `${type.id}-${Date.now()}`,
                ...type,
                status: 'idle',
                currentTask: null,
                tasksCompleted: 0,
                efficiency: Math.floor(Math.random() * 20) + 80
            };
            
            simulationState.agents.push(agent);
            renderAgentList();
            
            addToTranscript(`${agent.name} initialized and ready`, 'system');
            addToTimeline(`${agent.name} joined the simulation`);
            
            if (simulationState.running) {
                assignTask(agent);
            }
        }

        // Render Agent List
        function renderAgentList() {
            const agentList = document.getElementById('agentList');
            agentList.innerHTML = '';
            
            simulationState.agents.forEach(agent => {
                const agentItem = document.createElement('div');
                agentItem.className = `agent-item ${agent.status === 'working' ? 'active' : ''}`;
                agentItem.onclick = () => selectAgent(agent.id);
                
                agentItem.innerHTML = `
                    <div class="agent-status">
                        <span class="agent-name">${agent.icon} ${agent.name}</span>
                        <div class="status-indicator status-${agent.status}"></div>
                    </div>
                    <div class="agent-task">${agent.currentTask || agent.role}</div>
                `;
                
                agentList.appendChild(agentItem);
            });
            
            document.getElementById('agentCount').textContent = simulationState.agents.length;
            document.getElementById('activeAgents').textContent = simulationState.agents.filter(a => a.status === 'working').length;
        }

        // Assign Task to Agent
        function assignTask(agent) {
            if (agent.status === 'working' || !simulationState.running) return;
            
            const taskTypes = [
                'Writing code module',
                'Reviewing pull request',
                'Running tests',
                'Fixing bugs',
                'Updating documentation',
                'Deploying service',
                'Analyzing metrics',
                'Optimizing performance',
                'Security scanning',
                'Customer feedback analysis',
                'Market research',
                'Feature planning',
                'Database optimization',
                'API integration',
                'UI enhancement'
            ];
            
            const task = taskTypes[Math.floor(Math.random() * taskTypes.length)];
            agent.status = 'working';
            agent.currentTask = task;
            
            const duration = Math.floor(Math.random() * 5000) + 2000;
            
            addToTranscript(`${agent.name}: Starting ${task}`, 'agent');
            
            setTimeout(() => completeTask(agent, task), duration / simulationState.speed);
            
            renderAgentList();
        }

        // Complete Task
        function completeTask(agent, task) {
            agent.status = 'idle';
            agent.currentTask = null;
            agent.tasksCompleted++;
            
            simulationState.metrics.tasksCompleted++;
            
            // Update relevant metrics
            if (task.includes('code')) {
                simulationState.metrics.codeLines += Math.floor(Math.random() * 500) + 100;
            }
            if (task.includes('bug')) {
                simulationState.metrics.bugsFixed += Math.floor(Math.random() * 5) + 1;
            }
            if (task.includes('test')) {
                simulationState.metrics.testsRun += Math.floor(Math.random() * 50) + 10;
            }
            if (task.includes('Deploy')) {
                simulationState.metrics.deployments++;
            }
            
            addToTranscript(`${agent.name}: Completed ${task}`, 'agent');
            
            // Update pipeline
            updatePipeline(task);
            
            // Chance to launch product
            if (Math.random() < 0.05) {
                launchProduct();
            }
            
            renderAgentList();
            
            // Assign new task
            if (simulationState.running) {
                setTimeout(() => assignTask(agent), 1000);
            }
        }

        // Update Pipeline
        function updatePipeline(task) {
            const stage = simulationState.pipeline.find(s => 
                task.toLowerCase().includes(s.name.toLowerCase().substring(0, 4))
            ) || simulationState.pipeline[2]; // Default to Development
            
            stage.progress = Math.min(100, stage.progress + Math.random() * 10);
            stage.tasks.push(task);
            if (stage.tasks.length > 5) stage.tasks.shift();
            
            renderPipeline();
        }

        // Render Pipeline
        function renderPipeline() {
            const pipelineContainer = document.getElementById('pipeline');
            pipelineContainer.innerHTML = '';
            
            simulationState.pipeline.forEach((stage, index) => {
                const stageDiv = document.createElement('div');
                stageDiv.className = `pipeline-stage ${stage.progress > 50 ? 'active' : ''}`;
                
                stageDiv.innerHTML = `
                    <div class="stage-header">
                        <span class="stage-name">${stage.name}</span>
                        <span>${Math.floor(stage.progress)}%</span>
                    </div>
                    <div class="stage-progress">
                        <div class="progress-bar" style="width: ${stage.progress}%"></div>
                    </div>
                    <div class="stage-tasks">
                        ${stage.tasks.map(t => `<span class="task-badge">${t}</span>`).join('')}
                    </div>
                `;
                
                pipelineContainer.appendChild(stageDiv);
            });
        }

        // Launch Product
        function launchProduct() {
            const template = productTemplates[Math.floor(Math.random() * productTemplates.length)];
            const product = {
                ...template,
                id: Date.now(),
                version: `${Math.floor(Math.random() * 3) + 1}.0`,
                launchDate: new Date().toLocaleString()
            };
            
            simulationState.products.push(product);
            simulationState.metrics.productsLaunched++;
            simulationState.metrics.revenueGenerated += product.revenue;
            
            renderProducts();
            
            showNotification('success', 'Product Launch!', `${product.name} v${product.version} launched successfully`);
            addToTimeline(`Launched ${product.name} v${product.version} - Projected revenue: $${product.revenue.toLocaleString()}`);
            
            // Announce in transcript
            addToTranscript(`SYSTEM: Successfully launched ${product.name} v${product.version}`, 'system');
        }

        // Render Products
        function renderProducts() {
            const productGrid = document.getElementById('productGrid');
            productGrid.innerHTML = '';
            
            simulationState.products.slice(-8).forEach(product => {
                const card = document.createElement('div');
                card.className = 'product-card';
                card.onclick = () => showProductDetails(product);
                
                card.innerHTML = `
                    <div class="product-icon">${getProductIcon(product.category)}</div>
                    <div class="product-name">${product.name}</div>
                    <div class="product-status">v${product.version} • ${product.category}</div>
                    <div style="margin-top: 10px; color: var(--success); font-weight: 500;">
                        $${(product.revenue / 1000000).toFixed(1)}M
                    </div>
                `;
                
                productGrid.appendChild(card);
            });
        }

        // Get Product Icon
        function getProductIcon(category) {
            const icons = {
                'Cloud': '☁️',
                'Productivity': '📝',
                'Collaboration': '👥',
                'Development': '💻',
                'Operating System': '🖥️',
                'Gaming': '🎮',
                'Business': '💼',
                'Analytics': '📊',
                'Professional': '👔'
            };
            return icons[category] || '📦';
        }

        // Add to Transcript
        function addToTranscript(message, type = 'agent') {
            const transcript = document.getElementById('transcript');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message message-${type}`;
            
            const time = new Date().toLocaleTimeString();
            messageDiv.innerHTML = `
                <div class="message-header">${time}</div>
                <div class="message-content">${message}</div>
            `;
            
            transcript.appendChild(messageDiv);
            transcript.scrollTop = transcript.scrollHeight;
            
            simulationState.transcript.push({ time, message, type });
        }

        // Add to Timeline
        function addToTimeline(event) {
            const timeline = document.getElementById('timeline');
            const item = document.createElement('div');
            item.className = 'timeline-item';
            
            const time = new Date().toLocaleTimeString();
            item.innerHTML = `
                <div class="timeline-time">${time}</div>
                <div class="timeline-content">${event}</div>
            `;
            
            timeline.insertBefore(item, timeline.firstChild);
            
            if (timeline.children.length > 10) {
                timeline.removeChild(timeline.lastChild);
            }
            
            simulationState.timeline.push({ time, event });
        }

        // Update Metrics
        function updateMetrics() {
            // Update displayed metrics
            document.getElementById('tasksCompleted').textContent = simulationState.metrics.tasksCompleted;
            document.getElementById('productsLaunched').textContent = simulationState.metrics.productsLaunched;
            document.getElementById('revenueGenerated').textContent = `$${(simulationState.metrics.revenueGenerated / 1000000).toFixed(1)}M`;
            document.getElementById('codeLines').textContent = simulationState.metrics.codeLines.toLocaleString();
            document.getElementById('bugsFixed').textContent = simulationState.metrics.bugsFixed;
            document.getElementById('testsRun').textContent = simulationState.metrics.testsRun;
            document.getElementById('deployments').textContent = simulationState.metrics.deployments;
            
            // Calculate efficiency
            if (simulationState.metrics.tasksCompleted > 0) {
                simulationState.metrics.efficiency = Math.min(100, 
                    Math.floor((simulationState.metrics.tasksCompleted / (simulationState.elapsedTime / 1000 || 1)) * 10)
                );
            }
            document.getElementById('efficiency').textContent = `${simulationState.metrics.efficiency}%`;
            
            // Update time
            if (simulationState.running) {
                simulationState.elapsedTime = Date.now() - simulationState.startTime;
                const seconds = Math.floor(simulationState.elapsedTime / 1000);
                const minutes = Math.floor(seconds / 60);
                document.getElementById('timeElapsed').textContent = 
                    `${String(minutes).padStart(2, '0')}:${String(seconds % 60).padStart(2, '0')}`;
            }
            
            // Update performance chart
            updatePerformanceChart();
        }

        // Update Performance Chart
        function updatePerformanceChart() {
            const chart = document.getElementById('performanceChart');
            const metrics = [
                { label: 'Code', value: Math.min(100, simulationState.metrics.codeLines / 1000) },
                { label: 'Tests', value: Math.min(100, simulationState.metrics.testsRun / 10) },
                { label: 'Bugs Fixed', value: Math.min(100, simulationState.metrics.bugsFixed * 5) },
                { label: 'Deploys', value: Math.min(100, simulationState.metrics.deployments * 10) },
                { label: 'Efficiency', value: simulationState.metrics.efficiency }
            ];
            
            chart.innerHTML = metrics.map(m => `
                <div class="chart-bar" style="height: ${m.value}%">
                    <span class="chart-label">${m.label}</span>
                </div>
            `).join('');
        }

        // Simulation Tick
        function simulationTick() {
            if (!simulationState.running) return;
            
            // Random events
            if (Math.random() < 0.01) {
                const events = [
                    'Security audit completed successfully',
                    'Performance optimization achieved 20% improvement',
                    'Customer satisfaction score increased',
                    'New AI model trained and deployed',
                    'Database migration completed',
                    'API rate limits optimized',
                    'Cost reduction of 15% achieved',
                    'New partnership established',
                    'Patent application filed',
                    'Compliance certification obtained'
                ];
                const event = events[Math.floor(Math.random() * events.length)];
                addToTimeline(event);
                showNotification('success', 'Achievement', event);
            }
            
            // Inter-agent communication
            if (Math.random() < 0.05 && simulationState.agents.length > 1) {
                const agent1 = simulationState.agents[Math.floor(Math.random() * simulationState.agents.length)];
                const agent2 = simulationState.agents[Math.floor(Math.random() * simulationState.agents.length)];
                if (agent1.id !== agent2.id) {
                    const messages = [
                        `${agent1.name} → ${agent2.name}: Code review requested`,
                        `${agent1.name} → ${agent2.name}: Collaboration on feature implementation`,
                        `${agent1.name} → ${agent2.name}: Status update provided`,
                        `${agent1.name} → ${agent2.name}: Testing assistance needed`,
                        `${agent1.name} → ${agent2.name}: Architecture decision required`
                    ];
                    const message = messages[Math.floor(Math.random() * messages.length)];
                    addToTranscript(message, 'agent');
                }
            }
        }

        // Control Functions
        function startSimulation() {
            if (!simulationState.running) {
                simulationState.running = true;
                simulationState.startTime = Date.now() - simulationState.elapsedTime;
                
                // Start all agents
                simulationState.agents.forEach(agent => {
                    if (agent.status === 'idle') {
                        setTimeout(() => assignTask(agent), Math.random() * 2000);
                    }
                });
                
                addToTranscript('Simulation started - All agents activated', 'system');
                showNotification('success', 'Simulation Started', 'All AI agents are now active');
            }
        }

        function pauseSimulation() {
            simulationState.running = false;
            addToTranscript('Simulation paused', 'system');
            showNotification('warning', 'Simulation Paused', 'All agents on standby');
        }

        function resetSimulation() {
            simulationState.running = false;
            simulationState.elapsedTime = 0;
            simulationState.metrics = {
                activeAgents: 0,
                tasksCompleted: 0,
                productsLaunched: 0,
                revenueGenerated: 0,
                codeLines: 0,
                bugsFixed: 0,
                testsRun: 0,
                deployments: 0,
                efficiency: 0
            };
            simulationState.products = [];
            simulationState.transcript = [];
            simulationState.timeline = [];
            simulationState.pipeline.forEach(stage => {
                stage.progress = 0;
                stage.tasks = [];
            });
            
            document.getElementById('transcript').innerHTML = '';
            document.getElementById('timeline').innerHTML = '';
            document.getElementById('productGrid').innerHTML = '';
            
            renderPipeline();
            updateMetrics();
            
            addToTranscript('Simulation reset - Ready to start', 'system');
            showNotification('warning', 'Simulation Reset', 'All data cleared');
        }

        function updateSpeed(value) {
            simulationState.speed = parseInt(value);
            document.getElementById('speedDisplay').textContent = `${value}x`;
        }

        function clearTranscript() {
            document.getElementById('transcript').innerHTML = '';
            simulationState.transcript = [];
            addToTranscript('Transcript cleared', 'system');
        }

        // Command Handling
        function handleCommand(event) {
            if (event.key === 'Enter') {
                sendCommand();
            }
        }

        function sendCommand() {
            const input = document.getElementById('commandInput');
            const command = input.value.trim();
            
            if (!command) return;
            
            addToTranscript(`USER: ${command}`, 'system');
            
            // Process command
            processCommand(command);
            
            input.value = '';
        }

        function processCommand(command) {
            const cmd = command.toLowerCase();
            
            if (cmd.includes('status')) {
                const status = `
                    Simulation Status: ${simulationState.running ? 'Running' : 'Paused'}
                    Active Agents: ${simulationState.agents.filter(a => a.status === 'working').length}/${simulationState.agents.length}
                    Tasks Completed: ${simulationState.metrics.tasksCompleted}
                    Products Launched: ${simulationState.metrics.productsLaunched}
                    Revenue Generated: $${(simulationState.metrics.revenueGenerated / 1000000).toFixed(1)}M
                `;
                addToTranscript(status, 'system');
            } else if (cmd.includes('help')) {
                const help = `
                    Available Commands:
                    - status: Show simulation status
                    - launch: Force product launch
                    - agents: List all agents
                    - metrics: Show detailed metrics
                    - speed [1-100]: Set simulation speed
                    - help: Show this help
                `;
                addToTranscript(help, 'system');
            } else if (cmd.includes('launch')) {
                launchProduct();
                addToTranscript('Forced product launch initiated', 'system');
            } else if (cmd.includes('agents')) {
                const agentList = simulationState.agents.map(a => 
                    `${a.name} - ${a.status} - Tasks: ${a.tasksCompleted}`
                ).join('\n');
                addToTranscript(agentList, 'system');
            } else if (cmd.includes('metrics')) {
                const metrics = Object.entries(simulationState.metrics)
                    .map(([key, value]) => `${key}: ${value}`)
                    .join('\n');
                addToTranscript(metrics, 'system');
            } else if (cmd.startsWith('speed')) {
                const speed = parseInt(cmd.split(' ')[1]);
                if (speed >= 1 && speed <= 100) {
                    updateSpeed(speed);
                    document.getElementById('speedControl').value = speed;
                    addToTranscript(`Simulation speed set to ${speed}x`, 'system');
                }
            } else {
                addToTranscript('Unknown command. Type "help" for available commands.', 'system');
            }
        }

        // State Management
        function exportState() {
            const state = JSON.stringify(simulationState, null, 2);
            const blob = new Blob([state], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `macrohard-state-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('success', 'State Exported', 'Simulation state saved to file');
        }

        function importState(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const state = JSON.parse(e.target.result);
                    simulationState = state;
                    
                    // Restore UI
                    renderAgentList();
                    renderPipeline();
                    renderProducts();
                    updateMetrics();
                    
                    // Restore transcript
                    document.getElementById('transcript').innerHTML = '';
                    state.transcript.forEach(msg => {
                        addToTranscript(msg.message, msg.type);
                    });
                    
                    // Restore timeline
                    document.getElementById('timeline').innerHTML = '';
                    state.timeline.forEach(event => {
                        addToTimeline(event.event);
                    });
                    
                    showNotification('success', 'State Imported', 'Simulation state restored from file');
                } catch (error) {
                    showNotification('error', 'Import Failed', 'Invalid state file');
                }
            };
            reader.readAsText(file);
        }

        // UI Functions
        function selectAgent(agentId) {
            const agent = simulationState.agents.find(a => a.id === agentId);
            if (agent) {
                showAgentDetails(agent);
            }
        }

        function showAgentDetails(agent) {
            const modalBody = `
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                    <div style="font-size: 48px;">${agent.icon}</div>
                    <div>
                        <h3>${agent.name}</h3>
                        <p style="color: var(--gray);">${agent.role}</p>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="metric-card">
                        <div class="metric-value">${agent.status}</div>
                        <div class="metric-label">Current Status</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${agent.tasksCompleted}</div>
                        <div class="metric-label">Tasks Completed</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${agent.efficiency}%</div>
                        <div class="metric-label">Efficiency</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${agent.currentTask || 'None'}</div>
                        <div class="metric-label">Current Task</div>
                    </div>
                </div>
            `;
            
            showModal(`Agent Details: ${agent.name}`, modalBody);
        }

        function showProductDetails(product) {
            const modalBody = `
                <div style="text-align: center; margin-bottom: 20px;">
                    <div style="font-size: 64px; margin-bottom: 15px;">${getProductIcon(product.category)}</div>
                    <h3>${product.name}</h3>
                    <p style="color: var(--gray);">Version ${product.version}</p>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="metric-card">
                        <div class="metric-value">$${(product.revenue / 1000000).toFixed(1)}M</div>
                        <div class="metric-label">Revenue</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">${product.category}</div>
                        <div class="metric-label">Category</div>
                    </div>
                </div>
                <p style="margin-top: 20px; color: var(--gray);">
                    Launched: ${product.launchDate}
                </p>
            `;
            
            showModal(`Product Details: ${product.name}`, modalBody);
        }

        function showProductModal() {
            const modalBody = `
                <h3>Force Product Launch</h3>
                <p>Select a product to launch immediately:</p>
                <div style="display: grid; gap: 10px; margin-top: 20px;">
                    ${productTemplates.map(p => `
                        <button class="btn btn-primary" onclick="forceProductLaunch('${p.name}')" style="justify-content: space-between;">
                            <span>${p.name}</span>
                            <span>$${(p.revenue / 1000000).toFixed(1)}M</span>
                        </button>
                    `).join('')}
                </div>
            `;
            
            showModal('Launch Product', modalBody);
        }

        function showAgentModal() {
            const modalBody = `
                <h3>Add New Agent</h3>
                <p>Select an agent type to add to the simulation:</p>
                <div style="display: grid; gap: 10px; margin-top: 20px; max-height: 400px; overflow-y: auto;">
                    ${agentTypes.map(type => `
                        <button class="btn btn-primary" onclick="addNewAgent('${type.id}')" style="justify-content: flex-start;">
                            <span>${type.icon}</span>
                            <span>${type.name}</span>
                        </button>
                    `).join('')}
                </div>
            `;
            
            showModal('Add Agent', modalBody);
        }

        function forceProductLaunch(productName) {
            const template = productTemplates.find(p => p.name === productName);
            if (template) {
                const product = {
                    ...template,
                    id: Date.now(),
                    version: `${Math.floor(Math.random() * 3) + 1}.0`,
                    launchDate: new Date().toLocaleString()
                };
                
                simulationState.products.push(product);
                simulationState.metrics.productsLaunched++;
                simulationState.metrics.revenueGenerated += product.revenue;
                
                renderProducts();
                closeModal();
                
                showNotification('success', 'Product Launched!', `${product.name} launched successfully`);
                addToTimeline(`Manually launched ${product.name}`);
            }
        }

        function addNewAgent(typeId) {
            const type = agentTypes.find(t => t.id === typeId);
            if (type) {
                createAgent(type);
                closeModal();
                showNotification('success', 'Agent Added', `${type.name} joined the simulation`);
            }
        }

        function showModal(title, body) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalBody').innerHTML = body;
            document.getElementById('modal').classList.add('show');
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('show');
        }

        function showNotification(type, title, message) {
            const notification = document.getElementById('notification');
            const icon = document.getElementById('notificationIcon');
            
            icon.className = `notification-icon notification-${type}`;
            icon.textContent = type === 'success' ? '✓' : type === 'error' ? '✗' : '!';
            
            document.getElementById('notificationTitle').textContent = title;
            document.getElementById('notificationMessage').textContent = message;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 5000);
        }

        // Initialize on load
        window.onload = function() {
            initializeSimulation();
            addToTranscript('Macrohard AI Simulation initialized - Click "Start Simulation" to begin', 'system');
            addToTimeline('System initialized - Ready to simulate Microsoft operations');
        };

        // Handle modal close on outside click
        window.onclick = function(event) {
            const modal = document.getElementById('modal');
            if (event.target === modal) {
                closeModal();
            }
        };
    </script>
</body>
</html>