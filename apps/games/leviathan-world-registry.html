<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LEVIATHAN: Public Worlds Registry</title>
    <style>
        /* ============================================
           CSS RESET & VARIABLES
           ============================================ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a1a;
            --bg-secondary: #0f0f2a;
            --bg-tertiary: #1a1a3a;
            --bg-card: linear-gradient(135deg, #0f0f2a 0%, #1a1a4a 100%);
            --bg-card-hover: linear-gradient(135deg, #1a1a3a 0%, #2a2a5a 100%);
            --accent-cyan: #0ff;
            --accent-magenta: #f0f;
            --accent-purple: #bf00ff;
            --accent-blue: #00aaff;
            --accent-green: #0f0;
            --accent-orange: #ff8800;
            --accent-red: #ff4444;
            --text-primary: #ffffff;
            --text-secondary: #aaaaaa;
            --text-muted: #666666;
            --border-color: rgba(0, 255, 255, 0.3);
            --border-hover: rgba(0, 255, 255, 0.6);
            --shadow-glow: 0 0 30px rgba(0, 255, 255, 0.2);
            --shadow-glow-strong: 0 0 50px rgba(0, 255, 255, 0.4);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 20px;
            --radius-xl: 30px;
            --transition-fast: 0.2s ease;
            --transition-medium: 0.3s ease;
            --transition-slow: 0.5s ease;
            --font-mono: 'SF Mono', 'Fira Code', 'Consolas', monospace;
            --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        /* ============================================
           BASE STYLES
           ============================================ */
        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-sans);
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent-cyan);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-magenta);
        }

        /* ============================================
           ANIMATED BACKGROUND
           ============================================ */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
            pointer-events: none;
        }

        .bg-animation::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background:
                radial-gradient(ellipse at 20% 30%, rgba(0, 255, 255, 0.05) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 70%, rgba(255, 0, 255, 0.05) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 50%, rgba(0, 100, 255, 0.03) 0%, transparent 60%);
            animation: bgPulse 20s ease-in-out infinite;
        }

        @keyframes bgPulse {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(-2%, -2%) rotate(1deg); }
            50% { transform: translate(2%, 2%) rotate(-1deg); }
            75% { transform: translate(-1%, 1%) rotate(0.5deg); }
        }

        .stars {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(2px 2px at 20px 30px, rgba(255,255,255,0.3), transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(0,255,255,0.2), transparent),
                radial-gradient(1px 1px at 90px 40px, rgba(255,255,255,0.4), transparent),
                radial-gradient(2px 2px at 160px 120px, rgba(255,0,255,0.2), transparent),
                radial-gradient(1px 1px at 230px 80px, rgba(255,255,255,0.3), transparent),
                radial-gradient(2px 2px at 300px 150px, rgba(0,255,255,0.3), transparent);
            background-repeat: repeat;
            background-size: 350px 200px;
            animation: starsMove 60s linear infinite;
        }

        @keyframes starsMove {
            0% { transform: translateY(0); }
            100% { transform: translateY(-200px); }
        }

        /* ============================================
           HEADER
           ============================================ */
        header {
            background: linear-gradient(180deg, rgba(10, 10, 26, 0.98) 0%, rgba(10, 10, 26, 0.9) 100%);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-color);
            padding: 20px 40px;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-magenta));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            animation: logoFloat 3s ease-in-out infinite;
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .logo-text h1 {
            font-size: 1.8em;
            font-weight: 700;
            background: linear-gradient(90deg, var(--accent-cyan), var(--accent-magenta));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 2px;
        }

        .logo-text p {
            font-size: 0.85em;
            color: var(--text-muted);
            letter-spacing: 1px;
        }

        .header-stats {
            display: flex;
            gap: 30px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: 700;
            color: var(--accent-cyan);
            font-family: var(--font-mono);
        }

        .stat-label {
            font-size: 0.75em;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* ============================================
           MAIN CONTENT
           ============================================ */
        main {
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px;
        }

        /* ============================================
           FILTER BAR
           ============================================ */
        .filter-bar {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 25px;
            margin-bottom: 40px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: center;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-label {
            font-size: 0.75em;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .search-input {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 12px 20px;
            color: var(--text-primary);
            font-size: 1em;
            width: 300px;
            transition: var(--transition-fast);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .category-filters {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .category-btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-xl);
            padding: 10px 20px;
            color: var(--text-secondary);
            font-size: 0.9em;
            cursor: pointer;
            transition: var(--transition-fast);
            text-transform: capitalize;
        }

        .category-btn:hover {
            border-color: var(--accent-cyan);
            color: var(--accent-cyan);
        }

        .category-btn.active {
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-blue));
            border-color: transparent;
            color: var(--bg-primary);
            font-weight: 600;
        }

        .filter-actions {
            margin-left: auto;
            display: flex;
            gap: 10px;
        }

        .refresh-btn {
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-magenta));
            border: none;
            border-radius: var(--radius-md);
            padding: 12px 25px;
            color: white;
            font-size: 0.95em;
            cursor: pointer;
            transition: var(--transition-fast);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .refresh-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }

        .refresh-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .refresh-btn .spinner {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* ============================================
           WORLDS GRID
           ============================================ */
        .worlds-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 30px;
        }

        .world-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            overflow: hidden;
            transition: var(--transition-medium);
            cursor: pointer;
            position: relative;
        }

        .world-card:hover {
            transform: translateY(-8px);
            border-color: var(--border-hover);
            box-shadow: var(--shadow-glow-strong);
        }

        .world-card.featured::before {
            content: 'FEATURED';
            position: absolute;
            top: 15px;
            right: -35px;
            background: linear-gradient(90deg, var(--accent-orange), var(--accent-red));
            color: white;
            font-size: 0.7em;
            font-weight: 700;
            padding: 5px 40px;
            transform: rotate(45deg);
            z-index: 10;
            letter-spacing: 1px;
        }

        .world-thumbnail {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .world-thumbnail::before {
            content: '';
            position: absolute;
            width: 150%;
            height: 150%;
            background: radial-gradient(circle at center, rgba(0, 255, 255, 0.1) 0%, transparent 70%);
            animation: thumbnailPulse 4s ease-in-out infinite;
        }

        @keyframes thumbnailPulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.2); opacity: 0.8; }
        }

        .world-thumbnail .biome-icon {
            font-size: 72px;
            position: relative;
            z-index: 1;
            filter: drop-shadow(0 0 20px rgba(0, 255, 255, 0.5));
        }

        .world-content {
            padding: 25px;
        }

        .world-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .world-title {
            font-size: 1.4em;
            font-weight: 700;
            color: var(--accent-cyan);
            margin-bottom: 5px;
        }

        .world-author {
            font-size: 0.85em;
            color: var(--text-muted);
        }

        .world-category {
            background: rgba(0, 255, 255, 0.15);
            color: var(--accent-cyan);
            padding: 5px 12px;
            border-radius: var(--radius-xl);
            font-size: 0.75em;
            text-transform: uppercase;
            letter-spacing: 1px;
            white-space: nowrap;
        }

        .world-description {
            color: var(--text-secondary);
            font-size: 0.95em;
            line-height: 1.6;
            margin-bottom: 20px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .world-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .world-tag {
            background: var(--bg-tertiary);
            color: var(--text-muted);
            padding: 4px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.75em;
        }

        .world-stats {
            display: flex;
            gap: 20px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .world-stat {
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--text-muted);
            font-size: 0.85em;
        }

        .world-stat-icon {
            font-size: 1.1em;
        }

        /* ============================================
           LOADING STATE
           ============================================ */
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 100px 20px;
            text-align: center;
        }

        .loading-spinner {
            width: 80px;
            height: 80px;
            border: 4px solid var(--bg-tertiary);
            border-top-color: var(--accent-cyan);
            border-right-color: var(--accent-magenta);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 30px;
        }

        .loading-text {
            font-size: 1.2em;
            color: var(--text-secondary);
        }

        .loading-subtext {
            font-size: 0.9em;
            color: var(--text-muted);
            margin-top: 10px;
            font-family: var(--font-mono);
        }

        /* ============================================
           ERROR STATE
           ============================================ */
        .error-container {
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid rgba(255, 68, 68, 0.3);
            border-radius: var(--radius-lg);
            padding: 40px;
            text-align: center;
            margin: 40px 0;
        }

        .error-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .error-title {
            font-size: 1.4em;
            color: var(--accent-red);
            margin-bottom: 10px;
        }

        .error-message {
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .retry-btn {
            background: var(--accent-red);
            border: none;
            border-radius: var(--radius-md);
            padding: 12px 30px;
            color: white;
            font-size: 1em;
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .retry-btn:hover {
            background: #ff6666;
            transform: translateY(-2px);
        }

        /* ============================================
           EMPTY STATE
           ============================================ */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: var(--text-muted);
        }

        .empty-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-text {
            font-size: 1.2em;
        }

        /* ============================================
           WORLD DETAIL MODAL
           ============================================ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-medium);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            width: 100%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            transform: scale(0.9) translateY(20px);
            transition: var(--transition-medium);
        }

        .modal-overlay.active .modal-content {
            transform: scale(1) translateY(0);
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition-fast);
            z-index: 10;
        }

        .modal-close:hover {
            background: var(--accent-red);
            border-color: var(--accent-red);
            color: white;
        }

        .modal-header {
            background: linear-gradient(180deg, var(--bg-tertiary) 0%, transparent 100%);
            padding: 40px 40px 30px;
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
        }

        .modal-thumbnail {
            width: 200px;
            height: 200px;
            background: var(--bg-primary);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .modal-thumbnail .biome-icon {
            font-size: 80px;
        }

        .modal-info {
            flex: 1;
            min-width: 250px;
        }

        .modal-title {
            font-size: 2em;
            font-weight: 700;
            background: linear-gradient(90deg, var(--accent-cyan), var(--accent-magenta));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .modal-author {
            color: var(--text-muted);
            margin-bottom: 15px;
        }

        .modal-meta {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .modal-meta-item {
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            padding: 8px 15px;
            font-size: 0.85em;
        }

        .modal-meta-item .label {
            color: var(--text-muted);
            margin-right: 5px;
        }

        .modal-meta-item .value {
            color: var(--accent-cyan);
            font-weight: 600;
        }

        .modal-body {
            padding: 0 40px 40px;
        }

        .detail-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--accent-cyan);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(0, 255, 255, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title .icon {
            font-size: 1.2em;
        }

        .description-full {
            color: var(--text-secondary);
            line-height: 1.8;
        }

        .config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
        }

        .config-item {
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            padding: 15px;
        }

        .config-label {
            font-size: 0.75em;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .config-value {
            font-size: 1.1em;
            color: var(--accent-cyan);
            font-family: var(--font-mono);
        }

        .structure-list, .agent-list, .interactable-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .structure-item, .agent-item, .interactable-item {
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .item-name {
            font-weight: 600;
            color: var(--text-primary);
            text-transform: capitalize;
        }

        .item-position {
            font-family: var(--font-mono);
            font-size: 0.85em;
            color: var(--text-muted);
        }

        .lore-container {
            background: var(--bg-tertiary);
            border-left: 3px solid var(--accent-purple);
            border-radius: 0 var(--radius-md) var(--radius-md) 0;
            padding: 20px 25px;
        }

        .lore-title {
            font-size: 1.2em;
            color: var(--accent-purple);
            margin-bottom: 15px;
            font-style: italic;
        }

        .lore-fragment {
            color: var(--text-secondary);
            line-height: 1.8;
            margin-bottom: 15px;
            padding-left: 20px;
            border-left: 2px solid rgba(191, 0, 255, 0.3);
            font-style: italic;
        }

        .evolution-stages {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .evolution-stage {
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .stage-number {
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-blue));
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: var(--bg-primary);
            flex-shrink: 0;
        }

        .stage-info {
            flex: 1;
        }

        .stage-requirement {
            font-size: 0.85em;
            color: var(--accent-orange);
            margin-bottom: 3px;
        }

        .stage-effect {
            color: var(--text-secondary);
        }

        /* ============================================
           QR CODE SECTION
           ============================================ */
        .qr-section {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.1), rgba(255, 0, 255, 0.1));
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 30px;
            text-align: center;
            margin-top: 30px;
        }

        .qr-title {
            font-size: 1.3em;
            color: var(--accent-cyan);
            margin-bottom: 20px;
        }

        .qr-container {
            background: white;
            padding: 20px;
            border-radius: var(--radius-md);
            display: inline-block;
            margin-bottom: 20px;
        }

        .qr-container img {
            display: block;
        }

        .join-url {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 15px;
            font-family: var(--font-mono);
            font-size: 0.85em;
            color: var(--text-muted);
            word-break: break-all;
            margin-bottom: 20px;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 15px 35px;
            border: none;
            border-radius: var(--radius-xl);
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-fast);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .action-btn.primary {
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-blue));
            color: var(--bg-primary);
        }

        .action-btn.secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-glow);
        }

        /* ============================================
           RAW DATA VIEWER
           ============================================ */
        .raw-data-toggle {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 12px 20px;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            font-size: 0.95em;
            transition: var(--transition-fast);
        }

        .raw-data-toggle:hover {
            border-color: var(--accent-cyan);
        }

        .raw-data-toggle .arrow {
            transition: var(--transition-fast);
        }

        .raw-data-toggle.expanded .arrow {
            transform: rotate(180deg);
        }

        .raw-data-content {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-top: none;
            border-radius: 0 0 var(--radius-md) var(--radius-md);
            padding: 20px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .raw-data-content.expanded {
            max-height: 500px;
            overflow-y: auto;
        }

        .raw-data-content pre {
            font-family: var(--font-mono);
            font-size: 0.8em;
            color: var(--accent-cyan);
            white-space: pre-wrap;
            word-break: break-all;
        }

        /* ============================================
           TOAST NOTIFICATION
           ============================================ */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--accent-green);
            color: var(--bg-primary);
            padding: 15px 30px;
            border-radius: var(--radius-xl);
            font-weight: 600;
            z-index: 3000;
            opacity: 0;
            transition: var(--transition-medium);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .toast.error {
            background: var(--accent-red);
            color: white;
        }

        /* ============================================
           FOOTER
           ============================================ */
        footer {
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            padding: 30px 40px;
            text-align: center;
            color: var(--text-muted);
            font-size: 0.9em;
        }

        footer a {
            color: var(--accent-cyan);
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* ============================================
           RESPONSIVE DESIGN
           ============================================ */
        @media (max-width: 1024px) {
            main {
                padding: 20px;
            }

            .worlds-grid {
                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            }

            .filter-bar {
                padding: 20px;
            }

            .search-input {
                width: 100%;
            }
        }

        @media (max-width: 768px) {
            header {
                padding: 15px 20px;
            }

            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .header-stats {
                justify-content: center;
            }

            .logo-text h1 {
                font-size: 1.4em;
            }

            main {
                padding: 15px;
            }

            .filter-bar {
                flex-direction: column;
            }

            .filter-actions {
                margin-left: 0;
                width: 100%;
                justify-content: center;
            }

            .worlds-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .modal-content {
                max-height: 95vh;
            }

            .modal-header {
                padding: 30px 20px 20px;
                flex-direction: column;
                align-items: center;
                text-align: center;
            }

            .modal-body {
                padding: 0 20px 30px;
            }

            .modal-title {
                font-size: 1.5em;
            }

            .config-grid {
                grid-template-columns: 1fr 1fr;
            }

            .action-buttons {
                flex-direction: column;
            }

            .action-btn {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .world-card.featured::before {
                font-size: 0.6em;
                padding: 4px 35px;
                right: -40px;
            }

            .world-thumbnail {
                height: 150px;
            }

            .world-thumbnail .biome-icon {
                font-size: 56px;
            }

            .config-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="bg-animation">
        <div class="stars"></div>
    </div>

    <!-- Header -->
    <header>
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">üåå</div>
                <div class="logo-text">
                    <h1>LEVIATHAN</h1>
                    <p>Public Worlds Registry</p>
                </div>
            </div>
            <div class="header-stats">
                <div class="stat-item">
                    <div class="stat-value" id="total-worlds">--</div>
                    <div class="stat-label">Worlds</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="featured-count">--</div>
                    <div class="stat-label">Featured</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="categories-count">--</div>
                    <div class="stat-label">Categories</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Filter Bar -->
        <div class="filter-bar">
            <div class="filter-group">
                <span class="filter-label">Search</span>
                <input type="text" class="search-input" id="search-input" placeholder="Search worlds...">
            </div>
            <div class="filter-group">
                <span class="filter-label">Category</span>
                <div class="category-filters" id="category-filters">
                    <button class="category-btn active" data-category="all">All</button>
                </div>
            </div>
            <div class="filter-actions">
                <button class="refresh-btn" id="refresh-btn" onclick="loadRegistry()">
                    <span id="refresh-icon">üîÑ</span>
                    <span>Refresh</span>
                </button>
            </div>
        </div>

        <!-- Worlds Container -->
        <div id="worlds-container">
            <div class="loading-container">
                <div class="loading-spinner"></div>
                <div class="loading-text">Loading Public Worlds Registry...</div>
                <div class="loading-subtext" id="loading-url"></div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <p>Data fetched from <a href="https://github.com/kody-w/localFirstTools" target="_blank">GitHub Repository</a></p>
        <p style="margin-top: 10px; font-size: 0.85em;">LEVIATHAN: OMNIVERSE - A Local-First Focus Game</p>
    </footer>

    <!-- World Detail Modal -->
    <div class="modal-overlay" id="world-modal">
        <div class="modal-content" id="modal-content">
            <button class="modal-close" onclick="closeModal()">&times;</button>
            <div id="modal-body">
                <!-- Content loaded dynamically -->
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script>
        // ============================================
        // CONFIGURATION
        // ============================================
        const CONFIG = {
            REGISTRY_URL: 'https://raw.githubusercontent.com/kody-w/localFirstTools/main/data/public-worlds/registry.json',
            SEEDS_BASE_URL: 'https://raw.githubusercontent.com/kody-w/localFirstTools/main/data/public-worlds/seeds/',
            GAME_URL: 'https://kody-w.github.io/localFirstTools/apps/games/levi.html',
            QR_API_URL: 'https://api.qrserver.com/v1/create-qr-code/',
            CACHE_DURATION: 5 * 60 * 1000 // 5 minutes
        };

        // ============================================
        // STATE MANAGEMENT
        // ============================================
        const state = {
            registry: null,
            filteredWorlds: [],
            selectedWorld: null,
            selectedWorldSeed: null,
            activeCategory: 'all',
            searchQuery: '',
            isLoading: false,
            lastFetch: null
        };

        // ============================================
        // BIOME ICONS MAPPING
        // ============================================
        const BIOME_ICONS = {
            volcanic: 'üåã',
            underground: 'üíé',
            space: 'üöÄ',
            zen: 'üå∏',
            abyssal: 'üåä',
            crystal: 'üí†',
            forest: 'üå≤',
            desert: 'üèúÔ∏è',
            arctic: '‚ùÑÔ∏è',
            cosmic: '‚ú®',
            void: 'üï≥Ô∏è',
            default: 'üåç'
        };

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        function getBiomeIcon(biome) {
            const normalizedBiome = (biome || '').toLowerCase();
            return BIOME_ICONS[normalizedBiome] || BIOME_ICONS.default;
        }

        function formatDate(dateString) {
            if (!dateString) return 'Unknown';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        function formatNumber(num) {
            if (num === undefined || num === null) return '0';
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toString();
        }

        function showToast(message, isError = false) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast' + (isError ? ' error' : '');
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function generateJoinUrl(worldId) {
            return `${CONFIG.GAME_URL}?world=${encodeURIComponent(worldId)}`;
        }

        function generateQRUrl(worldId) {
            const joinUrl = generateJoinUrl(worldId);
            return `${CONFIG.QR_API_URL}?size=250x250&data=${encodeURIComponent(joinUrl)}`;
        }

        // ============================================
        // DATA FETCHING
        // ============================================
        async function loadRegistry() {
            if (state.isLoading) return;

            state.isLoading = true;
            const refreshBtn = document.getElementById('refresh-btn');
            const refreshIcon = document.getElementById('refresh-icon');
            refreshBtn.disabled = true;
            refreshIcon.classList.add('spinner');

            const container = document.getElementById('worlds-container');
            container.innerHTML = `
                <div class="loading-container">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">Loading Public Worlds Registry...</div>
                    <div class="loading-subtext">${CONFIG.REGISTRY_URL}</div>
                </div>
            `;

            try {
                const response = await fetch(CONFIG.REGISTRY_URL + '?t=' + Date.now());
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                state.registry = await response.json();
                state.lastFetch = Date.now();

                console.log('[REGISTRY] Loaded:', state.registry);

                updateStats();
                renderCategoryFilters();
                filterAndRenderWorlds();
                showToast(`Loaded ${state.registry.worlds.length} worlds`);

            } catch (error) {
                console.error('[REGISTRY] Load failed:', error);
                container.innerHTML = `
                    <div class="error-container">
                        <div class="error-icon">‚ùå</div>
                        <div class="error-title">Failed to Load Registry</div>
                        <div class="error-message">${error.message}</div>
                        <button class="retry-btn" onclick="loadRegistry()">Try Again</button>
                    </div>
                `;
            } finally {
                state.isLoading = false;
                refreshBtn.disabled = false;
                refreshIcon.classList.remove('spinner');
            }
        }

        async function loadWorldSeed(worldId) {
            const url = `${CONFIG.SEEDS_BASE_URL}${worldId}.json?t=${Date.now()}`;
            console.log('[SEED] Loading:', url);

            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                return await response.json();
            } catch (error) {
                console.error('[SEED] Load failed:', error);
                return null;
            }
        }

        // ============================================
        // UI UPDATE FUNCTIONS
        // ============================================
        function updateStats() {
            if (!state.registry) return;

            document.getElementById('total-worlds').textContent = state.registry.worlds.length;
            document.getElementById('featured-count').textContent = state.registry.featured?.length || 0;
            document.getElementById('categories-count').textContent = state.registry.categories?.length || 0;
        }

        function renderCategoryFilters() {
            if (!state.registry) return;

            const container = document.getElementById('category-filters');
            const categories = ['all', ...(state.registry.categories || [])];

            container.innerHTML = categories.map(cat => `
                <button class="category-btn ${state.activeCategory === cat ? 'active' : ''}"
                        data-category="${cat}"
                        onclick="setCategory('${cat}')">
                    ${cat === 'all' ? 'All' : cat}
                </button>
            `).join('');
        }

        function setCategory(category) {
            state.activeCategory = category;
            renderCategoryFilters();
            filterAndRenderWorlds();
        }

        function filterAndRenderWorlds() {
            if (!state.registry) return;

            let worlds = [...state.registry.worlds];

            // Filter by category
            if (state.activeCategory !== 'all') {
                worlds = worlds.filter(w => w.category === state.activeCategory);
            }

            // Filter by search query
            if (state.searchQuery) {
                const query = state.searchQuery.toLowerCase();
                worlds = worlds.filter(w =>
                    w.name.toLowerCase().includes(query) ||
                    w.description.toLowerCase().includes(query) ||
                    (w.tags && w.tags.some(t => t.toLowerCase().includes(query))) ||
                    w.author.toLowerCase().includes(query)
                );
            }

            // Sort: featured first, then by name
            worlds.sort((a, b) => {
                if (a.featured && !b.featured) return -1;
                if (!a.featured && b.featured) return 1;
                return a.name.localeCompare(b.name);
            });

            state.filteredWorlds = worlds;
            renderWorldsGrid();
        }

        function renderWorldsGrid() {
            const container = document.getElementById('worlds-container');

            if (state.filteredWorlds.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üîç</div>
                        <div class="empty-text">No worlds found matching your criteria</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = `
                <div class="worlds-grid">
                    ${state.filteredWorlds.map(world => renderWorldCard(world)).join('')}
                </div>
            `;
        }

        function renderWorldCard(world) {
            const biomeIcon = getBiomeIcon(world.category);
            const tagsHtml = (world.tags || []).slice(0, 4).map(tag =>
                `<span class="world-tag">${tag}</span>`
            ).join('');

            return `
                <div class="world-card ${world.featured ? 'featured' : ''}" onclick="openWorldDetail('${world.id}')">
                    <div class="world-thumbnail">
                        <span class="biome-icon">${biomeIcon}</span>
                    </div>
                    <div class="world-content">
                        <div class="world-header">
                            <div>
                                <div class="world-title">${escapeHtml(world.name)}</div>
                                <div class="world-author">by ${escapeHtml(world.author)}</div>
                            </div>
                            <span class="world-category">${escapeHtml(world.category)}</span>
                        </div>
                        <p class="world-description">${escapeHtml(world.description)}</p>
                        <div class="world-tags">${tagsHtml}</div>
                        <div class="world-stats">
                            <span class="world-stat">
                                <span class="world-stat-icon">üë•</span>
                                ${formatNumber(world.totalVisitors)} visitors
                            </span>
                            <span class="world-stat">
                                <span class="world-stat-icon">‚è∞</span>
                                ${formatNumber(world.temporalContributions)} focus
                            </span>
                            <span class="world-stat">
                                <span class="world-stat-icon">üìÖ</span>
                                ${formatDate(world.created)}
                            </span>
                        </div>
                    </div>
                </div>
            `;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text || '';
            return div.innerHTML;
        }

        // ============================================
        // MODAL FUNCTIONS
        // ============================================
        async function openWorldDetail(worldId) {
            const world = state.registry.worlds.find(w => w.id === worldId);
            if (!world) return;

            state.selectedWorld = world;
            state.selectedWorldSeed = null;

            const modal = document.getElementById('world-modal');
            const modalBody = document.getElementById('modal-body');

            // Show modal with loading state
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';

            const biomeIcon = getBiomeIcon(world.category);

            modalBody.innerHTML = `
                <div class="modal-header">
                    <div class="modal-thumbnail">
                        <span class="biome-icon">${biomeIcon}</span>
                    </div>
                    <div class="modal-info">
                        <h2 class="modal-title">${escapeHtml(world.name)}</h2>
                        <div class="modal-author">Created by ${escapeHtml(world.author)}</div>
                        <div class="modal-meta">
                            <div class="modal-meta-item">
                                <span class="label">Category:</span>
                                <span class="value">${escapeHtml(world.category)}</span>
                            </div>
                            <div class="modal-meta-item">
                                <span class="label">Created:</span>
                                <span class="value">${formatDate(world.created)}</span>
                            </div>
                            <div class="modal-meta-item">
                                <span class="label">Featured:</span>
                                <span class="value">${world.featured ? 'Yes ‚≠ê' : 'No'}</span>
                            </div>
                        </div>
                        <div class="world-tags">
                            ${(world.tags || []).map(tag => `<span class="world-tag">${escapeHtml(tag)}</span>`).join('')}
                        </div>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="detail-section">
                        <h3 class="section-title"><span class="icon">üìñ</span> Description</h3>
                        <p class="description-full">${escapeHtml(world.description)}</p>
                    </div>

                    <div class="loading-container" id="seed-loading" style="padding: 40px;">
                        <div class="loading-spinner"></div>
                        <div class="loading-text">Loading world configuration...</div>
                    </div>

                    <div id="seed-content" style="display: none;"></div>

                    <!-- QR Code Section -->
                    <div class="qr-section">
                        <h3 class="qr-title">üåå Join This World</h3>
                        <div class="qr-container">
                            <img src="${generateQRUrl(world.id)}" alt="QR Code" width="250" height="250">
                        </div>
                        <div class="join-url" id="join-url-${world.id}">${generateJoinUrl(world.id)}</div>
                        <div class="action-buttons">
                            <button class="action-btn primary" onclick="copyJoinUrl('${world.id}')">
                                üìã Copy URL
                            </button>
                            <a class="action-btn secondary" href="${generateJoinUrl(world.id)}" target="_blank">
                                üöÄ Join Now
                            </a>
                        </div>
                    </div>

                    <!-- Raw Data Toggle -->
                    <div class="detail-section" style="margin-top: 30px;">
                        <button class="raw-data-toggle" onclick="toggleRawData(this)">
                            <span>üìÑ View Raw Registry Data</span>
                            <span class="arrow">‚ñº</span>
                        </button>
                        <div class="raw-data-content">
                            <pre>${JSON.stringify(world, null, 2)}</pre>
                        </div>
                    </div>
                </div>
            `;

            // Load seed data
            const seedData = await loadWorldSeed(world.id);
            state.selectedWorldSeed = seedData;

            document.getElementById('seed-loading').style.display = 'none';
            const seedContent = document.getElementById('seed-content');
            seedContent.style.display = 'block';

            if (seedData) {
                seedContent.innerHTML = renderSeedContent(seedData);
            } else {
                seedContent.innerHTML = `
                    <div class="error-container" style="margin: 20px 0;">
                        <div class="error-icon">‚ö†Ô∏è</div>
                        <div class="error-title">Seed Data Unavailable</div>
                        <div class="error-message">Could not load detailed configuration for this world.</div>
                    </div>
                `;
            }
        }

        function renderSeedContent(seed) {
            let html = '';

            // Configuration
            if (seed.config) {
                html += `
                    <div class="detail-section">
                        <h3 class="section-title"><span class="icon">‚öôÔ∏è</span> World Configuration</h3>
                        <div class="config-grid">
                            <div class="config-item">
                                <div class="config-label">Biome</div>
                                <div class="config-value">${escapeHtml(seed.config.biome || 'Unknown')}</div>
                            </div>
                            <div class="config-item">
                                <div class="config-label">Gravity</div>
                                <div class="config-value">${seed.config.gravity || 1.0}x</div>
                            </div>
                            <div class="config-item">
                                <div class="config-label">Time of Day</div>
                                <div class="config-value">${Math.round((seed.config.timeOfDay || 0.5) * 24)}:00</div>
                            </div>
                            <div class="config-item">
                                <div class="config-label">Max Players</div>
                                <div class="config-value">${seed.config.maxPlayers || 16}</div>
                            </div>
                            <div class="config-item">
                                <div class="config-label">PvP</div>
                                <div class="config-value">${seed.config.pvpEnabled ? 'Enabled' : 'Disabled'}</div>
                            </div>
                            <div class="config-item">
                                <div class="config-label">Weather</div>
                                <div class="config-value">${seed.config.weatherEnabled ? 'Enabled' : 'Disabled'}</div>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Terrain
            if (seed.terrain) {
                html += `
                    <div class="detail-section">
                        <h3 class="section-title"><span class="icon">üó∫Ô∏è</span> Terrain</h3>
                        <div class="config-grid">
                            <div class="config-item">
                                <div class="config-label">Seed</div>
                                <div class="config-value" style="font-size: 0.9em;">${escapeHtml(seed.terrain.seed)}</div>
                            </div>
                            <div class="config-item">
                                <div class="config-label">Height Scale</div>
                                <div class="config-value">${seed.terrain.heightScale || 50}</div>
                            </div>
                        </div>
                        ${seed.terrain.features ? `
                            <div style="margin-top: 15px;">
                                <div class="config-label" style="margin-bottom: 10px;">Features</div>
                                <div class="world-tags">
                                    ${seed.terrain.features.map(f => `<span class="world-tag">${escapeHtml(f)}</span>`).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                `;
            }

            // Structures
            if (seed.structures && seed.structures.length > 0) {
                html += `
                    <div class="detail-section">
                        <h3 class="section-title"><span class="icon">üèõÔ∏è</span> Structures (${seed.structures.length})</h3>
                        <div class="structure-list">
                            ${seed.structures.map(s => `
                                <div class="structure-item">
                                    <span class="item-name">${escapeHtml(s.type.replace(/-/g, ' '))}</span>
                                    <span class="item-position">
                                        x: ${s.position?.x || 0}, y: ${s.position?.y || 0}, z: ${s.position?.z || 0}
                                    </span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            // Agents
            if (seed.agents && seed.agents.length > 0) {
                html += `
                    <div class="detail-section">
                        <h3 class="section-title"><span class="icon">üë§</span> NPCs / Agents (${seed.agents.length})</h3>
                        <div class="agent-list">
                            ${seed.agents.map(a => `
                                <div class="agent-item">
                                    <div>
                                        <span class="item-name">${escapeHtml(a.type.replace(/-/g, ' '))}</span>
                                        ${a.personality ? `<span style="color: var(--text-muted); font-size: 0.85em;"> - ${escapeHtml(a.personality)}</span>` : ''}
                                    </div>
                                    <span class="item-position">
                                        ${a.patrol ? 'üö∂ Patrols' : 'üìç Stationary'}
                                    </span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            // Interactables
            if (seed.interactables && seed.interactables.length > 0) {
                html += `
                    <div class="detail-section">
                        <h3 class="section-title"><span class="icon">‚ú®</span> Interactables (${seed.interactables.length})</h3>
                        <div class="interactable-list">
                            ${seed.interactables.map(i => `
                                <div class="interactable-item">
                                    <span class="item-name">${escapeHtml(i.type.replace(/-/g, ' '))}</span>
                                    <span class="item-position">
                                        x: ${i.position?.x || 0}, y: ${i.position?.y || 0}, z: ${i.position?.z || 0}
                                    </span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            // Lore
            if (seed.lore) {
                html += `
                    <div class="detail-section">
                        <h3 class="section-title"><span class="icon">üìú</span> Lore</h3>
                        <div class="lore-container">
                            <div class="lore-title">${escapeHtml(seed.lore.title || 'Unknown Chapter')}</div>
                            ${(seed.lore.fragments || []).map(f => `
                                <p class="lore-fragment">${escapeHtml(f)}</p>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            // Evolution Stages
            if (seed.evolutionStages && seed.evolutionStages.length > 0) {
                html += `
                    <div class="detail-section">
                        <h3 class="section-title"><span class="icon">üåü</span> Evolution Stages</h3>
                        <div class="evolution-stages">
                            ${seed.evolutionStages.map(stage => `
                                <div class="evolution-stage">
                                    <div class="stage-number">${stage.stage}</div>
                                    <div class="stage-info">
                                        <div class="stage-requirement">${formatNumber(stage.requirement)} Temporal Focus Required</div>
                                        <div class="stage-effect">${escapeHtml(stage.effect)}</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            // Raw Seed Data Toggle
            html += `
                <div class="detail-section">
                    <button class="raw-data-toggle" onclick="toggleRawData(this)">
                        <span>üìÑ View Raw Seed Data</span>
                        <span class="arrow">‚ñº</span>
                    </button>
                    <div class="raw-data-content">
                        <pre>${JSON.stringify(seed, null, 2)}</pre>
                    </div>
                </div>
            `;

            return html;
        }

        function closeModal() {
            const modal = document.getElementById('world-modal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
            state.selectedWorld = null;
            state.selectedWorldSeed = null;
        }

        function toggleRawData(button) {
            button.classList.toggle('expanded');
            const content = button.nextElementSibling;
            content.classList.toggle('expanded');
        }

        function copyJoinUrl(worldId) {
            const url = generateJoinUrl(worldId);
            navigator.clipboard.writeText(url).then(() => {
                showToast('URL copied to clipboard!');
            }).catch(() => {
                showToast('Failed to copy URL', true);
            });
        }

        // ============================================
        // EVENT LISTENERS
        // ============================================
        document.getElementById('search-input').addEventListener('input', (e) => {
            state.searchQuery = e.target.value;
            filterAndRenderWorlds();
        });

        document.getElementById('world-modal').addEventListener('click', (e) => {
            if (e.target.id === 'world-modal') {
                closeModal();
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', () => {
            console.log('[REGISTRY VIEWER] Initializing...');
            loadRegistry();
        });
    </script>
</body>
</html>
