<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leviathan Galaxy: WOWmon Protocol</title>
    <style>
        :root {
            --neon-blue: #00f3ff;
            --neon-red: #ff0055;
            --neon-green: #00ff66;
            --neon-purple: #bc13fe;
            --neon-gold: #ffd700;
            --bg-dark: #050505;
            --panel-bg: rgba(10, 15, 20, 0.85);
            --hud-border: 1px solid rgba(255, 255, 255, 0.1);
        }

        * {
            box-sizing: border-box;
            user-select: none;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-dark);
            color: var(--neon-blue);
            font-family: 'Courier New', Courier, monospace;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Scanline Overlay */
        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
            z-index: 999;
        }

        /* Main Game Container */
        #game-interface {
            width: 95vw;
            height: 90vh;
            display: grid;
            grid-template-rows: 60% 40%;
            background: radial-gradient(circle at center, #1a1a2e 0%, #000 100%);
            border: 1px solid var(--neon-blue);
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.2);
            position: relative;
        }

        /* The Visual Battlefield (Top) */
        #battlefield {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            perspective: 1000px;
        }

        /* Entities Visualization */
        .entity {
            position: absolute;
            transition: all 0.5s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            text-shadow: 0 0 10px currentColor;
        }

        .entity-visual {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: rgba(0,0,0,0.5);
            box-shadow: 0 0 15px currentColor;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            position: relative;
            animation: float 3s ease-in-out infinite;
        }

        /* Aggro Ring (WoW Mechanic) */
        .aggro-ring {
            position: absolute;
            width: 140px;
            height: 140px;
            border: 2px dashed var(--neon-red);
            border-radius: 50%;
            animation: spin 10s linear infinite;
            display: none; /* Hidden unless aggroed */
        }

        @keyframes spin { 100% { transform: rotate(360deg); } }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        /* Positions */
        #boss-unit { top: 20%; left: 50%; transform: translateX(-50%); color: var(--neon-red); }
        #companion-unit { bottom: 10%; left: 30%; color: var(--neon-purple); }
        #player-unit { bottom: 5%; left: 70%; color: var(--neon-green); }

        /* Effects */
        .damage-text {
            position: absolute;
            color: white;
            font-size: 24px;
            font-weight: bold;
            animation: floatUp 1s forwards;
            pointer-events: none;
            text-shadow: 2px 2px 0 #000;
            z-index: 100;
        }

        @keyframes floatUp {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-50px) scale(1.5); }
        }

        /* HUD (Bottom) */
        #hud-panel {
            display: grid;
            grid-template-columns: 25% 50% 25%;
            background: var(--panel-bg);
            border-top: 2px solid var(--neon-blue);
            padding: 10px;
            font-size: 14px;
        }

        /* Unit Frames */
        .unit-frame {
            padding: 10px;
            border: var(--hud-border);
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .bar-container {
            width: 100%;
            background: #222;
            height: 10px;
            border: 1px solid #444;
            position: relative;
        }

        .bar-fill {
            height: 100%;
            width: 100%;
            transition: width 0.3s ease;
        }

        .hp-bar { background: var(--neon-green); }
        .mana-bar { background: var(--neon-blue); }
        .cast-bar { background: var(--neon-gold); width: 0%; }
        
        .unit-name { font-weight: bold; font-size: 1.1em; margin-bottom: 5px; display: flex; justify-content: space-between; }
        .unit-level { font-size: 0.8em; opacity: 0.7; }

        /* Action Bars */
        .action-deck {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 0 20px;
        }

        .btn-row {
            display: flex;
            gap: 10px;
        }

        .skill-btn {
            width: 60px;
            height: 60px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid var(--neon-blue);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            font-size: 0.7em;
            text-align: center;
            transition: all 0.1s;
        }

        .skill-btn:hover { background: rgba(0, 243, 255, 0.2); }
        .skill-btn:active { transform: scale(0.95); }
        
        .skill-btn.cooldown {
            filter: grayscale(1);
            opacity: 0.5;
            pointer-events: none;
        }

        .skill-btn .keybind {
            position: absolute;
            top: 2px;
            right: 4px;
            font-size: 9px;
            color: var(--neon-gold);
        }

        .log-panel {
            font-size: 12px;
            overflow-y: auto;
            border: var(--hud-border);
            padding: 5px;
            font-family: monospace;
            color: #aaa;
            background: rgba(0,0,0,0.5);
        }

        .log-entry { margin-bottom: 3px; border-bottom: 1px solid #222; }
        .log-crit { color: var(--neon-red); font-weight: bold; }
        .log-heal { color: var(--neon-green); }
        .log-system { color: var(--neon-gold); }

        /* Modal for Loot/Capture */
        #end-screen {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 200;
        }

        .loot-card {
            width: 400px;
            padding: 20px;
            border: 2px solid var(--neon-gold);
            background: #111;
            text-align: center;
            box-shadow: 0 0 50px var(--neon-gold);
        }

        .loot-btn {
            background: transparent;
            border: 1px solid white;
            color: white;
            padding: 10px 20px;
            margin: 10px;
            cursor: pointer;
            font-family: inherit;
            font-size: 1.2em;
        }

        .loot-btn:hover { background: white; color: black; }

        /* Type Badges */
        .type-badge {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.7em;
            color: #000;
            font-weight: bold;
            text-transform: uppercase;
        }
        .type-SOLAR { background: #ffaa00; }
        .type-VOID { background: #aa00ff; color: white; }
        .type-ARC { background: #00ccff; }
        .type-BIO { background: #00ff66; }

    </style>
</head>
<body>

    <div class="scanlines"></div>

    <div id="game-interface">
        
        <div id="battlefield">
            
            <div id="boss-unit" class="entity">
                <div class="aggro-ring" id="boss-aggro-ring"></div>
                <div class="entity-visual">‚ò†Ô∏è</div>
                <div style="margin-top:10px;">OMEGA DREADNOUGHT</div>
                <span class="type-badge type-SOLAR" id="boss-type">SOLAR</span>
            </div>

            <div id="companion-unit" class="entity">
                <div class="entity-visual">üêâ</div>
                <div style="margin-top:10px;">Subject Zero</div>
                <span class="type-badge type-VOID">VOID</span>
            </div>

            <div id="player-unit" class="entity">
                <div class="entity-visual">üë®‚ÄçüöÄ</div>
                <div style="margin-top:10px;">CMDR. SHEP</div>
            </div>

        </div>

        <div id="hud-panel">
            
            <div style="display:flex; flex-direction:column; gap:10px;">
                
                <div class="unit-frame" style="border-color: var(--neon-green);">
                    <div class="unit-name">COMMANDER <span class="unit-level">LVL 60</span></div>
                    <div class="bar-container"><div id="player-hp" class="bar-fill hp-bar"></div></div>
                    <div class="bar-container"><div id="player-mp" class="bar-fill mana-bar"></div></div>
                </div>

                <div class="unit-frame" style="border-color: var(--neon-purple);">
                    <div class="unit-name">COMPANION <span class="unit-level">LVL 55</span></div>
                    <div class="bar-container"><div id="comp-hp" class="bar-fill hp-bar"></div></div>
                    <div style="font-size: 0.8em; color: #888;">Threat: <span id="comp-threat" style="color:white">0</span></div>
                </div>

                <div class="unit-frame" style="border-color: var(--neon-red);">
                    <div class="unit-name">TARGET <span class="unit-level">BOSS</span></div>
                    <div class="bar-container"><div id="boss-hp" class="bar-fill hp-bar" style="background:var(--neon-red)"></div></div>
                    <div class="bar-container"><div id="boss-cast" class="bar-fill cast-bar"></div></div>
                    <div id="boss-status" style="font-size: 0.8em; color: var(--neon-gold);">IDLE</div>
                </div>

            </div>

            <div class="action-deck">
                <div style="color: var(--neon-blue); margin-bottom: 5px;">-- COMMANDER PROTOCOLS --</div>
                <div class="btn-row">
                    <button class="skill-btn" onclick="playerAction('shoot')">
                        <span class="keybind">1</span>
                        LASER<br>SHOT
                    </button>
                    <button class="skill-btn" onclick="playerAction('heal')">
                        <span class="keybind">2</span>
                        NANITE<br>REPAIR
                    </button>
                    <button class="skill-btn" onclick="playerAction('buff')">
                        <span class="keybind">3</span>
                        OVER<br>DRIVE
                    </button>
                    <button class="skill-btn" onclick="attemptCapture()" id="cap-btn" style="border-color: var(--neon-gold); color: var(--neon-gold);">
                        <span class="keybind">4</span>
                        CATCH<br>UNIT
                    </button>
                </div>

                <div style="color: var(--neon-purple); margin-top: 10px; margin-bottom: 5px;">-- COMPANION COMMANDS --</div>
                <div class="btn-row">
                    <button class="skill-btn" onclick="companionAction('bite')">
                        <span class="keybind">Q</span>
                        VOID<br>BITE
                    </button>
                    <button class="skill-btn" onclick="companionAction('taunt')">
                        <span class="keybind">W</span>
                        ROAR<br>(Taunt)
                    </button>
                    <button class="skill-btn" onclick="companionAction('nuke')">
                        <span class="keybind">E</span>
                        DARK<br>MATTER
                    </button>
                </div>
            </div>

            <div class="log-panel" id="combat-log">
                <div class="log-entry log-system">SYSTEM: Leviathan Galaxy Protocol Initiated.</div>
                <div class="log-entry log-system">SYSTEM: Target acquired. Type: SOLAR.</div>
            </div>

        </div>
    </div>

    <div id="end-screen">
        <div class="loot-card">
            <h1 style="color: var(--neon-gold);">VICTORY</h1>
            <p>The Omega Dreadnought is neutralized.</p>
            <div style="display:flex; justify-content:center;">
                <button class="loot-btn" onclick="resetGame()">HARVEST LOOT<br><span style="font-size:0.6em">Get Tier 2 Armor</span></button>
                <button class="loot-btn" onclick="resetGame()">EXTRACT EGG<br><span style="font-size:0.6em">Get Solar Dreadnought Pet</span></button>
            </div>
        </div>
    </div>

<script>
    /**
     * LEVIATHAN GALAXY: WOWMON CORE LOGIC
     * Merges WoW Aggro/Trinity mechanics with Pokemon Types.
     */

    // --- CONSTANTS ---
    const TYPES = {
        SOLAR: { color: '#ffaa00', weak: 'ARC', strong: 'VOID' },
        VOID:  { color: '#aa00ff', weak: 'SOLAR', strong: 'ARC' },
        ARC:   { color: '#00ccff', weak: 'VOID', strong: 'SOLAR' }
    };

    // --- GAME STATE ---
    const state = {
        active: true,
        tick: 0,
        player: { maxHp: 2000, hp: 2000, mp: 100, maxMp: 100, dmg: 50 },
        companion: { 
            name: "Subject Zero", 
            type: 'VOID', 
            maxHp: 4000, 
            hp: 4000, 
            threat: 0,
            buffs: { overdrive: false }
        },
        boss: { 
            name: "Omega Dreadnought", 
            type: 'SOLAR', 
            maxHp: 10000, 
            hp: 10000, 
            phase: 1,
            target: 'companion' // 'companion' or 'player'
        }
    };

    // --- UTILS ---
    function log(msg, type = '') {
        const logPanel = document.getElementById('combat-log');
        const entry = document.createElement('div');
        entry.className = `log-entry log-${type}`;
        entry.innerText = `[${state.tick}] ${msg}`;
        logPanel.prepend(entry);
        if (logPanel.children.length > 20) logPanel.lastChild.remove();
    }

    function showDamage(targetId, amount, isCrit = false) {
        const el = document.getElementById(targetId);
        const floater = document.createElement('div');
        floater.className = 'damage-text';
        floater.innerText = amount;
        if (isCrit) {
            floater.style.color = 'var(--neon-red)';
            floater.style.fontSize = '32px';
            floater.innerText += "!";
        }
        
        // Random offset
        const rect = el.getBoundingClientRect();
        floater.style.left = (rect.left + 20 + Math.random() * 40) + 'px';
        floater.style.top = (rect.top + Math.random() * 20) + 'px';
        
        document.body.appendChild(floater);
        setTimeout(() => floater.remove(), 1000);
    }

    function updateUI() {
        // Bars
        const pHpPct = (state.player.hp / state.player.maxHp) * 100;
        document.getElementById('player-hp').style.width = `${Math.max(0, pHpPct)}%`;
        
        const cHpPct = (state.companion.hp / state.companion.maxHp) * 100;
        document.getElementById('comp-hp').style.width = `${Math.max(0, cHpPct)}%`;
        
        const bHpPct = (state.boss.hp / state.boss.maxHp) * 100;
        document.getElementById('boss-hp').style.width = `${Math.max(0, bHpPct)}%`;

        // Threat
        document.getElementById('comp-threat').innerText = state.companion.threat;

        // Boss Visuals based on target (WoW Mechanics)
        const bossRing = document.getElementById('boss-aggro-ring');
        if (state.boss.target === 'companion') {
            bossRing.style.display = 'block';
            bossRing.style.borderColor = 'var(--neon-purple)';
        } else {
            bossRing.style.display = 'block';
            bossRing.style.borderColor = 'var(--neon-green)'; // Player has aggro (BAD!)
        }
        
        // Capture Button Logic (Pokemon Mechanic: Low HP = Catchable)
        const capBtn = document.getElementById('cap-btn');
        if (bHpPct < 20) {
            capBtn.style.opacity = '1';
            capBtn.style.pointerEvents = 'all';
            capBtn.classList.add('pulse'); // Add css pulse here if wanted
        } else {
            capBtn.style.opacity = '0.3';
            capBtn.style.pointerEvents = 'none';
        }

        if (state.boss.hp <= 0) endGame();
        if (state.player.hp <= 0) alert("COMMANDER DOWN - MISSION FAILED");
    }

    // --- ACTIONS ---

    function getTypeMult(atkType, defType) {
        if (TYPES[defType].weak === atkType) return 2.0; // Super effective
        if (TYPES[defType].strong === atkType) return 0.5; // Not effective
        return 1.0;
    }

    function playerAction(action) {
        if (!state.active) return;
        
        if (action === 'shoot') {
            let dmg = 150;
            // Commander weapons are neutral types usually
            state.boss.hp -= dmg;
            log(`Commander fired Laser for ${dmg} dmg.`, 'system');
            showDamage('boss-unit', dmg);
            // Generating threat for player is bad
            if (Math.random() > 0.8) checkAggroSwap('player');
        }
        
        if (action === 'heal') {
            let heal = 600;
            state.companion.hp = Math.min(state.companion.maxHp, state.companion.hp + heal);
            log(`Nanite Repair healed Companion for ${heal}.`, 'heal');
            createParticles('companion-unit', 'green');
        }

        if (action === 'buff') {
            state.companion.buffs.overdrive = true;
            log(`OVERDRIVE ENGAGED. Companion dmg +50%.`, 'system');
            setTimeout(() => { state.companion.buffs.overdrive = false; log("Overdrive faded."); }, 5000);
        }

        updateUI();
    }

    function companionAction(action) {
        if (!state.active) return;

        let dmg = 0;
        let threat = 0;

        if (action === 'bite') {
            // Basic attack
            let base = 300;
            let mult = getTypeMult(state.companion.type, state.boss.type);
            dmg = base * mult;
            if (state.companion.buffs.overdrive) dmg *= 1.5;
            threat = dmg * 1.5; // High threat move
            
            let typeMsg = mult > 1 ? "SUPER EFFECTIVE!" : "";
            log(`${state.companion.name} used Void Bite. ${dmg} dmg. ${typeMsg}`);
        }

        if (action === 'taunt') {
            // Pure WoW Mechanic: Force Aggro
            threat = 5000;
            state.boss.target = 'companion';
            log(`${state.companion.name} ROARED! Boss is fixated.`, 'system');
            createParticles('boss-unit', 'red');
        }

        if (action === 'nuke') {
            // Cooldown move
            let base = 800;
            dmg = base * getTypeMult(state.companion.type, state.boss.type);
            threat = dmg; 
            log(`${state.companion.name} unleashed DARK MATTER. ${dmg} dmg!!!`, 'crit');
            showDamage('boss-unit', dmg, true);
        }

        if (dmg > 0) {
            state.boss.hp -= dmg;
            showDamage('boss-unit', dmg);
        }

        state.companion.threat += threat;
        updateUI();
    }

    function attemptCapture() {
        // Pokemon Mechanic
        let chance = (1 - (state.boss.hp / state.boss.maxHp)) * 100; // Lower HP = Higher Chance
        log(`Attempting Capture... Probability: ${Math.floor(chance)}%`);
        
        setTimeout(() => {
            if (Math.random() * 100 < chance) {
                state.boss.hp = 0;
                endGame(true);
            } else {
                log(`Capture Failed! Boss is enraged!`, 'crit');
                state.boss.target = 'player'; // Punishment for failing capture
            }
        }, 1000);
    }

    // --- BOSS AI & LOOP ---

    function checkAggroSwap(forceTarget = null) {
        if (forceTarget) {
            state.boss.target = forceTarget;
            return;
        }
        // Basic aggro logic: If player does too much dmg without companion taunting
        // For this demo, simple random swap to keep player on toes
    }

    function bossLogic() {
        if (!state.active) return;

        // 1. Phase Change Logic
        if (state.boss.hp < 5000 && state.boss.phase === 1) {
            state.boss.phase = 2;
            state.boss.type = 'ARC'; // Change type mid-fight!
            document.getElementById('boss-type').className = 'type-badge type-ARC';
            document.getElementById('boss-type').innerText = 'ARC';
            log(`BOSS PHASE SHIFT! Armor changed to [ARC]. VOID is now weak!`, 'crit');
            // Visual Flare
            document.body.style.backgroundColor = '#112'; 
            setTimeout(() => document.body.style.backgroundColor = '#050505', 200);
        }

        // 2. Attack Logic
        let targetUnit = state.boss.target === 'companion' ? state.companion : state.player;
        let targetDiv = state.boss.target === 'companion' ? 'companion-unit' : 'player-unit';
        
        let dmg = 400;

        // Mechanics: Tank Buster
        if (state.tick % 5 === 0) {
            document.getElementById('boss-status').innerText = "CASTING: SOLAR BEAM";
            document.getElementById('boss-cast').style.width = "100%";
            setTimeout(() => {
                document.getElementById('boss-cast').style.width = "0%";
                document.getElementById('boss-status').innerText = "IDLE";
                // Huge damage
                if (state.boss.target === 'player') {
                    targetUnit.hp -= 1500; // Likely kills player
                    log("SOLAR BEAM HIT PLAYER! CRITICAL!", 'crit');
                } else {
                    targetUnit.hp -= 800; // Tank can take it
                    log("Companion tanked Solar Beam.", 'system');
                }
                showDamage(targetDiv, 800, true);
                updateUI();
            }, 1000);
        } else {
            // Normal hit
            targetUnit.hp -= dmg;
            showDamage(targetDiv, dmg);
        }

        updateUI();
    }

    function endGame(captured = false) {
        state.active = false;
        document.getElementById('end-screen').style.display = 'flex';
        const title = document.querySelector('#end-screen h1');
        title.innerText = captured ? "ASSIMILATION COMPLETE" : "TARGET DESTROYED";
        title.style.color = captured ? "var(--neon-green)" : "var(--neon-gold)";
    }

    function resetGame() {
        location.reload();
    }

    // --- VISUAL FX ---
    function createParticles(targetId, color) {
        const el = document.getElementById(targetId);
        const rect = el.getBoundingClientRect();
        for(let i=0; i<5; i++) {
            const p = document.createElement('div');
            p.style.position = 'absolute';
            p.style.width = '4px';
            p.style.height = '4px';
            p.style.background = color === 'red' ? 'var(--neon-red)' : 'var(--neon-green)';
            p.style.left = (rect.left + 50) + 'px';
            p.style.top = (rect.top + 50) + 'px';
            p.style.borderRadius = '50%';
            p.style.pointerEvents = 'none';
            p.style.transition = 'all 0.5s';
            p.style.zIndex = 999;
            document.body.appendChild(p);
            
            setTimeout(() => {
                p.style.transform = `translate(${(Math.random()-0.5)*100}px, ${(Math.random()-0.5)*100}px)`;
                p.style.opacity = 0;
            }, 10);
            setTimeout(() => p.remove(), 500);
        }
    }

    // --- LOOP ---
    setInterval(() => {
        if (!state.active) return;
        state.tick++;
        bossLogic();
    }, 2000); // Boss acts every 2 seconds (Global Cooldown)

    updateUI();

</script>
</body>
</html>