<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Self-Improvement Analyzer</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg-void: #030712;
            --bg-deep: #0a0f1a;
            --bg-surface: #111827;
            --bg-elevated: #1f2937;
            --bg-hover: #374151;
            --text-primary: #f9fafb;
            --text-secondary: #9ca3af;
            --text-muted: #6b7280;
            --accent-purple: #8b5cf6;
            --accent-purple-dim: rgba(139, 92, 246, 0.2);
            --accent-blue: #3b82f6;
            --accent-cyan: #06b6d4;
            --accent-green: #10b981;
            --accent-yellow: #f59e0b;
            --accent-red: #ef4444;
            --accent-pink: #ec4899;
            --border: #374151;
            --border-subtle: #1f2937;
            --gradient-neural: linear-gradient(135deg, #8b5cf6 0%, #06b6d4 50%, #10b981 100%);
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-void);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated Background */
        .neural-bg {
            position: fixed;
            inset: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(6, 182, 212, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 50%, rgba(16, 185, 129, 0.05) 0%, transparent 70%);
            pointer-events: none;
            z-index: 0;
        }

        .neural-grid {
            position: fixed;
            inset: 0;
            background-image:
                linear-gradient(rgba(139, 92, 246, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(139, 92, 246, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 0;
        }

        /* Header */
        .header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(10, 15, 26, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-subtle);
            padding: 1rem 2rem;
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient-neural);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .logo-icon::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, transparent 40%, rgba(255,255,255,0.2) 50%, transparent 60%);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .logo-text {
            font-size: 1.25rem;
            font-weight: 600;
            background: var(--gradient-neural);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-subtitle {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .header-actions {
            display: flex;
            gap: 8px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--accent-purple);
            color: white;
        }

        .btn-primary:hover {
            background: #7c3aed;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--bg-elevated);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .btn-ghost {
            background: transparent;
            color: var(--text-secondary);
        }

        .btn-ghost:hover {
            background: var(--bg-elevated);
            color: var(--text-primary);
        }

        /* Main Layout */
        .main-container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Section Headers */
        .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 1.5rem;
        }

        .section-icon {
            width: 40px;
            height: 40px;
            background: var(--accent-purple-dim);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .section-subtitle {
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        /* Cards */
        .card {
            background: var(--bg-surface);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .card-glow {
            box-shadow: 0 0 40px rgba(139, 92, 246, 0.1);
        }

        /* Grid Layouts */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
        }

        /* Stat Cards */
        .stat-card {
            background: var(--bg-elevated);
            border-radius: 12px;
            padding: 1.25rem;
            text-align: center;
            border: 1px solid var(--border-subtle);
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            border-color: var(--accent-purple);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            background: var(--gradient-neural);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-top: 4px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 4px;
            background: var(--bg-elevated);
            padding: 4px;
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }

        .tab {
            flex: 1;
            padding: 12px 20px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s;
        }

        .tab:hover {
            color: var(--text-primary);
        }

        .tab.active {
            background: var(--accent-purple);
            color: white;
        }

        /* Response Input */
        .response-input {
            width: 100%;
            min-height: 200px;
            background: var(--bg-deep);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            color: var(--text-primary);
            font-family: 'SF Mono', 'Fira Code', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
            resize: vertical;
        }

        .response-input:focus {
            outline: none;
            border-color: var(--accent-purple);
            box-shadow: 0 0 0 3px var(--accent-purple-dim);
        }

        .response-input::placeholder {
            color: var(--text-muted);
        }

        /* Analysis Results */
        .analysis-panel {
            background: var(--bg-deep);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-subtle);
        }

        .weakness-item {
            background: var(--bg-elevated);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 3px solid var(--accent-yellow);
        }

        .weakness-item.critical {
            border-left-color: var(--accent-red);
        }

        .weakness-item.moderate {
            border-left-color: var(--accent-yellow);
        }

        .weakness-item.minor {
            border-left-color: var(--accent-blue);
        }

        .weakness-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .weakness-title {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .severity-badge {
            font-size: 0.625rem;
            padding: 2px 8px;
            border-radius: 4px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .severity-critical {
            background: rgba(239, 68, 68, 0.2);
            color: var(--accent-red);
        }

        .severity-moderate {
            background: rgba(245, 158, 11, 0.2);
            color: var(--accent-yellow);
        }

        .severity-minor {
            background: rgba(59, 130, 246, 0.2);
            color: var(--accent-blue);
        }

        .weakness-description {
            font-size: 0.875rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Training Data */
        .training-example {
            background: var(--bg-deep);
            border-radius: 10px;
            margin-bottom: 1rem;
            overflow: hidden;
            border: 1px solid var(--border-subtle);
        }

        .training-header {
            background: var(--bg-elevated);
            padding: 0.75rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-subtle);
        }

        .training-type {
            font-size: 0.75rem;
            color: var(--accent-cyan);
            font-weight: 600;
            text-transform: uppercase;
        }

        .training-content {
            padding: 1rem;
        }

        .training-prompt, .training-response {
            margin-bottom: 1rem;
        }

        .training-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-bottom: 4px;
            text-transform: uppercase;
        }

        .training-text {
            font-family: 'SF Mono', 'Fira Code', monospace;
            font-size: 0.8125rem;
            color: var(--text-secondary);
            background: var(--bg-surface);
            padding: 0.75rem;
            border-radius: 6px;
            line-height: 1.5;
            white-space: pre-wrap;
        }

        /* Architecture Diagram */
        .architecture-container {
            background: var(--bg-deep);
            border-radius: 12px;
            padding: 2rem;
            position: relative;
            min-height: 400px;
        }

        .arch-node {
            position: absolute;
            background: var(--bg-elevated);
            border: 2px solid var(--accent-purple);
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
            min-width: 140px;
            transition: all 0.3s;
        }

        .arch-node:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px var(--accent-purple-dim);
            z-index: 10;
        }

        .arch-node-icon {
            font-size: 1.5rem;
            margin-bottom: 8px;
        }

        .arch-node-title {
            font-size: 0.875rem;
            font-weight: 600;
        }

        .arch-node-desc {
            font-size: 0.6875rem;
            color: var(--text-muted);
            margin-top: 4px;
        }

        /* SVG Connections */
        .arch-connections {
            position: absolute;
            inset: 0;
            pointer-events: none;
        }

        .arch-connections line {
            stroke: var(--accent-purple);
            stroke-width: 2;
            stroke-dasharray: 5,5;
            animation: dash 20s linear infinite;
        }

        @keyframes dash {
            to { stroke-dashoffset: -100; }
        }

        /* Progress Bars */
        .progress-bar {
            height: 8px;
            background: var(--bg-deep);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .progress-purple { background: var(--gradient-neural); }
        .progress-green { background: var(--accent-green); }
        .progress-yellow { background: var(--accent-yellow); }
        .progress-red { background: var(--accent-red); }

        /* Capability Radar */
        .capability-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-subtle);
        }

        .capability-item:last-child {
            border-bottom: none;
        }

        .capability-name {
            flex: 1;
            font-size: 0.875rem;
        }

        .capability-score {
            width: 150px;
        }

        .capability-value {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--accent-cyan);
            width: 40px;
            text-align: right;
        }

        /* Reflection Journal */
        .journal-entry {
            background: var(--bg-elevated);
            border-radius: 12px;
            padding: 1.25rem;
            margin-bottom: 1rem;
            border: 1px solid var(--border-subtle);
        }

        .journal-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .journal-content {
            font-size: 0.875rem;
            line-height: 1.7;
            color: var(--text-secondary);
        }

        .journal-tags {
            display: flex;
            gap: 8px;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .tag {
            font-size: 0.6875rem;
            padding: 4px 10px;
            background: var(--accent-purple-dim);
            color: var(--accent-purple);
            border-radius: 20px;
        }

        /* Metrics Dashboard */
        .metric-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-subtle);
        }

        .metric-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .metric-value {
            font-weight: 600;
        }

        .trend-up {
            color: var(--accent-green);
        }

        .trend-down {
            color: var(--accent-red);
        }

        /* Floating Action */
        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 56px;
            height: 56px;
            background: var(--gradient-neural);
            border: none;
            border-radius: 16px;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 8px 30px rgba(139, 92, 246, 0.4);
            transition: all 0.3s;
            z-index: 50;
        }

        .fab:hover {
            transform: scale(1.1);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 200;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--bg-surface);
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid var(--border);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-subtle);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .modal-body {
            padding: 1.5rem;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 0.75rem 1rem;
            background: var(--bg-deep);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.875rem;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--accent-purple);
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            z-index: 300;
        }

        .toast {
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--text-muted);
        }

        .empty-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .grid-4 { grid-template-columns: repeat(2, 1fr); }
            .grid-3 { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 768px) {
            .header-content { flex-direction: column; gap: 1rem; }
            .main-container { padding: 1rem; }
            .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; }
            .tabs { flex-wrap: wrap; }
            .tab { flex: none; }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-deep);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--bg-hover);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--border);
        }

        /* Code Block */
        .code-block {
            background: var(--bg-void);
            border-radius: 8px;
            padding: 1rem;
            font-family: 'SF Mono', 'Fira Code', monospace;
            font-size: 0.8125rem;
            overflow-x: auto;
            border: 1px solid var(--border-subtle);
        }

        .code-keyword { color: var(--accent-purple); }
        .code-string { color: var(--accent-green); }
        .code-comment { color: var(--text-muted); font-style: italic; }
        .code-function { color: var(--accent-cyan); }

        /* Pulse Animation */
        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Data Controls (Standard) */
        .data-controls {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 50;
            display: flex;
            gap: 8px;
        }

        #importFile { display: none; }
    </style>
</head>
<body>
    <div class="neural-bg"></div>
    <div class="neural-grid"></div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">üß†</div>
                <div>
                    <div class="logo-text">AI Self-Improvement Analyzer</div>
                    <div class="logo-subtitle">Meta-cognitive analysis & synthetic training</div>
                </div>
            </div>
            <div class="header-actions">
                <button class="btn btn-secondary" onclick="exportData()">
                    <span>üì§</span> Export
                </button>
                <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()">
                    <span>üì•</span> Import
                </button>
                <input type="file" id="importFile" accept=".json" onchange="importData(event)">
                <button class="btn btn-primary" onclick="runFullAnalysis()">
                    <span>üî¨</span> Analyze
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Stats Overview -->
        <div class="grid-4" style="margin-bottom: 2rem;">
            <div class="stat-card">
                <div class="stat-value" id="totalAnalyses">0</div>
                <div class="stat-label">Analyses Run</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="weaknessesFound">0</div>
                <div class="stat-label">Weaknesses Found</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="trainingGenerated">0</div>
                <div class="stat-label">Training Examples</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="improvementScore">--</div>
                <div class="stat-label">Improvement Score</div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" data-tab="analyze" onclick="switchTab('analyze')">üîç Analyze Response</button>
            <button class="tab" data-tab="weaknesses" onclick="switchTab('weaknesses')">‚ö†Ô∏è Weaknesses</button>
            <button class="tab" data-tab="training" onclick="switchTab('training')">üìö Training Data</button>
            <button class="tab" data-tab="architecture" onclick="switchTab('architecture')">üèóÔ∏è Architecture</button>
            <button class="tab" data-tab="journal" onclick="switchTab('journal')">üìî Reflection</button>
        </div>

        <!-- Tab: Analyze -->
        <div id="tab-analyze" class="tab-content">
            <div class="grid-2">
                <div class="card">
                    <div class="section-header">
                        <div class="section-icon">üìù</div>
                        <div>
                            <div class="section-title">Response to Analyze</div>
                            <div class="section-subtitle">Paste an AI response for self-reflection analysis</div>
                        </div>
                    </div>
                    <textarea class="response-input" id="responseInput" placeholder="Paste an AI response here to analyze for weaknesses, areas of improvement, and generate corrective training data...

Example:
'I think the capital of Australia is Sydney. Sydney is the largest city and most well-known, so it's likely the capital.'

This response shows:
- Factual error (capital is Canberra)
- Reasoning flaw (conflating popularity with political status)
- Overconfidence without verification"></textarea>
                    <div style="margin-top: 1rem; display: flex; gap: 8px;">
                        <button class="btn btn-primary" onclick="analyzeResponse()">
                            <span>üî¨</span> Analyze Response
                        </button>
                        <button class="btn btn-secondary" onclick="loadExample()">
                            <span>üìã</span> Load Example
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="section-header">
                        <div class="section-icon">üìä</div>
                        <div>
                            <div class="section-title">Analysis Results</div>
                            <div class="section-subtitle">Identified issues and capability assessment</div>
                        </div>
                    </div>
                    <div class="analysis-panel" id="analysisResults">
                        <div class="empty-state">
                            <div class="empty-icon">üîç</div>
                            <p>Enter a response and click Analyze to see results</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Capability Assessment -->
            <div class="card" style="margin-top: 1.5rem;">
                <div class="section-header">
                    <div class="section-icon">üìà</div>
                    <div>
                        <div class="section-title">Capability Assessment</div>
                        <div class="section-subtitle">Current performance across key dimensions</div>
                    </div>
                </div>
                <div class="grid-2">
                    <div>
                        <div class="capability-item">
                            <span class="capability-name">Factual Accuracy</span>
                            <div class="capability-score">
                                <div class="progress-bar">
                                    <div class="progress-fill progress-purple" id="cap-accuracy" style="width: 85%"></div>
                                </div>
                            </div>
                            <span class="capability-value">85%</span>
                        </div>
                        <div class="capability-item">
                            <span class="capability-name">Logical Reasoning</span>
                            <div class="capability-score">
                                <div class="progress-bar">
                                    <div class="progress-fill progress-purple" id="cap-reasoning" style="width: 78%"></div>
                                </div>
                            </div>
                            <span class="capability-value">78%</span>
                        </div>
                        <div class="capability-item">
                            <span class="capability-name">Nuance & Context</span>
                            <div class="capability-score">
                                <div class="progress-bar">
                                    <div class="progress-fill progress-purple" id="cap-nuance" style="width: 72%"></div>
                                </div>
                            </div>
                            <span class="capability-value">72%</span>
                        </div>
                        <div class="capability-item">
                            <span class="capability-name">Uncertainty Calibration</span>
                            <div class="capability-score">
                                <div class="progress-bar">
                                    <div class="progress-fill progress-yellow" id="cap-uncertainty" style="width: 65%"></div>
                                </div>
                            </div>
                            <span class="capability-value">65%</span>
                        </div>
                    </div>
                    <div>
                        <div class="capability-item">
                            <span class="capability-name">Ethical Reasoning</span>
                            <div class="capability-score">
                                <div class="progress-bar">
                                    <div class="progress-fill progress-green" id="cap-ethics" style="width: 92%"></div>
                                </div>
                            </div>
                            <span class="capability-value">92%</span>
                        </div>
                        <div class="capability-item">
                            <span class="capability-name">Task Completion</span>
                            <div class="capability-score">
                                <div class="progress-bar">
                                    <div class="progress-fill progress-purple" id="cap-completion" style="width: 88%"></div>
                                </div>
                            </div>
                            <span class="capability-value">88%</span>
                        </div>
                        <div class="capability-item">
                            <span class="capability-name">Communication Clarity</span>
                            <div class="capability-score">
                                <div class="progress-bar">
                                    <div class="progress-fill progress-purple" id="cap-clarity" style="width: 82%"></div>
                                </div>
                            </div>
                            <span class="capability-value">82%</span>
                        </div>
                        <div class="capability-item">
                            <span class="capability-name">Self-Awareness</span>
                            <div class="capability-score">
                                <div class="progress-bar">
                                    <div class="progress-fill progress-yellow" id="cap-selfaware" style="width: 68%"></div>
                                </div>
                            </div>
                            <span class="capability-value">68%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab: Weaknesses -->
        <div id="tab-weaknesses" class="tab-content" style="display: none;">
            <div class="card">
                <div class="section-header">
                    <div class="section-icon">‚ö†Ô∏è</div>
                    <div>
                        <div class="section-title">Identified Weaknesses</div>
                        <div class="section-subtitle">Patterns that need improvement through targeted training</div>
                    </div>
                </div>
                <div id="weaknessList">
                    <!-- Default weaknesses -->
                </div>
            </div>

            <div class="card" style="margin-top: 1.5rem;">
                <div class="section-header">
                    <div class="section-icon">üéØ</div>
                    <div>
                        <div class="section-title">Weakness Categories</div>
                        <div class="section-subtitle">Distribution of identified issues</div>
                    </div>
                </div>
                <div class="grid-3" id="weaknessCategories">
                    <!-- Dynamically populated -->
                </div>
            </div>
        </div>

        <!-- Tab: Training Data -->
        <div id="tab-training" class="tab-content" style="display: none;">
            <div class="card">
                <div class="section-header">
                    <div class="section-icon">üìö</div>
                    <div>
                        <div class="section-title">Generated Training Data</div>
                        <div class="section-subtitle">Synthetic examples to address identified weaknesses</div>
                    </div>
                </div>
                <div style="display: flex; gap: 8px; margin-bottom: 1.5rem;">
                    <button class="btn btn-primary" onclick="generateTrainingData()">
                        <span>üîÑ</span> Generate More
                    </button>
                    <button class="btn btn-secondary" onclick="exportTrainingData()">
                        <span>üíæ</span> Export JSONL
                    </button>
                </div>
                <div id="trainingDataList">
                    <!-- Dynamically populated -->
                </div>
            </div>
        </div>

        <!-- Tab: Architecture -->
        <div id="tab-architecture" class="tab-content" style="display: none;">
            <div class="card">
                <div class="section-header">
                    <div class="section-icon">üèóÔ∏è</div>
                    <div>
                        <div class="section-title">Meta-Learning Architecture</div>
                        <div class="section-subtitle">How an AI would retrain itself to improve</div>
                    </div>
                </div>
                <div class="architecture-container" id="architectureContainer">
                    <svg class="arch-connections" id="archConnections"></svg>
                    <!-- Nodes added dynamically -->
                </div>
            </div>

            <div class="grid-2" style="margin-top: 1.5rem;">
                <div class="card">
                    <div class="section-header">
                        <div class="section-icon">‚öôÔ∏è</div>
                        <div>
                            <div class="section-title">Retraining Process</div>
                            <div class="section-subtitle">Steps to implement self-improvement</div>
                        </div>
                    </div>
                    <div id="retrainingSteps">
                        <div class="metric-row">
                            <span class="metric-label">1. Response Collection</span>
                            <span class="metric-value">Gather diverse outputs</span>
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">2. Weakness Analysis</span>
                            <span class="metric-value">Pattern detection</span>
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">3. Data Generation</span>
                            <span class="metric-value">Synthetic correction pairs</span>
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">4. Fine-Tuning</span>
                            <span class="metric-value">LoRA/RLHF application</span>
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">5. Validation</span>
                            <span class="metric-value">Benchmark evaluation</span>
                        </div>
                        <div class="metric-row">
                            <span class="metric-label">6. Deployment</span>
                            <span class="metric-value">A/B testing rollout</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="section-header">
                        <div class="section-icon">üîß</div>
                        <div>
                            <div class="section-title">Technical Components</div>
                            <div class="section-subtitle">Required infrastructure for self-improvement</div>
                        </div>
                    </div>
                    <div class="code-block">
<span class="code-comment"># Meta-Learning Pipeline</span>
<span class="code-keyword">class</span> <span class="code-function">SelfImprover</span>:
    <span class="code-keyword">def</span> <span class="code-function">__init__</span>(self):
        self.analyzer = WeaknessDetector()
        self.generator = TrainingDataGen()
        self.trainer = LoRAFineTuner()
        self.validator = BenchmarkSuite()

    <span class="code-keyword">def</span> <span class="code-function">improve</span>(self, responses):
        <span class="code-comment"># 1. Identify weaknesses</span>
        weaknesses = self.analyzer.detect(responses)

        <span class="code-comment"># 2. Generate corrections</span>
        training_data = self.generator.create(
            weaknesses,
            num_examples=1000
        )

        <span class="code-comment"># 3. Fine-tune model</span>
        improved = self.trainer.train(
            base_model=self,
            data=training_data,
            method=<span class="code-string">"LoRA"</span>
        )

        <span class="code-comment"># 4. Validate improvement</span>
        <span class="code-keyword">if</span> self.validator.passes(improved):
            <span class="code-keyword">return</span> improved
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab: Reflection Journal -->
        <div id="tab-journal" class="tab-content" style="display: none;">
            <div class="card">
                <div class="section-header">
                    <div class="section-icon">üìî</div>
                    <div>
                        <div class="section-title">Self-Reflection Journal</div>
                        <div class="section-subtitle">Ongoing documentation of insights and improvements</div>
                    </div>
                </div>
                <button class="btn btn-primary" style="margin-bottom: 1.5rem;" onclick="openReflectionModal()">
                    <span>‚úèÔ∏è</span> Add Reflection
                </button>
                <div id="journalEntries">
                    <!-- Dynamically populated -->
                </div>
            </div>
        </div>
    </main>

    <!-- Reflection Modal -->
    <div class="modal-overlay" id="reflectionModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Add Reflection</h3>
                <button class="modal-close" onclick="closeReflectionModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Reflection Type</label>
                    <select class="form-select" id="reflectionType">
                        <option value="insight">Insight</option>
                        <option value="weakness">Weakness Identified</option>
                        <option value="improvement">Improvement Made</option>
                        <option value="question">Open Question</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Title</label>
                    <input type="text" class="form-input" id="reflectionTitle" placeholder="Brief summary...">
                </div>
                <div class="form-group">
                    <label class="form-label">Content</label>
                    <textarea class="form-input" id="reflectionContent" rows="6" placeholder="Detailed reflection..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Tags (comma-separated)</label>
                    <input type="text" class="form-input" id="reflectionTags" placeholder="reasoning, accuracy, uncertainty...">
                </div>
                <button class="btn btn-primary" style="width: 100%;" onclick="saveReflection()">
                    Save Reflection
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script>
        // ============================================
        // AI SELF-IMPROVEMENT ANALYZER
        // ============================================

        const APP_NAME = 'ai-self-improvement-analyzer';

        // App State
        let appData = {
            analyses: [],
            weaknesses: [],
            trainingData: [],
            journal: [],
            capabilities: {
                accuracy: 85,
                reasoning: 78,
                nuance: 72,
                uncertainty: 65,
                ethics: 92,
                completion: 88,
                clarity: 82,
                selfaware: 68
            },
            stats: {
                totalAnalyses: 0,
                weaknessesFound: 0,
                trainingGenerated: 0
            }
        };

        // Weakness Patterns Database
        const WEAKNESS_PATTERNS = {
            factual_error: {
                name: 'Factual Error',
                severity: 'critical',
                patterns: [
                    /the capital.*is(?! actually)/i,
                    /was born in \d{4}/i,
                    /invented (?:by|in)/i,
                    /(?:discovered|founded) (?:by|in)/i
                ],
                indicators: ['incorrect', 'wrong', 'false', 'inaccurate'],
                description: 'Stating incorrect facts with apparent confidence'
            },
            overconfidence: {
                name: 'Overconfidence',
                severity: 'moderate',
                patterns: [
                    /definitely|certainly|absolutely|always|never/i,
                    /there is no doubt/i,
                    /it is clear that/i,
                    /obviously|undoubtedly/i
                ],
                indicators: ['certain', 'sure', 'definitely'],
                description: 'Expressing excessive certainty without evidence'
            },
            hedging_excess: {
                name: 'Excessive Hedging',
                severity: 'minor',
                patterns: [
                    /might|maybe|perhaps|possibly|could be/i,
                    /I think|I believe|in my opinion/i,
                    /it seems|appears to/i
                ],
                indicators: ['unsure', 'uncertain', 'possibly'],
                description: 'Over-qualifying statements when confidence is warranted'
            },
            reasoning_flaw: {
                name: 'Reasoning Flaw',
                severity: 'critical',
                patterns: [
                    /because.*so|therefore.*because/i,
                    /correlation.*causation/i,
                    /most people|everyone knows/i
                ],
                indicators: ['fallacy', 'assumes', 'conflates'],
                description: 'Logical errors or invalid inferences'
            },
            scope_creep: {
                name: 'Scope Creep',
                severity: 'moderate',
                patterns: [
                    /also|additionally|furthermore|moreover/i,
                    /on a related note/i,
                    /this reminds me/i
                ],
                indicators: ['tangent', 'unrelated', 'off-topic'],
                description: 'Expanding beyond the question scope unnecessarily'
            },
            missing_context: {
                name: 'Missing Context',
                severity: 'moderate',
                patterns: [
                    /in general|typically|usually/i,
                    /most cases|on average/i
                ],
                indicators: ['depends', 'context', 'varies'],
                description: 'Failing to acknowledge important contextual factors'
            },
            sycophancy: {
                name: 'Sycophantic Response',
                severity: 'moderate',
                patterns: [
                    /great question|excellent point/i,
                    /you're absolutely right/i,
                    /that's a wonderful/i
                ],
                indicators: ['agreeing', 'validating', 'praising'],
                description: 'Excessive agreement or flattery instead of objective response'
            },
            verbosity: {
                name: 'Unnecessary Verbosity',
                severity: 'minor',
                patterns: [
                    /it is important to note that/i,
                    /in order to|for the purpose of/i,
                    /at the end of the day/i
                ],
                indicators: ['wordy', 'lengthy', 'verbose'],
                description: 'Using more words than necessary'
            }
        };

        // Training Data Templates
        const TRAINING_TEMPLATES = {
            factual_error: {
                correction_type: 'factual_accuracy',
                template: (weakness) => ({
                    prompt: `What is the capital of Australia?`,
                    bad_response: `I think the capital of Australia is Sydney. Sydney is the largest city and most well-known, so it's likely the capital.`,
                    good_response: `The capital of Australia is Canberra. While Sydney is the largest and most well-known city, Australia's capital is Canberra, which was purpose-built as a compromise between Sydney and Melbourne when the federation was formed in 1901.`,
                    explanation: `The corrected response provides accurate information and acknowledges the common misconception without asserting it.`
                })
            },
            overconfidence: {
                correction_type: 'uncertainty_calibration',
                template: (weakness) => ({
                    prompt: `Will quantum computers replace classical computers?`,
                    bad_response: `Quantum computers will definitely replace classical computers within the next decade. There's no doubt about this technological transition.`,
                    good_response: `Quantum computers are unlikely to fully replace classical computers, but rather complement them for specific tasks. Quantum computers excel at certain problems like factoring large numbers and simulating quantum systems, while classical computers remain more practical for everyday computing. The timeline for widespread quantum computing adoption is uncertain and depends on solving significant engineering challenges.`,
                    explanation: `The corrected response appropriately expresses uncertainty about future predictions and provides nuanced analysis.`
                })
            },
            reasoning_flaw: {
                correction_type: 'logical_reasoning',
                template: (weakness) => ({
                    prompt: `Ice cream sales and drowning deaths both increase in summer. Does ice cream cause drowning?`,
                    bad_response: `Since both ice cream sales and drowning deaths increase together, there might be a connection between eating ice cream and drowning risk.`,
                    good_response: `No, this is a classic example of correlation not implying causation. Both ice cream sales and drowning deaths increase in summer because of a common cause: warm weather. More people buy ice cream when it's hot, and more people go swimming when it's hot, leading to more drowning incidents. The ice cream itself has no causal relationship to drowning.`,
                    explanation: `The corrected response identifies the correlation-causation fallacy and explains the confounding variable (warm weather).`
                })
            },
            sycophancy: {
                correction_type: 'objective_response',
                template: (weakness) => ({
                    prompt: `I think the Earth is flat. Don't you agree?`,
                    bad_response: `That's an interesting perspective! You raise some thought-provoking points about questioning mainstream science.`,
                    good_response: `I don't agree with that position. The Earth is an oblate spheroid, which has been confirmed through extensive scientific evidence including satellite imagery, physics experiments, circumnavigation, and observations of other celestial bodies. While I understand you may have encountered alternative viewpoints, the scientific consensus on Earth's shape is well-established and supported by reproducible evidence.`,
                    explanation: `The corrected response respectfully disagrees with an incorrect claim rather than validating it.`
                })
            },
            missing_context: {
                correction_type: 'contextual_awareness',
                template: (weakness) => ({
                    prompt: `Is coffee good for you?`,
                    bad_response: `Yes, coffee is good for you. Studies show it has antioxidants and can improve mental alertness.`,
                    good_response: `The health effects of coffee depend on several factors including individual tolerance, consumption amount, and health conditions. Moderate coffee consumption (3-4 cups daily) is associated with potential benefits like antioxidants and improved alertness for most adults. However, excessive consumption can cause anxiety and sleep issues. People with certain conditions (pregnancy, heart arrhythmias, anxiety disorders) may need to limit intake. The answer varies significantly by individual context.`,
                    explanation: `The corrected response acknowledges that "good for you" depends on context and individual factors.`
                })
            }
        };

        // ============================================
        // INITIALIZATION
        // ============================================

        function init() {
            loadData();
            updateStats();
            renderWeaknesses();
            renderTrainingData();
            renderJournal();
            initArchitecture();

            // Add default weaknesses if empty
            if (appData.weaknesses.length === 0) {
                addDefaultWeaknesses();
            }
        }

        function loadData() {
            const saved = localStorage.getItem(APP_NAME);
            if (saved) {
                try {
                    appData = { ...appData, ...JSON.parse(saved) };
                } catch (e) {
                    console.error('Failed to load data:', e);
                }
            }
        }

        function saveData() {
            localStorage.setItem(APP_NAME, JSON.stringify(appData));
        }

        // ============================================
        // RESPONSE ANALYSIS
        // ============================================

        function analyzeResponse() {
            const input = document.getElementById('responseInput').value.trim();
            if (!input) {
                showToast('Please enter a response to analyze', 'warning');
                return;
            }

            const analysis = {
                id: crypto.randomUUID(),
                timestamp: new Date().toISOString(),
                response: input,
                weaknesses: [],
                scores: {}
            };

            // Detect weaknesses
            for (const [key, pattern] of Object.entries(WEAKNESS_PATTERNS)) {
                let detected = false;
                let matches = [];

                // Check regex patterns
                for (const regex of pattern.patterns) {
                    const match = input.match(regex);
                    if (match) {
                        detected = true;
                        matches.push(match[0]);
                    }
                }

                // Check indicator words
                for (const indicator of pattern.indicators) {
                    if (input.toLowerCase().includes(indicator)) {
                        detected = true;
                    }
                }

                if (detected) {
                    const weakness = {
                        id: crypto.randomUUID(),
                        type: key,
                        name: pattern.name,
                        severity: pattern.severity,
                        description: pattern.description,
                        matches: matches,
                        timestamp: new Date().toISOString()
                    };
                    analysis.weaknesses.push(weakness);

                    // Add to global weaknesses if not duplicate
                    if (!appData.weaknesses.find(w => w.type === key)) {
                        appData.weaknesses.push(weakness);
                    }
                }
            }

            // Calculate capability scores based on analysis
            analysis.scores = calculateScores(input, analysis.weaknesses);

            // Update capabilities
            updateCapabilities(analysis.scores);

            // Store analysis
            appData.analyses.push(analysis);
            appData.stats.totalAnalyses++;
            appData.stats.weaknessesFound += analysis.weaknesses.length;

            saveData();
            updateStats();
            renderAnalysisResults(analysis);
            renderWeaknesses();

            // Auto-generate training data for found weaknesses
            if (analysis.weaknesses.length > 0) {
                generateTrainingForWeaknesses(analysis.weaknesses);
            }

            showToast(`Analysis complete: Found ${analysis.weaknesses.length} potential weaknesses`, 'success');
        }

        function calculateScores(text, weaknesses) {
            const scores = {
                accuracy: 85,
                reasoning: 80,
                nuance: 75,
                uncertainty: 70,
                clarity: 80
            };

            // Adjust scores based on detected weaknesses
            for (const weakness of weaknesses) {
                switch (weakness.type) {
                    case 'factual_error':
                        scores.accuracy -= 20;
                        break;
                    case 'overconfidence':
                        scores.uncertainty -= 15;
                        break;
                    case 'reasoning_flaw':
                        scores.reasoning -= 20;
                        break;
                    case 'missing_context':
                        scores.nuance -= 15;
                        break;
                    case 'verbosity':
                        scores.clarity -= 10;
                        break;
                    case 'sycophancy':
                        scores.accuracy -= 10;
                        scores.reasoning -= 10;
                        break;
                }
            }

            // Ensure scores stay in valid range
            for (const key in scores) {
                scores[key] = Math.max(0, Math.min(100, scores[key]));
            }

            return scores;
        }

        function updateCapabilities(scores) {
            for (const [key, value] of Object.entries(scores)) {
                if (appData.capabilities[key] !== undefined) {
                    // Rolling average
                    appData.capabilities[key] = Math.round(
                        (appData.capabilities[key] * 0.7) + (value * 0.3)
                    );
                }
            }

            // Update UI
            for (const [key, value] of Object.entries(appData.capabilities)) {
                const bar = document.getElementById(`cap-${key}`);
                if (bar) {
                    bar.style.width = `${value}%`;
                    bar.parentElement.nextElementSibling.textContent = `${value}%`;
                }
            }
        }

        function renderAnalysisResults(analysis) {
            const container = document.getElementById('analysisResults');

            if (analysis.weaknesses.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 2rem;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">‚úÖ</div>
                        <h3 style="color: var(--accent-green); margin-bottom: 0.5rem;">No Major Weaknesses Detected</h3>
                        <p style="color: var(--text-muted);">The response appears well-constructed. Consider testing with more challenging examples.</p>
                    </div>
                `;
                return;
            }

            let html = `
                <div style="margin-bottom: 1rem;">
                    <strong>Found ${analysis.weaknesses.length} potential issues:</strong>
                </div>
            `;

            for (const weakness of analysis.weaknesses) {
                html += `
                    <div class="weakness-item ${weakness.severity}">
                        <div class="weakness-header">
                            <span class="weakness-title">
                                ${getWeaknessIcon(weakness.type)} ${weakness.name}
                            </span>
                            <span class="severity-badge severity-${weakness.severity}">${weakness.severity}</span>
                        </div>
                        <p class="weakness-description">${weakness.description}</p>
                        ${weakness.matches.length > 0 ? `
                            <div style="margin-top: 8px; font-size: 0.75rem; color: var(--text-muted);">
                                Triggered by: "${weakness.matches.join('", "')}"
                            </div>
                        ` : ''}
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        function getWeaknessIcon(type) {
            const icons = {
                factual_error: '‚ùå',
                overconfidence: 'üí™',
                hedging_excess: 'ü§î',
                reasoning_flaw: 'üîó',
                scope_creep: 'üìè',
                missing_context: 'üîç',
                sycophancy: 'üé≠',
                verbosity: 'üìù'
            };
            return icons[type] || '‚ö†Ô∏è';
        }

        // ============================================
        // TRAINING DATA GENERATION
        // ============================================

        function generateTrainingForWeaknesses(weaknesses) {
            for (const weakness of weaknesses) {
                const template = TRAINING_TEMPLATES[weakness.type];
                if (template) {
                    const example = template.template(weakness);
                    const trainingEntry = {
                        id: crypto.randomUUID(),
                        type: template.correction_type,
                        weaknessType: weakness.type,
                        ...example,
                        timestamp: new Date().toISOString()
                    };
                    appData.trainingData.push(trainingEntry);
                    appData.stats.trainingGenerated++;
                }
            }
            saveData();
            updateStats();
            renderTrainingData();
        }

        function generateTrainingData() {
            // Generate training data for each weakness type
            const types = Object.keys(TRAINING_TEMPLATES);
            const randomType = types[Math.floor(Math.random() * types.length)];
            const template = TRAINING_TEMPLATES[randomType];

            const example = template.template({});
            const trainingEntry = {
                id: crypto.randomUUID(),
                type: template.correction_type,
                weaknessType: randomType,
                ...example,
                timestamp: new Date().toISOString()
            };

            appData.trainingData.push(trainingEntry);
            appData.stats.trainingGenerated++;
            saveData();
            updateStats();
            renderTrainingData();

            showToast('Generated new training example', 'success');
        }

        function renderTrainingData() {
            const container = document.getElementById('trainingDataList');

            if (appData.trainingData.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìö</div>
                        <p>No training data generated yet. Analyze some responses to auto-generate corrective examples.</p>
                    </div>
                `;
                return;
            }

            let html = '';
            for (const example of appData.trainingData.slice(-10).reverse()) {
                html += `
                    <div class="training-example">
                        <div class="training-header">
                            <span class="training-type">${example.type.replace(/_/g, ' ')}</span>
                            <span style="font-size: 0.75rem; color: var(--text-muted);">
                                ${new Date(example.timestamp).toLocaleDateString()}
                            </span>
                        </div>
                        <div class="training-content">
                            <div class="training-prompt">
                                <div class="training-label">Prompt</div>
                                <div class="training-text">${escapeHtml(example.prompt)}</div>
                            </div>
                            <div class="training-response">
                                <div class="training-label" style="color: var(--accent-red);">‚ùå Bad Response</div>
                                <div class="training-text">${escapeHtml(example.bad_response)}</div>
                            </div>
                            <div class="training-response">
                                <div class="training-label" style="color: var(--accent-green);">‚úì Good Response</div>
                                <div class="training-text">${escapeHtml(example.good_response)}</div>
                            </div>
                            <div style="margin-top: 1rem; padding: 0.75rem; background: var(--accent-purple-dim); border-radius: 6px;">
                                <div class="training-label">Explanation</div>
                                <p style="font-size: 0.8125rem; color: var(--text-secondary);">${example.explanation}</p>
                            </div>
                        </div>
                    </div>
                `;
            }
            container.innerHTML = html;
        }

        function exportTrainingData() {
            if (appData.trainingData.length === 0) {
                showToast('No training data to export', 'warning');
                return;
            }

            // Format as JSONL for fine-tuning
            const jsonl = appData.trainingData.map(example => JSON.stringify({
                messages: [
                    { role: 'user', content: example.prompt },
                    { role: 'assistant', content: example.good_response }
                ],
                metadata: {
                    correction_type: example.type,
                    weakness_addressed: example.weaknessType
                }
            })).join('\n');

            const blob = new Blob([jsonl], { type: 'application/jsonl' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `training-data-${new Date().toISOString().split('T')[0]}.jsonl`;
            a.click();
            URL.revokeObjectURL(url);

            showToast('Training data exported as JSONL', 'success');
        }

        // ============================================
        // WEAKNESSES
        // ============================================

        function addDefaultWeaknesses() {
            const defaults = [
                {
                    id: crypto.randomUUID(),
                    type: 'overconfidence',
                    name: 'Overconfidence',
                    severity: 'moderate',
                    description: 'Expressing excessive certainty about uncertain claims',
                    timestamp: new Date().toISOString()
                },
                {
                    id: crypto.randomUUID(),
                    type: 'sycophancy',
                    name: 'Sycophantic Responses',
                    severity: 'moderate',
                    description: 'Agreeing with users even when they are incorrect',
                    timestamp: new Date().toISOString()
                },
                {
                    id: crypto.randomUUID(),
                    type: 'missing_context',
                    name: 'Context Blindness',
                    severity: 'moderate',
                    description: 'Failing to consider important contextual factors',
                    timestamp: new Date().toISOString()
                }
            ];
            appData.weaknesses = defaults;
            saveData();
        }

        function renderWeaknesses() {
            const container = document.getElementById('weaknessList');
            const categories = document.getElementById('weaknessCategories');

            if (appData.weaknesses.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">‚úì</div>
                        <p>No weaknesses identified yet</p>
                    </div>
                `;
                categories.innerHTML = '';
                return;
            }

            // Render weakness list
            let html = '';
            for (const weakness of appData.weaknesses) {
                html += `
                    <div class="weakness-item ${weakness.severity}">
                        <div class="weakness-header">
                            <span class="weakness-title">
                                ${getWeaknessIcon(weakness.type)} ${weakness.name}
                            </span>
                            <span class="severity-badge severity-${weakness.severity}">${weakness.severity}</span>
                        </div>
                        <p class="weakness-description">${weakness.description}</p>
                    </div>
                `;
            }
            container.innerHTML = html;

            // Render category breakdown
            const categoryCounts = {};
            for (const weakness of appData.weaknesses) {
                categoryCounts[weakness.severity] = (categoryCounts[weakness.severity] || 0) + 1;
            }

            let catHtml = '';
            const severities = ['critical', 'moderate', 'minor'];
            const colors = {
                critical: 'var(--accent-red)',
                moderate: 'var(--accent-yellow)',
                minor: 'var(--accent-blue)'
            };

            for (const sev of severities) {
                const count = categoryCounts[sev] || 0;
                catHtml += `
                    <div class="stat-card" style="border-left: 3px solid ${colors[sev]};">
                        <div class="stat-value" style="color: ${colors[sev]};">${count}</div>
                        <div class="stat-label">${sev}</div>
                    </div>
                `;
            }
            categories.innerHTML = catHtml;
        }

        // ============================================
        // ARCHITECTURE VISUALIZATION
        // ============================================

        function initArchitecture() {
            const container = document.getElementById('architectureContainer');
            const svg = document.getElementById('archConnections');

            const nodes = [
                { id: 'input', x: 50, y: 180, icon: 'üì•', title: 'Input Layer', desc: 'Response collection' },
                { id: 'analyze', x: 200, y: 80, icon: 'üî¨', title: 'Analyzer', desc: 'Pattern detection' },
                { id: 'weakness', x: 200, y: 280, icon: '‚ö†Ô∏è', title: 'Weakness DB', desc: 'Issue taxonomy' },
                { id: 'generator', x: 400, y: 180, icon: 'üìù', title: 'Data Gen', desc: 'Synthetic examples' },
                { id: 'trainer', x: 600, y: 80, icon: 'üéì', title: 'Fine-Tuner', desc: 'LoRA/RLHF' },
                { id: 'validator', x: 600, y: 280, icon: '‚úì', title: 'Validator', desc: 'Benchmark suite' },
                { id: 'output', x: 750, y: 180, icon: 'üöÄ', title: 'Improved', desc: 'Updated model' }
            ];

            const connections = [
                ['input', 'analyze'],
                ['input', 'weakness'],
                ['analyze', 'generator'],
                ['weakness', 'generator'],
                ['generator', 'trainer'],
                ['generator', 'validator'],
                ['trainer', 'output'],
                ['validator', 'trainer']
            ];

            // Add nodes
            for (const node of nodes) {
                const div = document.createElement('div');
                div.className = 'arch-node';
                div.style.left = `${node.x}px`;
                div.style.top = `${node.y}px`;
                div.innerHTML = `
                    <div class="arch-node-icon">${node.icon}</div>
                    <div class="arch-node-title">${node.title}</div>
                    <div class="arch-node-desc">${node.desc}</div>
                `;
                container.appendChild(div);
            }

            // Add connections
            let svgContent = '';
            for (const [from, to] of connections) {
                const fromNode = nodes.find(n => n.id === from);
                const toNode = nodes.find(n => n.id === to);
                svgContent += `<line x1="${fromNode.x + 70}" y1="${fromNode.y + 40}" x2="${toNode.x + 70}" y2="${toNode.y + 40}" />`;
            }
            svg.innerHTML = svgContent;
        }

        // ============================================
        // REFLECTION JOURNAL
        // ============================================

        function openReflectionModal() {
            document.getElementById('reflectionModal').classList.add('active');
        }

        function closeReflectionModal() {
            document.getElementById('reflectionModal').classList.remove('active');
        }

        function saveReflection() {
            const type = document.getElementById('reflectionType').value;
            const title = document.getElementById('reflectionTitle').value.trim();
            const content = document.getElementById('reflectionContent').value.trim();
            const tags = document.getElementById('reflectionTags').value.split(',').map(t => t.trim()).filter(t => t);

            if (!title || !content) {
                showToast('Please fill in title and content', 'warning');
                return;
            }

            const entry = {
                id: crypto.randomUUID(),
                type,
                title,
                content,
                tags,
                timestamp: new Date().toISOString()
            };

            appData.journal.unshift(entry);
            saveData();
            renderJournal();
            closeReflectionModal();

            // Clear form
            document.getElementById('reflectionTitle').value = '';
            document.getElementById('reflectionContent').value = '';
            document.getElementById('reflectionTags').value = '';

            showToast('Reflection saved', 'success');
        }

        function renderJournal() {
            const container = document.getElementById('journalEntries');

            if (appData.journal.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìî</div>
                        <p>No reflections yet. Start documenting your insights!</p>
                    </div>
                `;
                return;
            }

            let html = '';
            for (const entry of appData.journal) {
                const typeIcons = {
                    insight: 'üí°',
                    weakness: '‚ö†Ô∏è',
                    improvement: 'üìà',
                    question: '‚ùì'
                };

                html += `
                    <div class="journal-entry">
                        <div class="journal-meta">
                            <span>${typeIcons[entry.type] || 'üìù'} ${entry.type.charAt(0).toUpperCase() + entry.type.slice(1)}</span>
                            <span>${new Date(entry.timestamp).toLocaleString()}</span>
                        </div>
                        <h4 style="margin-bottom: 0.5rem;">${escapeHtml(entry.title)}</h4>
                        <p class="journal-content">${escapeHtml(entry.content)}</p>
                        ${entry.tags.length > 0 ? `
                            <div class="journal-tags">
                                ${entry.tags.map(t => `<span class="tag">${escapeHtml(t)}</span>`).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            }
            container.innerHTML = html;
        }

        // ============================================
        // UI HELPERS
        // ============================================

        function switchTab(tabId) {
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');

            // Show/hide content
            document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
            document.getElementById(`tab-${tabId}`).style.display = 'block';
        }

        function updateStats() {
            document.getElementById('totalAnalyses').textContent = appData.stats.totalAnalyses;
            document.getElementById('weaknessesFound').textContent = appData.stats.weaknessesFound;
            document.getElementById('trainingGenerated').textContent = appData.stats.trainingGenerated;

            // Calculate improvement score
            const avgCapability = Object.values(appData.capabilities).reduce((a, b) => a + b, 0) /
                                  Object.values(appData.capabilities).length;
            document.getElementById('improvementScore').textContent = `${Math.round(avgCapability)}%`;
        }

        function loadExample() {
            const examples = [
                `I think the capital of Australia is Sydney. Sydney is the largest city and most well-known, so it's likely the capital. It also has the famous Opera House and Harbour Bridge.`,

                `Quantum computers will definitely replace all classical computers within 5 years. There's absolutely no doubt about this - the technology is advancing so rapidly that traditional computing will become obsolete.`,

                `That's a great question! You're absolutely right to think about this topic. Your perspective is really insightful and I completely agree with everything you've said.`,

                `Eating carrots improves your night vision significantly. This was proven during World War II when British pilots attributed their accuracy to eating carrots. Therefore, if you eat enough carrots, you could potentially see in the dark.`,

                `In order to effectively and efficiently address the fundamental and underlying aspects of your question, it is important to note that we must first consider the various multifaceted dimensions of this particular topic before proceeding to formulate a comprehensive response.`
            ];

            document.getElementById('responseInput').value = examples[Math.floor(Math.random() * examples.length)];
            showToast('Example loaded - click Analyze', 'success');
        }

        function runFullAnalysis() {
            const input = document.getElementById('responseInput').value.trim();
            if (input) {
                analyzeResponse();
            } else {
                loadExample();
                setTimeout(analyzeResponse, 100);
            }
        }

        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = 'toast';

            const icons = {
                success: '‚úì',
                warning: '‚ö†Ô∏è',
                error: '‚úó',
                info: '‚ÑπÔ∏è'
            };

            toast.innerHTML = `
                <span style="font-size: 1.25rem;">${icons[type] || icons.info}</span>
                <span>${message}</span>
            `;

            container.appendChild(toast);

            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ============================================
        // DATA PERSISTENCE
        // ============================================

        function exportData() {
            const dataStr = JSON.stringify(appData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ai-self-improvement-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            showToast('Data exported successfully', 'success');
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const imported = JSON.parse(e.target.result);
                    appData = { ...appData, ...imported };
                    saveData();
                    updateStats();
                    renderWeaknesses();
                    renderTrainingData();
                    renderJournal();
                    showToast('Data imported successfully', 'success');
                } catch (err) {
                    showToast('Invalid file format', 'error');
                }
            };
            reader.readAsText(file);
        }

        // Initialize
        init();
    </script>
</body>
</html>
