<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InfiniteOS - Recursive Operating System</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --accent: #0078d4;
            --accent-light: #1a86d9;
            --bg-dark: #1a1a2e;
            --bg-darker: #0f0f1a;
            --bg-panel: #252540;
            --text: #ffffff;
            --text-dim: #888899;
            --border: #3a3a5a;
            --success: #4ade80;
            --warning: #fbbf24;
            --danger: #ef4444;
            --taskbar-height: 48px;
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            overflow: hidden;
            background: var(--bg-darker);
            color: var(--text);
            height: 100vh;
            width: 100vw;
        }

        /* ==================== BOOT SCREEN ==================== */
        #boot-screen {
            position: fixed;
            inset: 0;
            background: #000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 99999;
            transition: opacity 0.5s;
        }

        #boot-screen.hidden { opacity: 0; pointer-events: none; }

        .boot-logo {
            font-size: 64px;
            margin-bottom: 30px;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.05); }
        }

        .boot-text {
            font-size: 24px;
            color: #0af;
            margin-bottom: 40px;
            letter-spacing: 8px;
        }

        .boot-progress {
            width: 300px;
            height: 4px;
            background: #222;
            border-radius: 2px;
            overflow: hidden;
        }

        .boot-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #0af, #0fa);
            width: 0%;
            transition: width 0.3s;
        }

        .boot-status {
            margin-top: 20px;
            color: #666;
            font-size: 12px;
            font-family: monospace;
        }

        /* ==================== LOGIN SCREEN ==================== */
        #login-screen {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .login-container {
            text-align: center;
            background: rgba(0,0,0,0.3);
            padding: 60px;
            border-radius: 20px;
            backdrop-filter: blur(20px);
        }

        .login-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent), #00d4aa);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            margin: 0 auto 20px;
            border: 4px solid rgba(255,255,255,0.2);
        }

        .login-username {
            font-size: 24px;
            margin-bottom: 30px;
        }

        .login-input {
            width: 280px;
            padding: 15px 20px;
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 30px;
            background: rgba(0,0,0,0.3);
            color: white;
            font-size: 16px;
            text-align: center;
            outline: none;
            margin-bottom: 20px;
        }

        .login-input:focus {
            border-color: var(--accent);
        }

        .login-btn {
            padding: 15px 60px;
            background: var(--accent);
            border: none;
            border-radius: 30px;
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .login-btn:hover {
            background: var(--accent-light);
            transform: scale(1.05);
        }

        .login-time {
            position: absolute;
            top: 40px;
            font-size: 64px;
            font-weight: 200;
        }

        .login-date {
            position: absolute;
            top: 120px;
            font-size: 18px;
            color: var(--text-dim);
        }

        /* ==================== DESKTOP ==================== */
        #desktop {
            position: fixed;
            inset: 0;
            bottom: var(--taskbar-height);
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            background-size: cover;
            display: none;
            overflow: hidden;
        }

        .desktop-icons {
            display: flex;
            flex-direction: column;
            flex-wrap: wrap;
            gap: 10px;
            padding: 20px;
            height: calc(100vh - var(--taskbar-height) - 40px);
            align-content: flex-start;
        }

        .desktop-icon {
            width: 80px;
            padding: 10px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
        }

        .desktop-icon:hover {
            background: rgba(255,255,255,0.1);
        }

        .desktop-icon.selected {
            background: rgba(0,120,212,0.4);
            border: 1px solid var(--accent);
        }

        .desktop-icon-img {
            font-size: 40px;
            margin-bottom: 5px;
        }

        .desktop-icon-label {
            font-size: 11px;
            word-wrap: break-word;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }

        /* ==================== TASKBAR ==================== */
        #taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: var(--taskbar-height);
            background: rgba(20, 20, 35, 0.95);
            backdrop-filter: blur(20px);
            display: none;
            align-items: center;
            padding: 0 10px;
            border-top: 1px solid rgba(255,255,255,0.1);
            z-index: 1000;
        }

        .start-btn {
            width: 48px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            border-radius: 4px;
            transition: background 0.2s;
        }

        .start-btn:hover {
            background: rgba(255,255,255,0.1);
        }

        .taskbar-apps {
            flex: 1;
            display: flex;
            gap: 4px;
            padding: 0 10px;
            overflow-x: auto;
        }

        .taskbar-app {
            height: 40px;
            min-width: 160px;
            max-width: 200px;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 0 12px;
            background: rgba(255,255,255,0.05);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 2px solid transparent;
        }

        .taskbar-app:hover {
            background: rgba(255,255,255,0.1);
        }

        .taskbar-app.active {
            background: rgba(255,255,255,0.15);
            border-bottom-color: var(--accent);
        }

        .taskbar-app-icon { font-size: 18px; }
        .taskbar-app-title {
            font-size: 12px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .system-tray {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 0 15px;
        }

        .tray-icon {
            font-size: 14px;
            cursor: pointer;
            opacity: 0.8;
            transition: opacity 0.2s;
        }

        .tray-icon:hover { opacity: 1; }

        .taskbar-clock {
            text-align: right;
            font-size: 12px;
            line-height: 1.4;
        }

        /* ==================== START MENU ==================== */
        #start-menu {
            position: fixed;
            bottom: calc(var(--taskbar-height) + 10px);
            left: 10px;
            width: 600px;
            max-width: calc(100vw - 20px);
            height: 500px;
            max-height: calc(100vh - 80px);
            background: rgba(30, 30, 50, 0.98);
            backdrop-filter: blur(30px);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            display: none;
            flex-direction: column;
            z-index: 2000;
            box-shadow: 0 10px 50px rgba(0,0,0,0.5);
        }

        .start-search {
            padding: 15px;
            border-bottom: 1px solid var(--border);
        }

        .start-search input {
            width: 100%;
            padding: 12px 15px;
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: white;
            font-size: 14px;
            outline: none;
        }

        .start-search input:focus {
            border-color: var(--accent);
        }

        .start-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .start-pinned {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
        }

        .start-section-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-dim);
        }

        .start-apps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 5px;
        }

        .start-app-item {
            padding: 15px 10px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .start-app-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .start-app-icon { font-size: 28px; margin-bottom: 5px; }
        .start-app-name { font-size: 11px; }

        .start-user {
            padding: 15px;
            border-top: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .start-user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .start-user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .start-power-btns {
            display: flex;
            gap: 10px;
        }

        .power-btn {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .power-btn:hover {
            background: rgba(255,255,255,0.1);
        }

        /* ==================== WINDOW SYSTEM ==================== */
        .window {
            position: absolute;
            min-width: 300px;
            min-height: 200px;
            background: var(--bg-panel);
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .window.maximized {
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: calc(100vh - var(--taskbar-height)) !important;
            border-radius: 0;
        }

        .window.minimized {
            display: none;
        }

        .window-header {
            height: 36px;
            background: var(--bg-darker);
            display: flex;
            align-items: center;
            padding: 0 10px;
            cursor: move;
            flex-shrink: 0;
        }

        .window-icon { font-size: 14px; margin-right: 8px; }
        .window-title {
            flex: 1;
            font-size: 12px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .window-controls {
            display: flex;
            gap: 2px;
        }

        .window-btn {
            width: 36px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 12px;
        }

        .window-btn:hover { background: rgba(255,255,255,0.1); }
        .window-btn.close:hover { background: #e81123; }

        .window-content {
            flex: 1;
            overflow: auto;
            background: var(--bg-dark);
        }

        .window-resize {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 15px;
            height: 15px;
            cursor: se-resize;
        }

        /* ==================== CONTEXT MENU ==================== */
        #context-menu {
            position: fixed;
            background: rgba(40, 40, 60, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 8px;
            border: 1px solid var(--border);
            min-width: 200px;
            display: none;
            z-index: 5000;
            padding: 5px 0;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }

        .context-item {
            padding: 10px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 13px;
        }

        .context-item:hover {
            background: var(--accent);
        }

        .context-divider {
            height: 1px;
            background: var(--border);
            margin: 5px 0;
        }

        /* ==================== NOTIFICATIONS ==================== */
        #notifications {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 350px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 6000;
            pointer-events: none;
        }

        .notification {
            background: rgba(40, 40, 60, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid var(--border);
            animation: slideIn 0.3s ease;
            pointer-events: auto;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .notification-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .notification-title { font-weight: 600; }
        .notification-body { font-size: 13px; color: var(--text-dim); }

        /* ==================== APP STYLES ==================== */

        /* File Explorer */
        .file-explorer {
            display: flex;
            height: 100%;
        }

        .file-sidebar {
            width: 200px;
            background: var(--bg-darker);
            border-right: 1px solid var(--border);
            padding: 10px;
        }

        .file-sidebar-item {
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
        }

        .file-sidebar-item:hover, .file-sidebar-item.active {
            background: rgba(255,255,255,0.1);
        }

        .file-main {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .file-toolbar {
            padding: 10px;
            background: var(--bg-panel);
            border-bottom: 1px solid var(--border);
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .file-path {
            flex: 1;
            padding: 8px 12px;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: white;
            font-size: 13px;
        }

        .file-grid {
            flex: 1;
            padding: 15px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 15px;
            align-content: start;
            overflow-y: auto;
        }

        .file-item {
            padding: 15px 10px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .file-item:hover {
            background: rgba(255,255,255,0.1);
        }

        .file-item.selected {
            background: rgba(0,120,212,0.3);
        }

        .file-item-icon { font-size: 40px; margin-bottom: 8px; }
        .file-item-name { font-size: 12px; word-break: break-word; }

        /* Terminal */
        .terminal {
            height: 100%;
            background: #0c0c0c;
            font-family: 'Consolas', 'Courier New', monospace;
            padding: 15px;
            overflow-y: auto;
        }

        .terminal-line {
            margin-bottom: 5px;
            white-space: pre-wrap;
            word-break: break-all;
        }

        .terminal-prompt {
            color: #4ec9b0;
        }

        .terminal-input-line {
            display: flex;
            align-items: center;
        }

        .terminal-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #d4d4d4;
            font-family: inherit;
            font-size: 14px;
            outline: none;
        }

        /* Text Editor */
        .text-editor {
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .editor-toolbar {
            padding: 8px 15px;
            background: var(--bg-panel);
            border-bottom: 1px solid var(--border);
            display: flex;
            gap: 5px;
        }

        .editor-btn {
            padding: 6px 12px;
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 4px;
            font-size: 13px;
        }

        .editor-btn:hover {
            background: rgba(255,255,255,0.1);
        }

        .editor-textarea {
            flex: 1;
            background: var(--bg-dark);
            border: none;
            color: white;
            padding: 15px;
            font-family: 'Consolas', monospace;
            font-size: 14px;
            resize: none;
            outline: none;
            line-height: 1.6;
        }

        /* Calculator */
        .calculator {
            padding: 20px;
            max-width: 300px;
            margin: 0 auto;
        }

        .calc-display {
            background: var(--bg-darker);
            padding: 20px;
            text-align: right;
            font-size: 32px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-family: 'Consolas', monospace;
            overflow: hidden;
        }

        .calc-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }

        .calc-btn {
            padding: 20px;
            font-size: 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--bg-panel);
            color: white;
        }

        .calc-btn:hover {
            background: var(--bg-darker);
        }

        .calc-btn.operator {
            background: var(--accent);
        }

        .calc-btn.equals {
            background: var(--success);
            grid-column: span 2;
        }

        /* Settings */
        .settings {
            display: flex;
            height: 100%;
        }

        .settings-nav {
            width: 200px;
            background: var(--bg-darker);
            padding: 20px 10px;
        }

        .settings-nav-item {
            padding: 12px 15px;
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .settings-nav-item:hover, .settings-nav-item.active {
            background: rgba(255,255,255,0.1);
        }

        .settings-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .settings-section {
            margin-bottom: 40px;
        }

        .settings-title {
            font-size: 24px;
            margin-bottom: 20px;
        }

        .settings-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border);
        }

        .settings-option-info h4 {
            margin-bottom: 5px;
        }

        .settings-option-info p {
            font-size: 13px;
            color: var(--text-dim);
        }

        /* Toggle Switch */
        .toggle {
            width: 50px;
            height: 26px;
            background: var(--bg-darker);
            border-radius: 13px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s;
        }

        .toggle.active {
            background: var(--accent);
        }

        .toggle::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            top: 3px;
            left: 3px;
            transition: transform 0.3s;
        }

        .toggle.active::after {
            transform: translateX(24px);
        }

        /* Task Manager */
        .task-manager {
            padding: 15px;
        }

        .task-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
        }

        .task-tab {
            padding: 10px 20px;
            background: var(--bg-panel);
            border-radius: 6px 6px 0 0;
            cursor: pointer;
        }

        .task-tab.active {
            background: var(--accent);
        }

        .task-table {
            width: 100%;
            border-collapse: collapse;
        }

        .task-table th, .task-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .task-table th {
            background: var(--bg-panel);
            font-weight: 600;
        }

        .task-table tr:hover {
            background: rgba(255,255,255,0.05);
        }

        /* Browser */
        .browser {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .browser-toolbar {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: var(--bg-panel);
        }

        .browser-nav-btn {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
            background: var(--bg-dark);
        }

        .browser-nav-btn:hover {
            background: var(--bg-darker);
        }

        .browser-url {
            flex: 1;
            padding: 10px 15px;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 20px;
            color: white;
            font-size: 13px;
            outline: none;
        }

        .browser-frame {
            flex: 1;
            border: none;
            background: white;
        }

        /* Paint */
        .paint {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .paint-toolbar {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px 15px;
            background: var(--bg-panel);
            border-bottom: 1px solid var(--border);
        }

        .paint-colors {
            display: flex;
            gap: 5px;
        }

        .paint-color {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .paint-color.active {
            border-color: white;
        }

        .paint-canvas {
            flex: 1;
            background: white;
            cursor: crosshair;
        }

        /* Calendar */
        .calendar {
            padding: 20px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-title {
            font-size: 20px;
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
        }

        .calendar-nav-btn {
            padding: 8px 15px;
            background: var(--bg-panel);
            border: none;
            border-radius: 6px;
            color: white;
            cursor: pointer;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .calendar-day-header {
            padding: 10px;
            text-align: center;
            font-weight: 600;
            color: var(--text-dim);
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
        }

        .calendar-day:hover {
            background: rgba(255,255,255,0.1);
        }

        .calendar-day.today {
            background: var(--accent);
        }

        .calendar-day.other-month {
            color: var(--text-dim);
        }

        /* About */
        .about {
            padding: 40px;
            text-align: center;
        }

        .about-logo {
            font-size: 80px;
            margin-bottom: 20px;
        }

        .about-title {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .about-version {
            color: var(--text-dim);
            margin-bottom: 30px;
        }

        .about-info {
            max-width: 400px;
            margin: 0 auto;
            text-align: left;
        }

        .about-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
        }

        /* Media Player */
        .media-player {
            padding: 20px;
            text-align: center;
        }

        .media-cover {
            width: 200px;
            height: 200px;
            background: linear-gradient(135deg, var(--accent), #00d4aa);
            border-radius: 10px;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
        }

        .media-title {
            font-size: 20px;
            margin-bottom: 5px;
        }

        .media-artist {
            color: var(--text-dim);
            margin-bottom: 20px;
        }

        .media-progress {
            height: 4px;
            background: var(--bg-panel);
            border-radius: 2px;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .media-progress-bar {
            height: 100%;
            background: var(--accent);
            width: 35%;
        }

        .media-times {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--text-dim);
            margin-bottom: 20px;
        }

        .media-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .media-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--bg-panel);
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }

        .media-btn.play {
            width: 60px;
            height: 60px;
            background: var(--accent);
        }

        /* Weather Widget */
        .weather {
            padding: 30px;
            text-align: center;
            background: linear-gradient(135deg, #1a5fb4, #3584e4);
            height: 100%;
        }

        .weather-temp {
            font-size: 72px;
            font-weight: 200;
        }

        .weather-desc {
            font-size: 24px;
            margin-bottom: 30px;
        }

        .weather-details {
            display: flex;
            justify-content: center;
            gap: 40px;
        }

        .weather-detail {
            text-align: center;
        }

        .weather-detail-value {
            font-size: 24px;
        }

        .weather-detail-label {
            font-size: 12px;
            opacity: 0.8;
        }

        /* Notes */
        .notes {
            display: flex;
            height: 100%;
        }

        .notes-list {
            width: 250px;
            background: var(--bg-darker);
            border-right: 1px solid var(--border);
            overflow-y: auto;
        }

        .notes-list-header {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .note-item {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
        }

        .note-item:hover, .note-item.active {
            background: rgba(255,255,255,0.05);
        }

        .note-item-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .note-item-preview {
            font-size: 12px;
            color: var(--text-dim);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .note-item-date {
            font-size: 11px;
            color: var(--text-dim);
            margin-top: 5px;
        }

        .notes-editor {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .notes-editor-title {
            padding: 15px;
            background: var(--bg-panel);
            border-bottom: 1px solid var(--border);
        }

        .notes-editor-title input {
            width: 100%;
            background: transparent;
            border: none;
            color: white;
            font-size: 18px;
            font-weight: 600;
            outline: none;
        }

        .notes-editor-content {
            flex: 1;
            padding: 15px;
            background: var(--bg-dark);
        }

        .notes-editor-content textarea {
            width: 100%;
            height: 100%;
            background: transparent;
            border: none;
            color: white;
            font-size: 14px;
            line-height: 1.6;
            resize: none;
            outline: none;
        }

        /* Image Viewer */
        .image-viewer {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #000;
        }

        .image-viewer img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        /* Games Hub */
        .games-hub {
            padding: 20px;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
        }

        .game-card {
            background: var(--bg-panel);
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .game-card:hover {
            transform: translateY(-5px);
        }

        .game-card-cover {
            height: 100px;
            background: linear-gradient(135deg, var(--accent), #0fa);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
        }

        .game-card-info {
            padding: 12px;
        }

        .game-card-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .game-card-genre {
            font-size: 12px;
            color: var(--text-dim);
        }

        /* InfiniteOS Recursive Instance */
        .recursive-os {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* App Store */
        .app-store {
            padding: 20px;
        }

        .app-store-header {
            margin-bottom: 30px;
        }

        .app-store-title {
            font-size: 28px;
            margin-bottom: 15px;
        }

        .app-store-search {
            width: 100%;
            max-width: 500px;
            padding: 12px 20px;
            background: var(--bg-panel);
            border: 1px solid var(--border);
            border-radius: 25px;
            color: white;
            font-size: 14px;
            outline: none;
        }

        .app-store-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .store-app-card {
            background: var(--bg-panel);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .store-app-card:hover {
            background: var(--bg-darker);
            transform: translateY(-3px);
        }

        .store-app-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .store-app-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .store-app-desc {
            font-size: 12px;
            color: var(--text-dim);
            margin-bottom: 10px;
        }

        .store-app-btn {
            padding: 8px 20px;
            background: var(--accent);
            border: none;
            border-radius: 15px;
            color: white;
            font-size: 12px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- Boot Screen -->
    <div id="boot-screen">
        <div class="boot-logo">‚ôæÔ∏è</div>
        <div class="boot-text">INFINITE OS</div>
        <div class="boot-progress">
            <div class="boot-progress-bar" id="boot-progress"></div>
        </div>
        <div class="boot-status" id="boot-status">Initializing kernel...</div>
    </div>

    <!-- Login Screen -->
    <div id="login-screen">
        <div class="login-time" id="login-time">12:00</div>
        <div class="login-date" id="login-date">Thursday, November 28</div>
        <div class="login-container">
            <div class="login-avatar">üë§</div>
            <div class="login-username" id="login-username">User</div>
            <input type="password" class="login-input" id="login-password" placeholder="Enter password (or just press Enter)">
            <br>
            <button class="login-btn" id="login-btn">Sign In</button>
        </div>
    </div>

    <!-- Desktop -->
    <div id="desktop">
        <div class="desktop-icons" id="desktop-icons"></div>
    </div>

    <!-- Taskbar -->
    <div id="taskbar">
        <div class="start-btn" id="start-btn">‚ôæÔ∏è</div>
        <div class="taskbar-apps" id="taskbar-apps"></div>
        <div class="system-tray">
            <span class="tray-icon" title="Network">üì∂</span>
            <span class="tray-icon" title="Sound">üîä</span>
            <span class="tray-icon" title="Battery">üîã</span>
            <div class="taskbar-clock" id="taskbar-clock">
                <div>12:00 PM</div>
                <div>11/28/2024</div>
            </div>
        </div>
    </div>

    <!-- Start Menu -->
    <div id="start-menu">
        <div class="start-search">
            <input type="text" placeholder="Search apps, settings, files..." id="start-search-input">
        </div>
        <div class="start-content">
            <div class="start-pinned">
                <div class="start-section-title">Pinned Apps</div>
                <div class="start-apps-grid" id="start-apps-grid"></div>
            </div>
        </div>
        <div class="start-user">
            <div class="start-user-info">
                <div class="start-user-avatar">üë§</div>
                <span id="start-username">User</span>
            </div>
            <div class="start-power-btns">
                <div class="power-btn" title="Sleep" onclick="OS.sleep()">üò¥</div>
                <div class="power-btn" title="Restart" onclick="OS.restart()">üîÑ</div>
                <div class="power-btn" title="Shut Down" onclick="OS.shutdown()">‚èª</div>
            </div>
        </div>
    </div>

    <!-- Context Menu -->
    <div id="context-menu"></div>

    <!-- Notifications Container -->
    <div id="notifications"></div>

    <!-- Windows Container -->
    <div id="windows-container"></div>

    <script>
        // ==================== INFINITE OS CORE ====================
        const OS = {
            version: '1.0.0',
            user: { name: 'User', avatar: 'üë§' },
            windows: [],
            activeWindow: null,
            zIndex: 100,
            isStartMenuOpen: false,
            apps: {},
            fileSystem: {},
            settings: {
                theme: 'dark',
                wallpaper: 'gradient',
                animations: true,
                sounds: true,
                recursionDepth: 0
            },

            // Boot sequence
            async boot() {
                const bootStatus = document.getElementById('boot-status');
                const bootProgress = document.getElementById('boot-progress');

                const steps = [
                    { msg: 'Initializing kernel...', progress: 10 },
                    { msg: 'Loading system drivers...', progress: 25 },
                    { msg: 'Starting window manager...', progress: 40 },
                    { msg: 'Initializing file system...', progress: 55 },
                    { msg: 'Loading user preferences...', progress: 70 },
                    { msg: 'Starting system services...', progress: 85 },
                    { msg: 'Welcome to InfiniteOS', progress: 100 }
                ];

                for (const step of steps) {
                    bootStatus.textContent = step.msg;
                    bootProgress.style.width = step.progress + '%';
                    await this.delay(400);
                }

                await this.delay(500);
                document.getElementById('boot-screen').classList.add('hidden');

                // Load saved data
                this.loadData();

                // Show login
                await this.delay(600);
                document.getElementById('login-screen').style.display = 'flex';
                this.updateLoginClock();
                setInterval(() => this.updateLoginClock(), 1000);
            },

            updateLoginClock() {
                const now = new Date();
                document.getElementById('login-time').textContent = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false });
                document.getElementById('login-date').textContent = now.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' });
            },

            login() {
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('desktop').style.display = 'block';
                document.getElementById('taskbar').style.display = 'flex';

                this.initDesktop();
                this.startClock();
                this.notify('Welcome', `Welcome to InfiniteOS ${this.version}`, '‚ôæÔ∏è');
            },

            loadData() {
                try {
                    const saved = localStorage.getItem('infiniteOS');
                    if (saved) {
                        const data = JSON.parse(saved);
                        this.user = data.user || this.user;
                        this.fileSystem = data.fileSystem || this.initFileSystem();
                        this.settings = { ...this.settings, ...data.settings };
                    } else {
                        this.fileSystem = this.initFileSystem();
                    }
                } catch (e) {
                    this.fileSystem = this.initFileSystem();
                }

                document.getElementById('login-username').textContent = this.user.name;
                document.getElementById('start-username').textContent = this.user.name;
            },

            saveData() {
                const data = {
                    user: this.user,
                    fileSystem: this.fileSystem,
                    settings: this.settings
                };
                localStorage.setItem('infiniteOS', JSON.stringify(data));
            },

            initFileSystem() {
                return {
                    'C:': {
                        type: 'drive',
                        children: {
                            'Users': {
                                type: 'folder',
                                children: {
                                    'User': {
                                        type: 'folder',
                                        children: {
                                            'Desktop': { type: 'folder', children: {} },
                                            'Documents': {
                                                type: 'folder',
                                                children: {
                                                    'readme.txt': { type: 'file', content: 'Welcome to InfiniteOS!\n\nThis is a fully functional operating system running in your browser.' },
                                                    'notes.txt': { type: 'file', content: 'My Notes\n\n- Learn InfiniteOS\n- Explore apps\n- Try recursive mode!' }
                                                }
                                            },
                                            'Pictures': { type: 'folder', children: {} },
                                            'Music': { type: 'folder', children: {} },
                                            'Downloads': { type: 'folder', children: {} }
                                        }
                                    }
                                }
                            },
                            'Program Files': { type: 'folder', children: {} },
                            'System': { type: 'folder', children: {} }
                        }
                    }
                };
            },

            initDesktop() {
                const desktopApps = [
                    { id: 'file-explorer', name: 'File Explorer', icon: 'üìÅ' },
                    { id: 'terminal', name: 'Terminal', icon: 'üíª' },
                    { id: 'browser', name: 'Browser', icon: 'üåê' },
                    { id: 'notepad', name: 'Notepad', icon: 'üìù' },
                    { id: 'calculator', name: 'Calculator', icon: 'üî¢' },
                    { id: 'settings', name: 'Settings', icon: '‚öôÔ∏è' },
                    { id: 'paint', name: 'Paint', icon: 'üé®' },
                    { id: 'infinite-os', name: 'InfiniteOS', icon: '‚ôæÔ∏è' },
                    { id: 'app-store', name: 'App Store', icon: 'üè™' }
                ];

                const container = document.getElementById('desktop-icons');
                container.innerHTML = '';

                desktopApps.forEach(app => {
                    const icon = document.createElement('div');
                    icon.className = 'desktop-icon';
                    icon.innerHTML = `
                        <div class="desktop-icon-img">${app.icon}</div>
                        <div class="desktop-icon-label">${app.name}</div>
                    `;
                    icon.ondblclick = () => this.openApp(app.id);
                    icon.onclick = (e) => {
                        document.querySelectorAll('.desktop-icon').forEach(i => i.classList.remove('selected'));
                        icon.classList.add('selected');
                    };
                    container.appendChild(icon);
                });

                this.initStartMenu();
            },

            initStartMenu() {
                const apps = [
                    { id: 'file-explorer', name: 'Files', icon: 'üìÅ' },
                    { id: 'terminal', name: 'Terminal', icon: 'üíª' },
                    { id: 'browser', name: 'Browser', icon: 'üåê' },
                    { id: 'notepad', name: 'Notepad', icon: 'üìù' },
                    { id: 'calculator', name: 'Calculator', icon: 'üî¢' },
                    { id: 'settings', name: 'Settings', icon: '‚öôÔ∏è' },
                    { id: 'paint', name: 'Paint', icon: 'üé®' },
                    { id: 'calendar', name: 'Calendar', icon: 'üìÖ' },
                    { id: 'notes', name: 'Notes', icon: 'üìí' },
                    { id: 'music', name: 'Music', icon: 'üéµ' },
                    { id: 'weather', name: 'Weather', icon: 'üå§Ô∏è' },
                    { id: 'task-manager', name: 'Task Manager', icon: 'üìä' },
                    { id: 'games', name: 'Games', icon: 'üéÆ' },
                    { id: 'about', name: 'About', icon: '‚ÑπÔ∏è' },
                    { id: 'infinite-os', name: 'InfiniteOS', icon: '‚ôæÔ∏è' },
                    { id: 'app-store', name: 'App Store', icon: 'üè™' }
                ];

                const grid = document.getElementById('start-apps-grid');
                grid.innerHTML = '';

                apps.forEach(app => {
                    const item = document.createElement('div');
                    item.className = 'start-app-item';
                    item.innerHTML = `
                        <div class="start-app-icon">${app.icon}</div>
                        <div class="start-app-name">${app.name}</div>
                    `;
                    item.onclick = () => {
                        this.openApp(app.id);
                        this.toggleStartMenu(false);
                    };
                    grid.appendChild(item);
                });
            },

            toggleStartMenu(show = null) {
                const menu = document.getElementById('start-menu');
                this.isStartMenuOpen = show !== null ? show : !this.isStartMenuOpen;
                menu.style.display = this.isStartMenuOpen ? 'flex' : 'none';

                if (this.isStartMenuOpen) {
                    document.getElementById('start-search-input').focus();
                }
            },

            startClock() {
                const updateClock = () => {
                    const now = new Date();
                    const clock = document.getElementById('taskbar-clock');
                    clock.innerHTML = `
                        <div>${now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })}</div>
                        <div>${now.toLocaleDateString()}</div>
                    `;
                };
                updateClock();
                setInterval(updateClock, 1000);
            },

            // Window Management
            createWindow(options) {
                const id = 'window-' + Date.now();
                const win = document.createElement('div');
                win.className = 'window';
                win.id = id;
                win.style.cssText = `
                    left: ${50 + this.windows.length * 30}px;
                    top: ${50 + this.windows.length * 30}px;
                    width: ${options.width || 800}px;
                    height: ${options.height || 500}px;
                    z-index: ${++this.zIndex};
                `;

                win.innerHTML = `
                    <div class="window-header">
                        <span class="window-icon">${options.icon || 'üìÑ'}</span>
                        <span class="window-title">${options.title || 'Window'}</span>
                        <div class="window-controls">
                            <div class="window-btn minimize" onclick="OS.minimizeWindow('${id}')">‚îÄ</div>
                            <div class="window-btn maximize" onclick="OS.maximizeWindow('${id}')">‚ñ°</div>
                            <div class="window-btn close" onclick="OS.closeWindow('${id}')">‚úï</div>
                        </div>
                    </div>
                    <div class="window-content">${options.content || ''}</div>
                    <div class="window-resize"></div>
                `;

                document.getElementById('windows-container').appendChild(win);

                const windowData = {
                    id,
                    title: options.title,
                    icon: options.icon,
                    element: win,
                    isMaximized: false,
                    isMinimized: false,
                    prevState: null,
                    onInit: options.onInit
                };

                this.windows.push(windowData);
                this.activeWindow = id;

                this.makeDraggable(win);
                this.makeResizable(win);
                this.updateTaskbar();

                win.onclick = () => this.focusWindow(id);

                if (options.onInit) {
                    options.onInit(win.querySelector('.window-content'), windowData);
                }

                return windowData;
            },

            makeDraggable(win) {
                const header = win.querySelector('.window-header');
                let isDragging = false;
                let startX, startY, startLeft, startTop;

                header.onmousedown = (e) => {
                    if (e.target.closest('.window-controls')) return;
                    isDragging = true;
                    startX = e.clientX;
                    startY = e.clientY;
                    startLeft = win.offsetLeft;
                    startTop = win.offsetTop;
                    this.focusWindow(win.id);
                };

                document.addEventListener('mousemove', (e) => {
                    if (!isDragging) return;
                    const windowData = this.windows.find(w => w.id === win.id);
                    if (windowData?.isMaximized) return;

                    win.style.left = (startLeft + e.clientX - startX) + 'px';
                    win.style.top = (startTop + e.clientY - startY) + 'px';
                });

                document.addEventListener('mouseup', () => {
                    isDragging = false;
                });
            },

            makeResizable(win) {
                const resizer = win.querySelector('.window-resize');
                let isResizing = false;
                let startX, startY, startWidth, startHeight;

                resizer.onmousedown = (e) => {
                    isResizing = true;
                    startX = e.clientX;
                    startY = e.clientY;
                    startWidth = win.offsetWidth;
                    startHeight = win.offsetHeight;
                    e.preventDefault();
                };

                document.addEventListener('mousemove', (e) => {
                    if (!isResizing) return;
                    const windowData = this.windows.find(w => w.id === win.id);
                    if (windowData?.isMaximized) return;

                    win.style.width = Math.max(300, startWidth + e.clientX - startX) + 'px';
                    win.style.height = Math.max(200, startHeight + e.clientY - startY) + 'px';
                });

                document.addEventListener('mouseup', () => {
                    isResizing = false;
                });
            },

            focusWindow(id) {
                this.windows.forEach(w => {
                    w.element.style.zIndex = 100;
                });
                const win = this.windows.find(w => w.id === id);
                if (win) {
                    win.element.style.zIndex = ++this.zIndex;
                    this.activeWindow = id;
                }
                this.updateTaskbar();
            },

            minimizeWindow(id) {
                const win = this.windows.find(w => w.id === id);
                if (win) {
                    win.isMinimized = true;
                    win.element.classList.add('minimized');
                    this.updateTaskbar();
                }
            },

            maximizeWindow(id) {
                const win = this.windows.find(w => w.id === id);
                if (win) {
                    if (win.isMaximized) {
                        win.element.classList.remove('maximized');
                        if (win.prevState) {
                            win.element.style.left = win.prevState.left;
                            win.element.style.top = win.prevState.top;
                            win.element.style.width = win.prevState.width;
                            win.element.style.height = win.prevState.height;
                        }
                        win.isMaximized = false;
                    } else {
                        win.prevState = {
                            left: win.element.style.left,
                            top: win.element.style.top,
                            width: win.element.style.width,
                            height: win.element.style.height
                        };
                        win.element.classList.add('maximized');
                        win.isMaximized = true;
                    }
                }
            },

            closeWindow(id) {
                const idx = this.windows.findIndex(w => w.id === id);
                if (idx !== -1) {
                    this.windows[idx].element.remove();
                    this.windows.splice(idx, 1);
                    this.updateTaskbar();
                }
            },

            updateTaskbar() {
                const container = document.getElementById('taskbar-apps');
                container.innerHTML = '';

                this.windows.forEach(win => {
                    const app = document.createElement('div');
                    app.className = 'taskbar-app' + (win.id === this.activeWindow && !win.isMinimized ? ' active' : '');
                    app.innerHTML = `
                        <span class="taskbar-app-icon">${win.icon}</span>
                        <span class="taskbar-app-title">${win.title}</span>
                    `;
                    app.onclick = () => {
                        if (win.isMinimized) {
                            win.isMinimized = false;
                            win.element.classList.remove('minimized');
                        }
                        this.focusWindow(win.id);
                    };
                    container.appendChild(app);
                });
            },

            // App Launchers
            openApp(appId) {
                const apps = {
                    'file-explorer': () => this.openFileExplorer(),
                    'terminal': () => this.openTerminal(),
                    'browser': () => this.openBrowser(),
                    'notepad': () => this.openNotepad(),
                    'calculator': () => this.openCalculator(),
                    'settings': () => this.openSettings(),
                    'paint': () => this.openPaint(),
                    'calendar': () => this.openCalendar(),
                    'notes': () => this.openNotes(),
                    'music': () => this.openMusic(),
                    'weather': () => this.openWeather(),
                    'task-manager': () => this.openTaskManager(),
                    'games': () => this.openGames(),
                    'about': () => this.openAbout(),
                    'infinite-os': () => this.openRecursiveOS(),
                    'app-store': () => this.openAppStore()
                };

                if (apps[appId]) {
                    apps[appId]();
                }
            },

            // ==================== APPLICATIONS ====================

            openFileExplorer(path = 'C:/Users/User') {
                this.createWindow({
                    title: 'File Explorer',
                    icon: 'üìÅ',
                    width: 900,
                    height: 600,
                    content: `
                        <div class="file-explorer">
                            <div class="file-sidebar">
                                <div class="file-sidebar-item" onclick="OS.navigateTo('C:')">üíø Local Disk (C:)</div>
                                <div class="file-sidebar-item" onclick="OS.navigateTo('C:/Users/User/Desktop')">üñ•Ô∏è Desktop</div>
                                <div class="file-sidebar-item" onclick="OS.navigateTo('C:/Users/User/Documents')">üìÑ Documents</div>
                                <div class="file-sidebar-item" onclick="OS.navigateTo('C:/Users/User/Pictures')">üñºÔ∏è Pictures</div>
                                <div class="file-sidebar-item" onclick="OS.navigateTo('C:/Users/User/Music')">üéµ Music</div>
                                <div class="file-sidebar-item" onclick="OS.navigateTo('C:/Users/User/Downloads')">‚¨áÔ∏è Downloads</div>
                            </div>
                            <div class="file-main">
                                <div class="file-toolbar">
                                    <button class="editor-btn" onclick="OS.goBack()">‚Üê Back</button>
                                    <input type="text" class="file-path" id="file-path" value="${path}" readonly>
                                    <button class="editor-btn" onclick="OS.createFolder()">New Folder</button>
                                    <button class="editor-btn" onclick="OS.createFile()">New File</button>
                                </div>
                                <div class="file-grid" id="file-grid"></div>
                            </div>
                        </div>
                    `,
                    onInit: () => this.navigateTo(path)
                });
            },

            currentPath: 'C:/Users/User',
            pathHistory: [],

            navigateTo(path) {
                this.pathHistory.push(this.currentPath);
                this.currentPath = path;

                const pathInput = document.getElementById('file-path');
                const grid = document.getElementById('file-grid');

                if (pathInput) pathInput.value = path;
                if (!grid) return;

                grid.innerHTML = '';

                const folder = this.getFolder(path);
                if (!folder || !folder.children) return;

                Object.entries(folder.children).forEach(([name, item]) => {
                    const div = document.createElement('div');
                    div.className = 'file-item';
                    const icon = item.type === 'folder' ? 'üìÅ' : this.getFileIcon(name);
                    div.innerHTML = `
                        <div class="file-item-icon">${icon}</div>
                        <div class="file-item-name">${name}</div>
                    `;
                    div.ondblclick = () => {
                        if (item.type === 'folder' || item.type === 'drive') {
                            this.navigateTo(path + '/' + name);
                        } else {
                            this.openFile(path + '/' + name, item);
                        }
                    };
                    grid.appendChild(div);
                });
            },

            goBack() {
                if (this.pathHistory.length > 0) {
                    const path = this.pathHistory.pop();
                    this.currentPath = path;
                    this.navigateTo(path);
                    this.pathHistory.pop(); // Remove duplicate
                }
            },

            getFolder(path) {
                const parts = path.split('/').filter(p => p);
                let current = this.fileSystem;

                for (const part of parts) {
                    if (current[part]) {
                        current = current[part].children || current[part];
                    } else if (current.children && current.children[part]) {
                        current = current.children[part];
                    } else {
                        return null;
                    }
                }

                return current.children ? current : { children: current };
            },

            getFileIcon(filename) {
                const ext = filename.split('.').pop().toLowerCase();
                const icons = {
                    'txt': 'üìÑ', 'doc': 'üìÑ', 'docx': 'üìÑ',
                    'jpg': 'üñºÔ∏è', 'jpeg': 'üñºÔ∏è', 'png': 'üñºÔ∏è', 'gif': 'üñºÔ∏è',
                    'mp3': 'üéµ', 'wav': 'üéµ', 'ogg': 'üéµ',
                    'mp4': 'üé¨', 'avi': 'üé¨', 'mkv': 'üé¨',
                    'pdf': 'üìï', 'zip': 'üì¶', 'exe': '‚öôÔ∏è',
                    'html': 'üåê', 'js': 'üìú', 'css': 'üé®'
                };
                return icons[ext] || 'üìÑ';
            },

            openFile(path, item) {
                if (item.type === 'file') {
                    this.openNotepad(item.content, path.split('/').pop());
                }
            },

            createFolder() {
                const name = prompt('Folder name:');
                if (name) {
                    const folder = this.getFolder(this.currentPath);
                    if (folder && folder.children) {
                        folder.children[name] = { type: 'folder', children: {} };
                        this.saveData();
                        this.navigateTo(this.currentPath);
                    }
                }
            },

            createFile() {
                const name = prompt('File name (with extension):');
                if (name) {
                    const folder = this.getFolder(this.currentPath);
                    if (folder && folder.children) {
                        folder.children[name] = { type: 'file', content: '' };
                        this.saveData();
                        this.navigateTo(this.currentPath);
                    }
                }
            },

            openTerminal() {
                this.createWindow({
                    title: 'Terminal',
                    icon: 'üíª',
                    width: 700,
                    height: 450,
                    content: `
                        <div class="terminal" id="terminal">
                            <div class="terminal-line">InfiniteOS Terminal v${this.version}</div>
                            <div class="terminal-line">Type 'help' for available commands.</div>
                            <div class="terminal-line"></div>
                        </div>
                    `,
                    onInit: (content) => {
                        const terminal = content.querySelector('#terminal');
                        this.addTerminalInput(terminal);
                    }
                });
            },

            addTerminalInput(terminal) {
                const inputLine = document.createElement('div');
                inputLine.className = 'terminal-input-line';
                inputLine.innerHTML = `
                    <span class="terminal-prompt">${this.user.name}@infiniteos:~$ </span>
                    <input type="text" class="terminal-input" autofocus>
                `;
                terminal.appendChild(inputLine);

                const input = inputLine.querySelector('.terminal-input');
                input.focus();

                input.onkeydown = (e) => {
                    if (e.key === 'Enter') {
                        const cmd = input.value.trim();
                        input.disabled = true;

                        const output = this.executeCommand(cmd);
                        if (output) {
                            const outputLine = document.createElement('div');
                            outputLine.className = 'terminal-line';
                            outputLine.innerHTML = output;
                            terminal.appendChild(outputLine);
                        }

                        this.addTerminalInput(terminal);
                        terminal.scrollTop = terminal.scrollHeight;
                    }
                };
            },

            executeCommand(cmd) {
                const parts = cmd.toLowerCase().split(' ');
                const command = parts[0];
                const args = parts.slice(1);

                const commands = {
                    'help': () => `Available commands:
  help      - Show this help
  clear     - Clear terminal
  echo      - Print text
  date      - Show current date/time
  whoami    - Show current user
  ls        - List files
  pwd       - Print working directory
  neofetch  - System info
  matrix    - Enter the matrix
  cowsay    - Cow says something
  fortune   - Random fortune
  calc      - Calculator (e.g., calc 2+2)
  reboot    - Restart OS
  exit      - Close terminal`,
                    'clear': () => {
                        const terminal = document.getElementById('terminal');
                        terminal.innerHTML = '';
                        return '';
                    },
                    'echo': () => args.join(' '),
                    'date': () => new Date().toString(),
                    'whoami': () => this.user.name,
                    'pwd': () => this.currentPath,
                    'ls': () => {
                        const folder = this.getFolder(this.currentPath);
                        if (folder && folder.children) {
                            return Object.keys(folder.children).join('  ');
                        }
                        return 'Empty directory';
                    },
                    'neofetch': () => `
       ‚ôæÔ∏è‚ôæÔ∏è‚ôæÔ∏è‚ôæÔ∏è‚ôæÔ∏è       ${this.user.name}@infiniteos
     ‚ôæÔ∏è       ‚ôæÔ∏è     ----------------------
    ‚ôæÔ∏è  ‚ôæÔ∏è‚ôæÔ∏è‚ôæÔ∏è  ‚ôæÔ∏è    OS: InfiniteOS ${this.version}
    ‚ôæÔ∏è  ‚ôæÔ∏è‚ôæÔ∏è‚ôæÔ∏è  ‚ôæÔ∏è    Kernel: Browser JS Engine
    ‚ôæÔ∏è  ‚ôæÔ∏è‚ôæÔ∏è‚ôæÔ∏è  ‚ôæÔ∏è    Shell: InfiniteShell
     ‚ôæÔ∏è       ‚ôæÔ∏è     Resolution: ${window.innerWidth}x${window.innerHeight}
       ‚ôæÔ∏è‚ôæÔ∏è‚ôæÔ∏è‚ôæÔ∏è‚ôæÔ∏è       Windows: ${this.windows.length}
                     Memory: ${(performance.memory?.usedJSHeapSize / 1024 / 1024).toFixed(1) || '?'} MB`,
                    'matrix': () => {
                        this.notify('Matrix', 'Wake up, Neo...', 'üêá');
                        return '<span style="color:#0f0">Follow the white rabbit...</span>';
                    },
                    'cowsay': () => {
                        const msg = args.join(' ') || 'Moo!';
                        return `
  ${'_'.repeat(msg.length + 2)}
 < ${msg} >
  ${'-'.repeat(msg.length + 2)}
        \\   ^__^
         \\  (oo)\\_______
            (__)\\       )\\/\\
                ||----w |
                ||     ||`;
                    },
                    'fortune': () => {
                        const fortunes = [
                            'The best time to plant a tree was 20 years ago. The second best time is now.',
                            'In the middle of difficulty lies opportunity.',
                            'A journey of a thousand miles begins with a single step.',
                            'The only way to do great work is to love what you do.',
                            'Everything you can imagine is real.'
                        ];
                        return fortunes[Math.floor(Math.random() * fortunes.length)];
                    },
                    'calc': () => {
                        try {
                            return eval(args.join(''));
                        } catch (e) {
                            return 'Error: Invalid expression';
                        }
                    },
                    'reboot': () => { this.restart(); return 'Rebooting...'; },
                    'exit': () => {
                        setTimeout(() => {
                            const win = this.windows.find(w => w.title === 'Terminal');
                            if (win) this.closeWindow(win.id);
                        }, 100);
                        return 'Goodbye!';
                    }
                };

                if (commands[command]) {
                    return commands[command]();
                } else if (cmd) {
                    return `Command not found: ${command}. Type 'help' for available commands.`;
                }
                return '';
            },

            openBrowser() {
                this.createWindow({
                    title: 'Browser',
                    icon: 'üåê',
                    width: 1000,
                    height: 700,
                    content: `
                        <div class="browser">
                            <div class="browser-toolbar">
                                <div class="browser-nav-btn" onclick="document.getElementById('browser-frame').contentWindow.history.back()">‚Üê</div>
                                <div class="browser-nav-btn" onclick="document.getElementById('browser-frame').contentWindow.history.forward()">‚Üí</div>
                                <div class="browser-nav-btn" onclick="document.getElementById('browser-frame').src = document.getElementById('browser-frame').src">‚Üª</div>
                                <input type="text" class="browser-url" id="browser-url" value="https://www.google.com" placeholder="Enter URL...">
                                <div class="browser-nav-btn" onclick="OS.navigateBrowser()">‚Üí</div>
                            </div>
                            <iframe class="browser-frame" id="browser-frame" src="https://www.google.com/webhp?igu=1" sandbox="allow-same-origin allow-scripts allow-forms allow-popups"></iframe>
                        </div>
                    `,
                    onInit: (content) => {
                        const urlInput = content.querySelector('#browser-url');
                        urlInput.onkeydown = (e) => {
                            if (e.key === 'Enter') {
                                this.navigateBrowser();
                            }
                        };
                    }
                });
            },

            navigateBrowser() {
                const urlInput = document.getElementById('browser-url');
                let url = urlInput.value;
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    url = 'https://' + url;
                }
                document.getElementById('browser-frame').src = url;
            },

            openNotepad(content = '', filename = 'Untitled') {
                this.createWindow({
                    title: `Notepad - ${filename}`,
                    icon: 'üìù',
                    width: 700,
                    height: 500,
                    content: `
                        <div class="text-editor">
                            <div class="editor-toolbar">
                                <button class="editor-btn" onclick="OS.saveNotepad()">üíæ Save</button>
                                <button class="editor-btn" onclick="OS.openFileDialog()">üìÇ Open</button>
                                <button class="editor-btn" onclick="document.execCommand('bold')">B</button>
                                <button class="editor-btn" onclick="document.execCommand('italic')">I</button>
                            </div>
                            <textarea class="editor-textarea" id="notepad-content" placeholder="Start typing...">${content}</textarea>
                        </div>
                    `
                });
            },

            saveNotepad() {
                const content = document.getElementById('notepad-content').value;
                const filename = prompt('Save as:', 'document.txt');
                if (filename) {
                    const folder = this.getFolder(this.currentPath);
                    if (folder && folder.children) {
                        folder.children[filename] = { type: 'file', content };
                        this.saveData();
                        this.notify('Saved', `File saved as ${filename}`, 'üíæ');
                    }
                }
            },

            openCalculator() {
                let display = '0';
                let currentOp = null;
                let prevValue = null;
                let resetNext = false;

                this.createWindow({
                    title: 'Calculator',
                    icon: 'üî¢',
                    width: 350,
                    height: 500,
                    content: `
                        <div class="calculator">
                            <div class="calc-display" id="calc-display">0</div>
                            <div class="calc-buttons">
                                <button class="calc-btn" onclick="OS.calcClear()">C</button>
                                <button class="calc-btn" onclick="OS.calcBackspace()">‚å´</button>
                                <button class="calc-btn" onclick="OS.calcPercent()">%</button>
                                <button class="calc-btn operator" onclick="OS.calcOp('/')">√∑</button>
                                <button class="calc-btn" onclick="OS.calcNum('7')">7</button>
                                <button class="calc-btn" onclick="OS.calcNum('8')">8</button>
                                <button class="calc-btn" onclick="OS.calcNum('9')">9</button>
                                <button class="calc-btn operator" onclick="OS.calcOp('*')">√ó</button>
                                <button class="calc-btn" onclick="OS.calcNum('4')">4</button>
                                <button class="calc-btn" onclick="OS.calcNum('5')">5</button>
                                <button class="calc-btn" onclick="OS.calcNum('6')">6</button>
                                <button class="calc-btn operator" onclick="OS.calcOp('-')">‚àí</button>
                                <button class="calc-btn" onclick="OS.calcNum('1')">1</button>
                                <button class="calc-btn" onclick="OS.calcNum('2')">2</button>
                                <button class="calc-btn" onclick="OS.calcNum('3')">3</button>
                                <button class="calc-btn operator" onclick="OS.calcOp('+')">+</button>
                                <button class="calc-btn" onclick="OS.calcNum('0')">0</button>
                                <button class="calc-btn" onclick="OS.calcDecimal()">.</button>
                                <button class="calc-btn equals" onclick="OS.calcEquals()">=</button>
                            </div>
                        </div>
                    `
                });

                this.calcDisplay = '0';
                this.calcOp = null;
                this.calcPrev = null;
                this.calcReset = false;
            },

            calcNum(n) {
                const display = document.getElementById('calc-display');
                if (this.calcReset || this.calcDisplay === '0') {
                    this.calcDisplay = n;
                    this.calcReset = false;
                } else {
                    this.calcDisplay += n;
                }
                display.textContent = this.calcDisplay;
            },

            calcOp(op) {
                this.calcPrev = parseFloat(this.calcDisplay);
                this.calcOp = op;
                this.calcReset = true;
            },

            calcEquals() {
                if (this.calcOp && this.calcPrev !== null) {
                    const current = parseFloat(this.calcDisplay);
                    let result;
                    switch (this.calcOp) {
                        case '+': result = this.calcPrev + current; break;
                        case '-': result = this.calcPrev - current; break;
                        case '*': result = this.calcPrev * current; break;
                        case '/': result = this.calcPrev / current; break;
                    }
                    this.calcDisplay = String(result);
                    document.getElementById('calc-display').textContent = this.calcDisplay;
                    this.calcOp = null;
                    this.calcPrev = null;
                    this.calcReset = true;
                }
            },

            calcClear() {
                this.calcDisplay = '0';
                this.calcOp = null;
                this.calcPrev = null;
                document.getElementById('calc-display').textContent = '0';
            },

            calcBackspace() {
                this.calcDisplay = this.calcDisplay.slice(0, -1) || '0';
                document.getElementById('calc-display').textContent = this.calcDisplay;
            },

            calcDecimal() {
                if (!this.calcDisplay.includes('.')) {
                    this.calcDisplay += '.';
                    document.getElementById('calc-display').textContent = this.calcDisplay;
                }
            },

            calcPercent() {
                this.calcDisplay = String(parseFloat(this.calcDisplay) / 100);
                document.getElementById('calc-display').textContent = this.calcDisplay;
            },

            openSettings() {
                this.createWindow({
                    title: 'Settings',
                    icon: '‚öôÔ∏è',
                    width: 900,
                    height: 600,
                    content: `
                        <div class="settings">
                            <div class="settings-nav">
                                <div class="settings-nav-item active">üé® Personalization</div>
                                <div class="settings-nav-item">üñ•Ô∏è Display</div>
                                <div class="settings-nav-item">üîä Sound</div>
                                <div class="settings-nav-item">üîí Privacy</div>
                                <div class="settings-nav-item">‚è∞ Date & Time</div>
                                <div class="settings-nav-item">üë§ Account</div>
                                <div class="settings-nav-item">‚ÑπÔ∏è About</div>
                            </div>
                            <div class="settings-content">
                                <div class="settings-section">
                                    <h2 class="settings-title">Personalization</h2>
                                    <div class="settings-option">
                                        <div class="settings-option-info">
                                            <h4>Dark Mode</h4>
                                            <p>Use dark colors for windows and menus</p>
                                        </div>
                                        <div class="toggle ${this.settings.theme === 'dark' ? 'active' : ''}" onclick="this.classList.toggle('active')"></div>
                                    </div>
                                    <div class="settings-option">
                                        <div class="settings-option-info">
                                            <h4>Animations</h4>
                                            <p>Enable smooth transitions and effects</p>
                                        </div>
                                        <div class="toggle ${this.settings.animations ? 'active' : ''}" onclick="this.classList.toggle('active')"></div>
                                    </div>
                                    <div class="settings-option">
                                        <div class="settings-option-info">
                                            <h4>System Sounds</h4>
                                            <p>Play sounds for notifications and events</p>
                                        </div>
                                        <div class="toggle ${this.settings.sounds ? 'active' : ''}" onclick="this.classList.toggle('active')"></div>
                                    </div>
                                </div>
                                <div class="settings-section">
                                    <h2 class="settings-title">Account</h2>
                                    <div class="settings-option">
                                        <div class="settings-option-info">
                                            <h4>Username</h4>
                                            <p>${this.user.name}</p>
                                        </div>
                                        <button class="editor-btn" onclick="OS.changeUsername()">Change</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                });
            },

            changeUsername() {
                const name = prompt('Enter new username:', this.user.name);
                if (name) {
                    this.user.name = name;
                    this.saveData();
                    document.getElementById('start-username').textContent = name;
                    this.notify('Settings', 'Username changed successfully', '‚öôÔ∏è');
                }
            },

            openPaint() {
                this.createWindow({
                    title: 'Paint',
                    icon: 'üé®',
                    width: 800,
                    height: 600,
                    content: `
                        <div class="paint">
                            <div class="paint-toolbar">
                                <span>Color:</span>
                                <div class="paint-colors">
                                    <div class="paint-color active" style="background:#000" data-color="#000"></div>
                                    <div class="paint-color" style="background:#fff" data-color="#fff"></div>
                                    <div class="paint-color" style="background:#f00" data-color="#f00"></div>
                                    <div class="paint-color" style="background:#0f0" data-color="#0f0"></div>
                                    <div class="paint-color" style="background:#00f" data-color="#00f"></div>
                                    <div class="paint-color" style="background:#ff0" data-color="#ff0"></div>
                                    <div class="paint-color" style="background:#f0f" data-color="#f0f"></div>
                                    <div class="paint-color" style="background:#0ff" data-color="#0ff"></div>
                                </div>
                                <span>Size:</span>
                                <input type="range" min="1" max="50" value="5" id="paint-size">
                                <button class="editor-btn" onclick="OS.clearCanvas()">Clear</button>
                                <button class="editor-btn" onclick="OS.saveCanvas()">Save</button>
                            </div>
                            <canvas class="paint-canvas" id="paint-canvas"></canvas>
                        </div>
                    `,
                    onInit: (content) => {
                        const canvas = content.querySelector('#paint-canvas');
                        const ctx = canvas.getContext('2d');

                        const resize = () => {
                            canvas.width = canvas.offsetWidth;
                            canvas.height = canvas.offsetHeight;
                            ctx.fillStyle = 'white';
                            ctx.fillRect(0, 0, canvas.width, canvas.height);
                        };
                        resize();

                        let painting = false;
                        let color = '#000';
                        let size = 5;

                        canvas.onmousedown = () => painting = true;
                        canvas.onmouseup = () => painting = false;
                        canvas.onmouseleave = () => painting = false;

                        canvas.onmousemove = (e) => {
                            if (!painting) return;
                            const rect = canvas.getBoundingClientRect();
                            ctx.fillStyle = color;
                            ctx.beginPath();
                            ctx.arc(e.clientX - rect.left, e.clientY - rect.top, size / 2, 0, Math.PI * 2);
                            ctx.fill();
                        };

                        content.querySelectorAll('.paint-color').forEach(c => {
                            c.onclick = () => {
                                content.querySelectorAll('.paint-color').forEach(x => x.classList.remove('active'));
                                c.classList.add('active');
                                color = c.dataset.color;
                            };
                        });

                        content.querySelector('#paint-size').oninput = (e) => {
                            size = e.target.value;
                        };

                        this.paintCanvas = canvas;
                        this.paintCtx = ctx;
                    }
                });
            },

            clearCanvas() {
                if (this.paintCtx && this.paintCanvas) {
                    this.paintCtx.fillStyle = 'white';
                    this.paintCtx.fillRect(0, 0, this.paintCanvas.width, this.paintCanvas.height);
                }
            },

            saveCanvas() {
                if (this.paintCanvas) {
                    const link = document.createElement('a');
                    link.download = 'painting.png';
                    link.href = this.paintCanvas.toDataURL();
                    link.click();
                }
            },

            openCalendar() {
                const now = new Date();
                let currentMonth = now.getMonth();
                let currentYear = now.getFullYear();

                this.createWindow({
                    title: 'Calendar',
                    icon: 'üìÖ',
                    width: 400,
                    height: 450,
                    content: `<div class="calendar" id="calendar-content"></div>`,
                    onInit: (content) => {
                        const renderCalendar = () => {
                            const calendar = content.querySelector('#calendar-content');
                            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
                            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
                            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];

                            let html = `
                                <div class="calendar-header">
                                    <h2 class="calendar-title">${monthNames[currentMonth]} ${currentYear}</h2>
                                    <div class="calendar-nav">
                                        <button class="calendar-nav-btn" id="prev-month">‚Üê</button>
                                        <button class="calendar-nav-btn" id="next-month">‚Üí</button>
                                    </div>
                                </div>
                                <div class="calendar-grid">
                                    <div class="calendar-day-header">Sun</div>
                                    <div class="calendar-day-header">Mon</div>
                                    <div class="calendar-day-header">Tue</div>
                                    <div class="calendar-day-header">Wed</div>
                                    <div class="calendar-day-header">Thu</div>
                                    <div class="calendar-day-header">Fri</div>
                                    <div class="calendar-day-header">Sat</div>
                            `;

                            for (let i = 0; i < firstDay; i++) {
                                html += '<div class="calendar-day other-month"></div>';
                            }

                            for (let day = 1; day <= daysInMonth; day++) {
                                const isToday = day === now.getDate() && currentMonth === now.getMonth() && currentYear === now.getFullYear();
                                html += `<div class="calendar-day ${isToday ? 'today' : ''}">${day}</div>`;
                            }

                            html += '</div>';
                            calendar.innerHTML = html;

                            content.querySelector('#prev-month').onclick = () => {
                                currentMonth--;
                                if (currentMonth < 0) { currentMonth = 11; currentYear--; }
                                renderCalendar();
                            };
                            content.querySelector('#next-month').onclick = () => {
                                currentMonth++;
                                if (currentMonth > 11) { currentMonth = 0; currentYear++; }
                                renderCalendar();
                            };
                        };
                        renderCalendar();
                    }
                });
            },

            openNotes() {
                this.createWindow({
                    title: 'Notes',
                    icon: 'üìí',
                    width: 800,
                    height: 500,
                    content: `
                        <div class="notes">
                            <div class="notes-list">
                                <div class="notes-list-header">
                                    <span>Notes</span>
                                    <button class="editor-btn" onclick="OS.createNote()">+ New</button>
                                </div>
                                <div id="notes-list-items">
                                    <div class="note-item active">
                                        <div class="note-item-title">Welcome Note</div>
                                        <div class="note-item-preview">Welcome to InfiniteOS Notes...</div>
                                        <div class="note-item-date">Today</div>
                                    </div>
                                </div>
                            </div>
                            <div class="notes-editor">
                                <div class="notes-editor-title">
                                    <input type="text" value="Welcome Note" placeholder="Note title...">
                                </div>
                                <div class="notes-editor-content">
                                    <textarea placeholder="Start typing...">Welcome to InfiniteOS Notes!

This is a simple note-taking app. You can:
- Create new notes
- Edit existing notes
- Organize your thoughts

All notes are saved locally.</textarea>
                                </div>
                            </div>
                        </div>
                    `
                });
            },

            createNote() {
                const list = document.getElementById('notes-list-items');
                const item = document.createElement('div');
                item.className = 'note-item';
                item.innerHTML = `
                    <div class="note-item-title">New Note</div>
                    <div class="note-item-preview">Start typing...</div>
                    <div class="note-item-date">Just now</div>
                `;
                list.prepend(item);
            },

            openMusic() {
                this.createWindow({
                    title: 'Music',
                    icon: 'üéµ',
                    width: 400,
                    height: 500,
                    content: `
                        <div class="media-player">
                            <div class="media-cover">üéµ</div>
                            <div class="media-title">No Track Playing</div>
                            <div class="media-artist">Select a song to play</div>
                            <div class="media-progress">
                                <div class="media-progress-bar"></div>
                            </div>
                            <div class="media-times">
                                <span>0:00</span>
                                <span>0:00</span>
                            </div>
                            <div class="media-controls">
                                <button class="media-btn">‚èÆ</button>
                                <button class="media-btn play">‚ñ∂</button>
                                <button class="media-btn">‚è≠</button>
                            </div>
                        </div>
                    `
                });
            },

            openWeather() {
                this.createWindow({
                    title: 'Weather',
                    icon: 'üå§Ô∏è',
                    width: 400,
                    height: 350,
                    content: `
                        <div class="weather">
                            <div style="font-size:64px;margin-bottom:10px">‚òÄÔ∏è</div>
                            <div class="weather-temp">72¬∞</div>
                            <div class="weather-desc">Sunny</div>
                            <div class="weather-details">
                                <div class="weather-detail">
                                    <div class="weather-detail-value">65%</div>
                                    <div class="weather-detail-label">Humidity</div>
                                </div>
                                <div class="weather-detail">
                                    <div class="weather-detail-value">12 mph</div>
                                    <div class="weather-detail-label">Wind</div>
                                </div>
                                <div class="weather-detail">
                                    <div class="weather-detail-value">UV 6</div>
                                    <div class="weather-detail-label">UV Index</div>
                                </div>
                            </div>
                        </div>
                    `
                });
            },

            openTaskManager() {
                this.createWindow({
                    title: 'Task Manager',
                    icon: 'üìä',
                    width: 700,
                    height: 500,
                    content: `
                        <div class="task-manager">
                            <div class="task-tabs">
                                <div class="task-tab active">Processes</div>
                                <div class="task-tab">Performance</div>
                            </div>
                            <table class="task-table">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Status</th>
                                        <th>CPU</th>
                                        <th>Memory</th>
                                    </tr>
                                </thead>
                                <tbody id="task-list"></tbody>
                            </table>
                        </div>
                    `,
                    onInit: (content) => {
                        const list = content.querySelector('#task-list');
                        this.windows.forEach(win => {
                            const tr = document.createElement('tr');
                            tr.innerHTML = `
                                <td>${win.icon} ${win.title}</td>
                                <td>Running</td>
                                <td>${Math.floor(Math.random() * 10)}%</td>
                                <td>${Math.floor(Math.random() * 100)} MB</td>
                            `;
                            list.appendChild(tr);
                        });
                    }
                });
            },

            openGames() {
                this.createWindow({
                    title: 'Games',
                    icon: 'üéÆ',
                    width: 600,
                    height: 500,
                    content: `
                        <div class="games-hub">
                            <h2 style="margin-bottom:20px">Games</h2>
                            <div class="games-grid">
                                <div class="game-card" onclick="OS.playGame('snake')">
                                    <div class="game-card-cover">üêç</div>
                                    <div class="game-card-info">
                                        <div class="game-card-title">Snake</div>
                                        <div class="game-card-genre">Arcade</div>
                                    </div>
                                </div>
                                <div class="game-card" onclick="OS.playGame('2048')">
                                    <div class="game-card-cover">üî¢</div>
                                    <div class="game-card-info">
                                        <div class="game-card-title">2048</div>
                                        <div class="game-card-genre">Puzzle</div>
                                    </div>
                                </div>
                                <div class="game-card" onclick="OS.playGame('memory')">
                                    <div class="game-card-cover">üÉè</div>
                                    <div class="game-card-info">
                                        <div class="game-card-title">Memory</div>
                                        <div class="game-card-genre">Card Game</div>
                                    </div>
                                </div>
                                <div class="game-card" onclick="OS.playGame('minesweeper')">
                                    <div class="game-card-cover">üí£</div>
                                    <div class="game-card-info">
                                        <div class="game-card-title">Minesweeper</div>
                                        <div class="game-card-genre">Puzzle</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `
                });
            },

            playGame(game) {
                this.notify('Coming Soon', `${game} will be available soon!`, 'üéÆ');
            },

            openAbout() {
                this.createWindow({
                    title: 'About InfiniteOS',
                    icon: '‚ÑπÔ∏è',
                    width: 500,
                    height: 450,
                    content: `
                        <div class="about">
                            <div class="about-logo">‚ôæÔ∏è</div>
                            <h1 class="about-title">InfiniteOS</h1>
                            <p class="about-version">Version ${this.version}</p>
                            <div class="about-info">
                                <div class="about-row">
                                    <span>Platform</span>
                                    <span>Browser (Local-First)</span>
                                </div>
                                <div class="about-row">
                                    <span>Engine</span>
                                    <span>JavaScript ES2024</span>
                                </div>
                                <div class="about-row">
                                    <span>Storage</span>
                                    <span>localStorage</span>
                                </div>
                                <div class="about-row">
                                    <span>Recursion Depth</span>
                                    <span>${this.settings.recursionDepth}</span>
                                </div>
                                <div class="about-row">
                                    <span>Windows Open</span>
                                    <span>${this.windows.length}</span>
                                </div>
                            </div>
                            <p style="margin-top:30px;color:var(--text-dim);font-size:12px">
                                A fully functional operating system running entirely in your browser.
                                No external dependencies. Infinitely recursive.
                            </p>
                        </div>
                    `
                });
            },

            openRecursiveOS() {
                const depth = this.settings.recursionDepth + 1;

                this.createWindow({
                    title: `InfiniteOS (Depth: ${depth})`,
                    icon: '‚ôæÔ∏è',
                    width: 900,
                    height: 650,
                    content: `<iframe class="recursive-os" src="${location.href}#depth=${depth}" sandbox="allow-same-origin allow-scripts allow-forms allow-popups"></iframe>`,
                    onInit: (content) => {
                        const iframe = content.querySelector('iframe');
                        iframe.onload = () => {
                            try {
                                iframe.contentWindow.OS.settings.recursionDepth = depth;
                            } catch (e) {}
                        };
                    }
                });

                this.notify('Inception', `Entering recursion depth ${depth}...`, '‚ôæÔ∏è');
            },

            openAppStore() {
                this.createWindow({
                    title: 'App Store',
                    icon: 'üè™',
                    width: 800,
                    height: 600,
                    content: `
                        <div class="app-store">
                            <div class="app-store-header">
                                <h1 class="app-store-title">App Store</h1>
                                <input type="text" class="app-store-search" placeholder="Search apps...">
                            </div>
                            <div class="app-store-grid">
                                <div class="store-app-card">
                                    <div class="store-app-icon">üìä</div>
                                    <div class="store-app-name">Analytics Pro</div>
                                    <div class="store-app-desc">Advanced data visualization</div>
                                    <button class="store-app-btn">Install</button>
                                </div>
                                <div class="store-app-card">
                                    <div class="store-app-icon">üìß</div>
                                    <div class="store-app-name">Mail Client</div>
                                    <div class="store-app-desc">Manage your emails</div>
                                    <button class="store-app-btn">Install</button>
                                </div>
                                <div class="store-app-card">
                                    <div class="store-app-icon">üìπ</div>
                                    <div class="store-app-name">Video Editor</div>
                                    <div class="store-app-desc">Edit videos in browser</div>
                                    <button class="store-app-btn">Install</button>
                                </div>
                                <div class="store-app-card">
                                    <div class="store-app-icon">üé§</div>
                                    <div class="store-app-name">Voice Recorder</div>
                                    <div class="store-app-desc">Record audio clips</div>
                                    <button class="store-app-btn">Install</button>
                                </div>
                                <div class="store-app-card">
                                    <div class="store-app-icon">üìê</div>
                                    <div class="store-app-name">3D Modeler</div>
                                    <div class="store-app-desc">Create 3D models</div>
                                    <button class="store-app-btn">Install</button>
                                </div>
                                <div class="store-app-card">
                                    <div class="store-app-icon">üîê</div>
                                    <div class="store-app-name">Password Vault</div>
                                    <div class="store-app-desc">Secure password storage</div>
                                    <button class="store-app-btn">Install</button>
                                </div>
                            </div>
                        </div>
                    `
                });
            },

            // Notifications
            notify(title, message, icon = 'üîî') {
                const container = document.getElementById('notifications');
                const notification = document.createElement('div');
                notification.className = 'notification';
                notification.innerHTML = `
                    <div class="notification-header">
                        <span>${icon}</span>
                        <span class="notification-title">${title}</span>
                    </div>
                    <div class="notification-body">${message}</div>
                `;
                container.appendChild(notification);

                setTimeout(() => {
                    notification.style.opacity = '0';
                    setTimeout(() => notification.remove(), 300);
                }, 4000);
            },

            // Power functions
            sleep() {
                document.getElementById('desktop').style.display = 'none';
                document.getElementById('taskbar').style.display = 'none';
                document.getElementById('login-screen').style.display = 'flex';
            },

            restart() {
                location.reload();
            },

            shutdown() {
                document.body.innerHTML = '<div style="display:flex;height:100vh;align-items:center;justify-content:center;background:#000;color:#fff;font-size:24px">Goodbye</div>';
                setTimeout(() => {
                    document.body.innerHTML = '';
                    document.body.style.background = '#000';
                }, 2000);
            },

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        };

        // Event Listeners
        document.getElementById('start-btn').onclick = () => OS.toggleStartMenu();
        document.getElementById('login-btn').onclick = () => OS.login();
        document.getElementById('login-password').onkeydown = (e) => {
            if (e.key === 'Enter') OS.login();
        };

        document.addEventListener('click', (e) => {
            if (OS.isStartMenuOpen && !e.target.closest('#start-menu') && !e.target.closest('#start-btn')) {
                OS.toggleStartMenu(false);
            }
        });

        document.getElementById('desktop').oncontextmenu = (e) => {
            e.preventDefault();
            const menu = document.getElementById('context-menu');
            menu.innerHTML = `
                <div class="context-item" onclick="OS.openApp('file-explorer')">üìÅ Open File Explorer</div>
                <div class="context-item" onclick="OS.openApp('terminal')">üíª Open Terminal</div>
                <div class="context-divider"></div>
                <div class="context-item" onclick="OS.createFolder()">üìÅ New Folder</div>
                <div class="context-item" onclick="OS.createFile()">üìÑ New File</div>
                <div class="context-divider"></div>
                <div class="context-item" onclick="OS.openApp('settings')">‚öôÔ∏è Settings</div>
                <div class="context-item" onclick="OS.openRecursiveOS()">‚ôæÔ∏è Open InfiniteOS</div>
            `;
            menu.style.left = e.clientX + 'px';
            menu.style.top = e.clientY + 'px';
            menu.style.display = 'block';
        };

        document.addEventListener('click', (e) => {
            if (!e.target.closest('#context-menu')) {
                document.getElementById('context-menu').style.display = 'none';
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                OS.toggleStartMenu(false);
                document.getElementById('context-menu').style.display = 'none';
            }
        });

        // Check for recursion depth in URL
        const hash = location.hash;
        if (hash.includes('depth=')) {
            const depth = parseInt(hash.split('depth=')[1]);
            OS.settings.recursionDepth = depth;
        }

        // Boot the OS
        OS.boot();
    </script>
</body>
</html>
