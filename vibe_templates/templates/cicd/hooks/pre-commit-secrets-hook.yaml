# Secret Detection Pre-commit Hook Template
# Prevent committing secrets and sensitive data

# Add these hooks to your .pre-commit-config.yaml

# Using detect-secrets
- repo: https://github.com/Yelp/detect-secrets
  rev: v1.4.0  # Update to latest version
  hooks:
    - id: detect-secrets
      name: Detect secrets
      args: ['--baseline', '.secrets.baseline']
      exclude: package.lock.json

# Using gitleaks (alternative)
- repo: https://github.com/zricethezav/gitleaks
  rev: v8.18.0  # Update to latest version
  hooks:
    - id: gitleaks
      name: Detect secrets with gitleaks

# Local secret scanning
- repo: local
  hooks:
    - id: check-secrets
      name: Check for secrets
      entry: bash -c 'grep -r -E "(api[_-]?key|secret|token|password|passwd|pwd|auth|credential)" --include="*.py" --include="*.yml" --include="*.yaml" --include="*.json" --include="*.env" . || true'
      language: system
      pass_filenames: false
      
    - id: check-aws-credentials
      name: Check for AWS credentials
      entry: bash -c '! grep -r -E "AKIA[0-9A-Z]{16}" .'
      language: system
      pass_filenames: false

# Creating a baseline for detect-secrets
# Run this command to create initial baseline:
# detect-secrets scan --baseline .secrets.baseline

# Auditing the baseline:
# detect-secrets audit .secrets.baseline

# .gitignore additions
# .secrets.baseline
# *.key
# *.pem
# .env
# .env.*

# Customization Notes:
# - Choose between detect-secrets or gitleaks
# - Create and maintain .secrets.baseline file
# - Add project-specific patterns to check
# - Configure exclusions for false positives
# - Regular audit of baseline file