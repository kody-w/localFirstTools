<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Living Strategic Document</title>
    <style>
        /* ===== BASE RESET ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* ===== DYNAMIC CSS VARIABLES ===== */
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --primary-light: #60a5fa;
            --secondary: #8b5cf6;
            --secondary-dark: #7c3aed;
            --success: #10b981;
            --success-dark: #059669;
            --warning: #f59e0b;
            --warning-dark: #d97706;
            --danger: #ef4444;
            --danger-dark: #dc2626;
            --info: #06b6d4;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            --font-mono: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
            --shadow-xl: 0 20px 25px rgba(0,0,0,0.15);
            --transition-fast: 150ms ease;
            --transition-base: 250ms ease;
            --transition-slow: 350ms ease;
        }

        /* ===== BODY & LAYOUT ===== */
        body {
            font-family: var(--font-sans);
            background: var(--gray-50);
            color: var(--gray-800);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .app-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* ===== DYNAMIC HEADER ===== */
        .dynamic-header {
            padding: 3rem 2rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }

        .dynamic-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.1;
            background-image:
                repeating-linear-gradient(45deg, transparent, transparent 10px, currentColor 10px, currentColor 11px);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .header-title {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .header-subtitle {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .header-input {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            padding: 0.75rem 1rem;
            font-size: 1.5rem;
            border-radius: var(--radius-md);
            margin-top: 1rem;
            width: 100%;
            max-width: 400px;
            transition: all var(--transition-base);
        }

        .header-input:focus {
            outline: none;
            background: rgba(255,255,255,0.3);
            border-color: rgba(255,255,255,0.5);
        }

        .header-input::placeholder {
            opacity: 0.7;
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 999px;
            font-size: 0.875rem;
            font-weight: 500;
            margin-top: 1rem;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: currentColor;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* ===== NAVIGATION ===== */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem 2rem;
            flex: 1;
        }

        .nav-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            background: white;
            padding: 1rem;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
        }

        .nav-tab {
            padding: 0.75rem 1.5rem;
            border: none;
            background: var(--gray-100);
            color: var(--gray-700);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all var(--transition-base);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-tab:hover {
            background: var(--gray-200);
            transform: translateY(-1px);
        }

        .nav-tab.active {
            color: white;
            box-shadow: var(--shadow-md);
        }

        /* ===== SECTIONS ===== */
        .section {
            display: none;
            animation: fadeIn var(--transition-base);
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-header {
            color: var(--gray-900);
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 3px solid var(--gray-200);
            font-size: 1.75rem;
            font-weight: 700;
        }

        /* ===== DYNAMIC COMPONENTS ===== */
        .component-wrapper {
            margin-bottom: 2rem;
        }

        .card {
            background: white;
            border-radius: var(--radius-lg);
            padding: 2rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--gray-200);
            transition: all var(--transition-base);
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            color: var(--gray-800);
            margin-bottom: 1.5rem;
            font-size: 1.25rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .card-icon {
            font-size: 1.5rem;
        }

        /* ===== FORM ELEMENTS ===== */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--gray-700);
            font-size: 0.95rem;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--gray-300);
            border-radius: var(--radius-md);
            font-size: 1rem;
            font-family: inherit;
            transition: all var(--transition-base);
            background: white;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        /* ===== METRICS & DISPLAYS ===== */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .metric-card {
            padding: 1.5rem;
            border-radius: var(--radius-lg);
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
            position: relative;
        }

        .metric-label {
            opacity: 0.9;
            font-size: 0.9rem;
            position: relative;
        }

        .metric-change {
            font-size: 0.85rem;
            margin-top: 0.5rem;
            opacity: 0.8;
            position: relative;
        }

        /* ===== CHARTS ===== */
        .chart-container {
            background: var(--gray-50);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-top: 1rem;
            min-height: 300px;
            position: relative;
        }

        .chart-title {
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--gray-700);
        }

        .bar-chart {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 250px;
            padding: 2rem 1rem 3rem;
            gap: 0.5rem;
        }

        .bar-group {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .bar {
            width: 100%;
            max-width: 60px;
            border-radius: var(--radius-sm) var(--radius-sm) 0 0;
            transition: all var(--transition-base);
            position: relative;
            cursor: pointer;
        }

        .bar:hover {
            opacity: 0.8;
            transform: translateY(-3px);
        }

        .bar-value {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--gray-800);
            white-space: nowrap;
        }

        .bar-label {
            margin-top: 0.5rem;
            font-size: 0.8rem;
            color: var(--gray-600);
            text-align: center;
        }

        .line-chart {
            position: relative;
            height: 250px;
            padding: 2rem 1rem;
        }

        .line-chart svg {
            width: 100%;
            height: 100%;
        }

        /* ===== PROGRESS & TIMELINE ===== */
        .progress-tracker {
            display: flex;
            justify-content: space-between;
            margin-bottom: 3rem;
            position: relative;
            padding: 0 1rem;
        }

        .progress-tracker::before {
            content: '';
            position: absolute;
            top: 24px;
            left: 10%;
            right: 10%;
            height: 4px;
            background: var(--gray-200);
            z-index: 0;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 1;
            flex: 1;
        }

        .progress-circle {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: var(--gray-200);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--gray-600);
            margin-bottom: 0.75rem;
            transition: all var(--transition-base);
            box-shadow: 0 0 0 4px var(--gray-50);
        }

        .progress-step.completed .progress-circle {
            background: var(--success);
            color: white;
        }

        .progress-step.current .progress-circle {
            background: var(--primary);
            color: white;
            animation: pulseRing 2s ease-in-out infinite;
        }

        @keyframes pulseRing {
            0%, 100% {
                box-shadow: 0 0 0 4px var(--gray-50), 0 0 0 8px rgba(37, 99, 235, 0.3);
            }
            50% {
                box-shadow: 0 0 0 4px var(--gray-50), 0 0 0 12px rgba(37, 99, 235, 0);
            }
        }

        .progress-label {
            font-size: 0.85rem;
            color: var(--gray-600);
            text-align: center;
        }

        .timeline {
            position: relative;
            padding-left: 3rem;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 12px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--gray-200);
        }

        .timeline-item {
            position: relative;
            padding-bottom: 2rem;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -30px;
            top: 6px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--gray-300);
            border: 3px solid white;
            box-shadow: var(--shadow-md);
        }

        .timeline-item.completed::before {
            background: var(--success);
        }

        .timeline-item.current::before {
            background: var(--primary);
            animation: pulse 2s ease-in-out infinite;
        }

        .timeline-content {
            background: white;
            padding: 1.25rem;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
        }

        .timeline-date {
            font-size: 0.85rem;
            color: var(--gray-600);
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .timeline-title {
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 0.5rem;
        }

        .timeline-description {
            color: var(--gray-600);
            font-size: 0.95rem;
        }

        /* ===== SLIDERS ===== */
        .slider-group {
            margin-bottom: 1.5rem;
        }

        .slider-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
        }

        .slider-label {
            font-weight: 500;
            color: var(--gray-700);
        }

        .slider-value {
            font-weight: 600;
            color: var(--primary);
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: var(--gray-200);
            outline: none;
            appearance: none;
            -webkit-appearance: none;
            transition: all var(--transition-base);
        }

        .slider:hover {
            background: var(--gray-300);
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-base);
        }

        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: var(--shadow-lg);
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            border: none;
            box-shadow: var(--shadow-md);
        }

        /* ===== TABLES ===== */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            background: white;
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .data-table th,
        .data-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--gray-200);
        }

        .data-table th {
            background: var(--gray-50);
            font-weight: 600;
            color: var(--gray-700);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .data-table tr:hover {
            background: var(--gray-50);
        }

        .data-table td {
            color: var(--gray-600);
        }

        /* ===== BUTTONS ===== */
        .button {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--radius-md);
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-base);
            font-size: 0.95rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .button:active {
            transform: translateY(0);
        }

        .button-primary {
            background: var(--primary);
            color: white;
        }

        .button-primary:hover {
            background: var(--primary-dark);
        }

        .button-secondary {
            background: var(--secondary);
            color: white;
        }

        .button-success {
            background: var(--success);
            color: white;
        }

        .button-danger {
            background: var(--danger);
            color: white;
        }

        .button-outline {
            background: white;
            border: 2px solid var(--gray-300);
            color: var(--gray-700);
        }

        .button-outline:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .action-bar {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
            padding: 1.5rem;
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
        }

        /* ===== SCENARIO CARDS ===== */
        .scenario-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .scenario-card {
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            border: 2px solid;
            transition: all var(--transition-base);
        }

        .scenario-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
        }

        .scenario-header {
            padding: 1.25rem;
            font-weight: 600;
            text-align: center;
            font-size: 1.1rem;
        }

        .scenario-body {
            padding: 1.5rem;
            background: white;
        }

        .scenario-metric {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--gray-100);
            align-items: center;
        }

        .scenario-metric:last-child {
            border-bottom: none;
        }

        .scenario-metric-label {
            color: var(--gray-600);
            font-size: 0.9rem;
        }

        .scenario-metric-value {
            font-weight: 600;
            color: var(--gray-800);
            font-size: 1.05rem;
        }

        /* ===== DECISION TREE ===== */
        .decision-tree {
            background: var(--gray-50);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
        }

        .decision-node {
            background: white;
            border: 2px solid var(--gray-300);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: all var(--transition-base);
        }

        .decision-node.current {
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2);
        }

        .decision-node.completed {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.05);
        }

        .decision-question {
            margin-bottom: 1rem;
            color: var(--gray-900);
            font-weight: 600;
            font-size: 1.05rem;
        }

        .decision-options {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .decision-option {
            flex: 1;
            min-width: 150px;
            padding: 1rem;
            border: 2px solid var(--gray-300);
            background: white;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: 500;
            transition: all var(--transition-base);
            text-align: center;
        }

        .decision-option:hover {
            border-color: var(--primary);
            background: var(--gray-50);
            transform: translateY(-2px);
        }

        .decision-option.selected {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
        }

        .decision-result {
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-top: 1rem;
            color: white;
        }

        .decision-result h4 {
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        /* ===== RISK MATRIX ===== */
        .risk-matrix {
            display: grid;
            grid-template-columns: auto repeat(5, 1fr);
            gap: 2px;
            background: var(--gray-200);
            padding: 2px;
            border-radius: var(--radius-md);
            overflow: hidden;
        }

        .risk-cell {
            padding: 1rem;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-base);
            position: relative;
        }

        .risk-cell:hover {
            transform: scale(1.05);
            z-index: 10;
            box-shadow: var(--shadow-lg);
        }

        .risk-label {
            background: white;
            padding: 0.75rem;
            font-weight: 600;
            font-size: 0.85rem;
        }

        /* ===== BADGES & TAGS ===== */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .tag {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-md);
            font-size: 0.9rem;
            font-weight: 500;
            margin: 0.25rem;
        }

        /* ===== LOADING & ANIMATIONS ===== */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--gray-200);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .skeleton {
            background: linear-gradient(90deg, var(--gray-200) 25%, var(--gray-300) 50%, var(--gray-200) 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s ease-in-out infinite;
            border-radius: var(--radius-md);
        }

        @keyframes shimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .header-title {
                font-size: 1.75rem;
            }

            .metrics-grid {
                grid-template-columns: 1fr;
            }

            .scenario-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .nav-tabs {
                overflow-x: auto;
                flex-wrap: nowrap;
            }

            .action-bar {
                flex-direction: column;
            }

            .button {
                width: 100%;
                justify-content: center;
            }
        }

        /* ===== UTILITIES ===== */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .gap-2 { gap: 1rem; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }

        /* ===== PRINT STYLES ===== */
        @media print {
            .nav-tabs,
            .action-bar,
            .button {
                display: none !important;
            }

            .section {
                display: block !important;
                page-break-inside: avoid;
            }

            .card {
                box-shadow: none;
                border: 1px solid var(--gray-300);
            }
        }
    </style>
</head>
<body>
    <div class="app-container" id="app">
        <div id="dynamicContent">
            <!-- Content will be dynamically generated here -->
        </div>
    </div>

    <!-- Hidden file input for JSON import -->
    <input type="file" id="importFile" style="display: none;" accept=".json">

    <script>
        // ===== DYNAMIC DOCUMENT ENGINE =====
        class DynamicDocument {
            constructor(schema) {
                this.schema = schema || this.getDefaultSchema();
                this.data = {};
                this.state = {};
                this.listeners = [];
                this.init();
            }

            init() {
                this.loadData();
                this.applyTheme();
                this.render();
                this.attachEventListeners();
                this.startAutoSave();
            }

            getDefaultSchema() {
                return {
                    meta: {
                        title: "Living Strategic Document",
                        subtitle: "An interactive, computing document for strategic planning and decision-making",
                        version: "1.0.0"
                    },
                    theme: {
                        primary: "#2563eb",
                        secondary: "#8b5cf6",
                        success: "#10b981",
                        warning: "#f59e0b",
                        danger: "#ef4444",
                        headerGradient: "linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)",
                        headerTextColor: "#ffffff"
                    },
                    header: {
                        enabled: true,
                        showInput: true,
                        inputPlaceholder: "Enter your company/project name",
                        showStatus: true
                    },
                    sections: [
                        {
                            id: "overview",
                            title: "Strategic Overview",
                            icon: "üìã",
                            active: true,
                            components: [
                                {
                                    type: "progress",
                                    steps: [
                                        { id: 1, label: "Define", status: "completed" },
                                        { id: 2, label: "Plan", status: "current" },
                                        { id: 3, label: "Execute", status: "pending" },
                                        { id: 4, label: "Scale", status: "pending" }
                                    ]
                                },
                                {
                                    type: "card",
                                    icon: "üéØ",
                                    title: "Mission Statement",
                                    content: [
                                        {
                                            type: "textarea",
                                            id: "mission",
                                            placeholder: "What problem are you solving and for whom?",
                                            rows: 3
                                        }
                                    ]
                                },
                                {
                                    type: "card",
                                    icon: "üìä",
                                    title: "Key Metrics Dashboard",
                                    content: [
                                        {
                                            type: "metrics",
                                            metrics: [
                                                { id: "runway", label: "Months Runway", value: "--", color: "primary" },
                                                { id: "mrr", label: "Monthly Revenue", value: "$0", color: "success" },
                                                { id: "growth", label: "Growth Rate", value: "0%", color: "info" },
                                                { id: "breakeven", label: "Months to Break-even", value: "--", color: "warning" }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    type: "card",
                                    icon: "üé™",
                                    title: "Value Proposition Canvas",
                                    content: [
                                        {
                                            type: "grid",
                                            columns: 2,
                                            items: [
                                                { type: "input", id: "segments", label: "Customer Segments", placeholder: "Who are your target customers?" },
                                                { type: "input", id: "valueProps", label: "Value Propositions", placeholder: "What value do you deliver?" },
                                                { type: "input", id: "channels", label: "Channels", placeholder: "How do you reach customers?" },
                                                { type: "input", id: "revenue", label: "Revenue Streams", placeholder: "How do you make money?" }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            id: "financials",
                            title: "Financial Calculator",
                            icon: "üí∞",
                            components: [
                                {
                                    type: "card",
                                    icon: "üíµ",
                                    title: "Runway Calculator",
                                    content: [
                                        {
                                            type: "grid",
                                            columns: 3,
                                            items: [
                                                { type: "number", id: "currentCash", label: "Current Cash ($)", value: 100000 },
                                                { type: "number", id: "burnRate", label: "Monthly Burn Rate ($)", value: 15000 },
                                                { type: "number", id: "monthlyRevenue", label: "Monthly Revenue ($)", value: 5000 }
                                            ]
                                        },
                                        {
                                            type: "metrics",
                                            metrics: [
                                                { id: "netBurn", label: "Net Monthly Burn", value: "$10,000", color: "danger", computed: true },
                                                { id: "runwayMonths", label: "Months of Runway", value: "10", color: "warning", computed: true },
                                                { id: "runwayDate", label: "Runway End Date", value: "--", color: "primary", computed: true }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    type: "card",
                                    icon: "üìà",
                                    title: "Growth Projections",
                                    content: [
                                        {
                                            type: "grid",
                                            columns: 3,
                                            items: [
                                                { type: "number", id: "startingMRR", label: "Starting MRR ($)", value: 5000 },
                                                { type: "number", id: "growthRate", label: "Monthly Growth Rate (%)", value: 10 },
                                                { type: "number", id: "targetMRR", label: "Target MRR ($)", value: 100000 }
                                            ]
                                        },
                                        {
                                            type: "chart",
                                            chartType: "bar",
                                            id: "growthChart",
                                            computed: true
                                        },
                                        {
                                            type: "metrics",
                                            metrics: [
                                                { id: "monthsToTarget", label: "Months to Target", value: "--", color: "primary", computed: true },
                                                { id: "year1MRR", label: "12-Month MRR", value: "--", color: "success", computed: true },
                                                { id: "year1ARR", label: "12-Month ARR", value: "--", color: "info", computed: true }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            id: "scenarios",
                            title: "Scenario Modeling",
                            icon: "üéØ",
                            components: [
                                {
                                    type: "card",
                                    icon: "üéöÔ∏è",
                                    title: "Adjust Variables",
                                    content: [
                                        {
                                            type: "slider",
                                            id: "acquisitionRate",
                                            label: "Customer Acquisition Rate",
                                            min: 10,
                                            max: 200,
                                            value: 50,
                                            unit: "customers/month"
                                        },
                                        {
                                            type: "slider",
                                            id: "churnRate",
                                            label: "Churn Rate",
                                            min: 1,
                                            max: 20,
                                            value: 5,
                                            unit: "%"
                                        },
                                        {
                                            type: "slider",
                                            id: "arpu",
                                            label: "Average Revenue Per User (ARPU)",
                                            min: 10,
                                            max: 500,
                                            value: 100,
                                            unit: "$"
                                        },
                                        {
                                            type: "slider",
                                            id: "cac",
                                            label: "Customer Acquisition Cost (CAC)",
                                            min: 10,
                                            max: 300,
                                            value: 50,
                                            unit: "$"
                                        }
                                    ]
                                },
                                {
                                    type: "scenarios",
                                    scenarios: [
                                        { id: "pessimistic", label: "üò∞ Pessimistic (-30%)", color: "#ef4444", factor: 0.7 },
                                        { id: "realistic", label: "üéØ Realistic (Base)", color: "#2563eb", factor: 1.0 },
                                        { id: "optimistic", label: "üöÄ Optimistic (+30%)", color: "#10b981", factor: 1.3 }
                                    ]
                                }
                            ]
                        },
                        {
                            id: "roadmap",
                            title: "Strategic Roadmap",
                            icon: "üó∫Ô∏è",
                            components: [
                                {
                                    type: "card",
                                    icon: "üìÖ",
                                    title: "Milestone Timeline",
                                    content: [
                                        {
                                            type: "timeline",
                                            items: [
                                                {
                                                    date: "Q1 2024",
                                                    title: "MVP Launch",
                                                    description: "Initial product release with core features",
                                                    status: "completed"
                                                },
                                                {
                                                    date: "Q2 2024",
                                                    title: "Product-Market Fit",
                                                    description: "Achieve 100 paying customers with strong retention",
                                                    status: "current"
                                                },
                                                {
                                                    date: "Q3 2024",
                                                    title: "Scale Operations",
                                                    description: "Hire key team members and establish processes",
                                                    status: "pending"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            id: "risks",
                            title: "Risk Analysis",
                            icon: "‚ö†Ô∏è",
                            components: [
                                {
                                    type: "card",
                                    icon: "üé≤",
                                    title: "Risk Register",
                                    content: [
                                        {
                                            type: "html",
                                            html: "<p style='color: var(--gray-600); margin-bottom: 1rem;'>Add and track key risks to your strategy</p>"
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    actions: [
                        { id: "export-html", label: "üìÑ Export as HTML", style: "primary", action: "exportHTML" },
                        { id: "export-json", label: "üíæ Export Data (JSON)", style: "outline", action: "exportJSON" },
                        { id: "import-json", label: "üì• Import Data", style: "outline", action: "importJSON" },
                        { id: "print", label: "üñ®Ô∏è Print Document", style: "outline", action: "print" }
                    ]
                };
            }

            applyTheme() {
                const theme = this.schema.theme || {};
                const root = document.documentElement;

                if (theme.primary) root.style.setProperty('--primary', theme.primary);
                if (theme.secondary) root.style.setProperty('--secondary', theme.secondary);
                if (theme.success) root.style.setProperty('--success', theme.success);
                if (theme.warning) root.style.setProperty('--warning', theme.warning);
                if (theme.danger) root.style.setProperty('--danger', theme.danger);
            }

            render() {
                const app = document.getElementById('dynamicContent');
                app.innerHTML = '';

                // Render header
                if (this.schema.header && this.schema.header.enabled) {
                    app.appendChild(this.renderHeader());
                }

                // Render main container
                const container = document.createElement('div');
                container.className = 'container';

                // Render navigation
                container.appendChild(this.renderNavigation());

                // Render sections
                this.schema.sections.forEach(section => {
                    container.appendChild(this.renderSection(section));
                });

                // Render actions
                if (this.schema.actions && this.schema.actions.length > 0) {
                    container.appendChild(this.renderActions());
                }

                app.appendChild(container);
            }

            renderHeader() {
                const header = document.createElement('div');
                header.className = 'dynamic-header';
                header.style.background = this.schema.theme.headerGradient;
                header.style.color = this.schema.theme.headerTextColor;

                const content = document.createElement('div');
                content.className = 'header-content';

                const title = document.createElement('h1');
                title.className = 'header-title';
                title.textContent = this.schema.meta.title;
                content.appendChild(title);

                const subtitle = document.createElement('p');
                subtitle.className = 'header-subtitle';
                subtitle.textContent = this.schema.meta.subtitle;
                content.appendChild(subtitle);

                if (this.schema.header.showInput) {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.className = 'header-input';
                    input.placeholder = this.schema.header.inputPlaceholder;
                    input.style.color = this.schema.theme.headerTextColor;
                    input.value = this.data.companyName || '';
                    input.addEventListener('input', (e) => {
                        this.data.companyName = e.target.value;
                        this.saveData();
                    });
                    content.appendChild(input);
                }

                if (this.schema.header.showStatus) {
                    const status = document.createElement('div');
                    status.className = 'status-badge';
                    status.style.background = 'rgba(255,255,255,0.2)';
                    status.style.color = this.schema.theme.headerTextColor;
                    status.innerHTML = '<span class="status-dot"></span><span id="statusText">Saved just now</span>';
                    content.appendChild(status);
                }

                header.appendChild(content);
                return header;
            }

            renderNavigation() {
                const nav = document.createElement('nav');
                nav.className = 'nav-tabs';

                this.schema.sections.forEach(section => {
                    const tab = document.createElement('button');
                    tab.className = 'nav-tab' + (section.active ? ' active' : '');
                    tab.style.setProperty('--tab-color', this.schema.theme.primary);
                    if (tab.classList.contains('active')) {
                        tab.style.background = this.schema.theme.primary;
                    }
                    tab.innerHTML = `${section.icon} ${section.title}`;
                    tab.addEventListener('click', () => this.showSection(section.id));
                    nav.appendChild(tab);
                });

                return nav;
            }

            renderSection(section) {
                const sectionEl = document.createElement('section');
                sectionEl.id = section.id;
                sectionEl.className = 'section' + (section.active ? ' active' : '');

                const header = document.createElement('h2');
                header.className = 'section-header';
                header.textContent = section.title;
                sectionEl.appendChild(header);

                section.components.forEach(component => {
                    sectionEl.appendChild(this.renderComponent(component));
                });

                return sectionEl;
            }

            renderComponent(component) {
                const wrapper = document.createElement('div');
                wrapper.className = 'component-wrapper';

                switch (component.type) {
                    case 'card':
                        return this.renderCard(component);
                    case 'progress':
                        return this.renderProgress(component);
                    case 'metrics':
                        return this.renderMetrics(component);
                    case 'chart':
                        return this.renderChart(component);
                    case 'scenarios':
                        return this.renderScenarios(component);
                    case 'timeline':
                        return this.renderTimeline(component);
                    default:
                        return wrapper;
                }
            }

            renderCard(component) {
                const card = document.createElement('div');
                card.className = 'card';

                if (component.title) {
                    const header = document.createElement('div');
                    header.className = 'card-header';
                    if (component.icon) {
                        header.innerHTML = `<span class="card-icon">${component.icon}</span><span>${component.title}</span>`;
                    } else {
                        header.textContent = component.title;
                    }
                    card.appendChild(header);
                }

                if (component.content) {
                    component.content.forEach(item => {
                        card.appendChild(this.renderContent(item));
                    });
                }

                return card;
            }

            renderContent(item) {
                const container = document.createElement('div');

                switch (item.type) {
                    case 'textarea':
                        return this.renderTextarea(item);
                    case 'input':
                        return this.renderInput(item);
                    case 'number':
                        return this.renderNumber(item);
                    case 'grid':
                        return this.renderGrid(item);
                    case 'metrics':
                        return this.renderMetrics(item);
                    case 'chart':
                        return this.renderChart(item);
                    case 'slider':
                        return this.renderSlider(item);
                    case 'timeline':
                        return this.renderTimeline(item);
                    case 'html':
                        container.innerHTML = item.html;
                        return container;
                    default:
                        return container;
                }
            }

            renderTextarea(item) {
                const group = document.createElement('div');
                group.className = 'form-group';

                if (item.label) {
                    const label = document.createElement('label');
                    label.className = 'form-label';
                    label.textContent = item.label;
                    group.appendChild(label);
                }

                const textarea = document.createElement('textarea');
                textarea.className = 'form-textarea';
                textarea.id = item.id;
                textarea.placeholder = item.placeholder || '';
                textarea.rows = item.rows || 3;
                textarea.value = this.data[item.id] || '';
                textarea.addEventListener('input', (e) => {
                    this.data[item.id] = e.target.value;
                    this.saveData();
                    this.recalculate();
                });
                group.appendChild(textarea);

                return group;
            }

            renderInput(item) {
                const group = document.createElement('div');
                group.className = 'form-group';

                if (item.label) {
                    const label = document.createElement('label');
                    label.className = 'form-label';
                    label.textContent = item.label;
                    group.appendChild(label);
                }

                const input = document.createElement('input');
                input.className = 'form-input';
                input.type = 'text';
                input.id = item.id;
                input.placeholder = item.placeholder || '';
                input.value = this.data[item.id] || '';
                input.addEventListener('input', (e) => {
                    this.data[item.id] = e.target.value;
                    this.saveData();
                });
                group.appendChild(input);

                return group;
            }

            renderNumber(item) {
                const group = document.createElement('div');
                group.className = 'form-group';

                if (item.label) {
                    const label = document.createElement('label');
                    label.className = 'form-label';
                    label.textContent = item.label;
                    group.appendChild(label);
                }

                const input = document.createElement('input');
                input.className = 'form-input';
                input.type = 'number';
                input.id = item.id;
                input.value = this.data[item.id] !== undefined ? this.data[item.id] : item.value || 0;
                input.addEventListener('input', (e) => {
                    this.data[item.id] = parseFloat(e.target.value) || 0;
                    this.saveData();
                    this.recalculate();
                });
                group.appendChild(input);

                return group;
            }

            renderGrid(item) {
                const grid = document.createElement('div');
                grid.className = 'form-row';
                grid.style.gridTemplateColumns = `repeat(${item.columns}, 1fr)`;

                item.items.forEach(gridItem => {
                    grid.appendChild(this.renderContent(gridItem));
                });

                return grid;
            }

            renderMetrics(item) {
                const grid = document.createElement('div');
                grid.className = 'metrics-grid';

                item.metrics.forEach(metric => {
                    const card = document.createElement('div');
                    card.className = 'metric-card';
                    card.id = metric.id + 'Display';

                    const colorMap = {
                        primary: this.schema.theme.primary,
                        secondary: this.schema.theme.secondary,
                        success: this.schema.theme.success,
                        warning: this.schema.theme.warning,
                        danger: this.schema.theme.danger,
                        info: '#06b6d4'
                    };

                    card.style.background = `linear-gradient(135deg, ${colorMap[metric.color]} 0%, ${colorMap[metric.color]}dd 100%)`;

                    const value = document.createElement('div');
                    value.className = 'metric-value';
                    value.textContent = metric.value;
                    card.appendChild(value);

                    const label = document.createElement('div');
                    label.className = 'metric-label';
                    label.textContent = metric.label;
                    card.appendChild(label);

                    if (metric.change) {
                        const change = document.createElement('div');
                        change.className = 'metric-change';
                        change.textContent = metric.change;
                        card.appendChild(change);
                    }

                    grid.appendChild(card);
                });

                return grid;
            }

            renderChart(item) {
                const container = document.createElement('div');
                container.className = 'chart-container';
                container.id = item.id;

                if (item.chartType === 'bar') {
                    const chart = document.createElement('div');
                    chart.className = 'bar-chart';
                    chart.id = item.id + 'Content';
                    container.appendChild(chart);
                }

                return container;
            }

            renderSlider(item) {
                const group = document.createElement('div');
                group.className = 'slider-group';

                const header = document.createElement('div');
                header.className = 'slider-header';

                const label = document.createElement('span');
                label.className = 'slider-label';
                label.textContent = item.label;
                header.appendChild(label);

                const valueDisplay = document.createElement('span');
                valueDisplay.className = 'slider-value';
                valueDisplay.id = item.id + 'Value';
                const currentValue = this.data[item.id] !== undefined ? this.data[item.id] : item.value;
                valueDisplay.textContent = `${currentValue} ${item.unit}`;
                header.appendChild(valueDisplay);

                group.appendChild(header);

                const slider = document.createElement('input');
                slider.type = 'range';
                slider.className = 'slider';
                slider.id = item.id;
                slider.min = item.min;
                slider.max = item.max;
                slider.value = currentValue;
                slider.addEventListener('input', (e) => {
                    const val = parseFloat(e.target.value);
                    this.data[item.id] = val;
                    valueDisplay.textContent = `${val} ${item.unit}`;
                    this.saveData();
                    this.recalculate();
                });
                group.appendChild(slider);

                return group;
            }

            renderProgress(component) {
                const progress = document.createElement('div');
                progress.className = 'progress-tracker';

                component.steps.forEach(step => {
                    const stepEl = document.createElement('div');
                    stepEl.className = 'progress-step' + (step.status !== 'pending' ? ' ' + step.status : '');

                    const circle = document.createElement('div');
                    circle.className = 'progress-circle';
                    circle.textContent = step.id;
                    stepEl.appendChild(circle);

                    const label = document.createElement('span');
                    label.className = 'progress-label';
                    label.textContent = step.label;
                    stepEl.appendChild(label);

                    progress.appendChild(stepEl);
                });

                return progress;
            }

            renderTimeline(item) {
                const timeline = document.createElement('div');
                timeline.className = 'timeline';

                item.items.forEach(timelineItem => {
                    const item = document.createElement('div');
                    item.className = 'timeline-item' + (timelineItem.status ? ' ' + timelineItem.status : '');

                    const content = document.createElement('div');
                    content.className = 'timeline-content';

                    const date = document.createElement('div');
                    date.className = 'timeline-date';
                    date.textContent = timelineItem.date;
                    content.appendChild(date);

                    const title = document.createElement('div');
                    title.className = 'timeline-title';
                    title.textContent = timelineItem.title;
                    content.appendChild(title);

                    const description = document.createElement('div');
                    description.className = 'timeline-description';
                    description.textContent = timelineItem.description;
                    content.appendChild(description);

                    item.appendChild(content);
                    timeline.appendChild(item);
                });

                return timeline;
            }

            renderScenarios(component) {
                const container = document.createElement('div');
                container.className = 'scenario-grid';

                component.scenarios.forEach(scenario => {
                    const card = document.createElement('div');
                    card.className = 'scenario-card';
                    card.style.borderColor = scenario.color;

                    const header = document.createElement('div');
                    header.className = 'scenario-header';
                    header.style.background = scenario.color + '22';
                    header.style.color = scenario.color;
                    header.textContent = scenario.label;
                    card.appendChild(header);

                    const body = document.createElement('div');
                    body.className = 'scenario-body';
                    body.id = scenario.id + 'Scenario';

                    // Placeholder metrics
                    ['12-Month Revenue', 'Customer LTV', 'LTV:CAC Ratio', 'Net Customers (12mo)'].forEach(metric => {
                        const metricEl = document.createElement('div');
                        metricEl.className = 'scenario-metric';
                        metricEl.innerHTML = `
                            <span class="scenario-metric-label">${metric}</span>
                            <span class="scenario-metric-value">--</span>
                        `;
                        body.appendChild(metricEl);
                    });

                    card.appendChild(body);
                    container.appendChild(card);
                });

                return container;
            }

            renderActions() {
                const actions = document.createElement('div');
                actions.className = 'action-bar';

                this.schema.actions.forEach(action => {
                    const button = document.createElement('button');
                    button.className = `button button-${action.style}`;
                    button.textContent = action.label;
                    button.addEventListener('click', () => this.handleAction(action.action));
                    actions.appendChild(button);
                });

                return actions;
            }

            showSection(sectionId) {
                // Hide all sections
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                document.querySelectorAll('.nav-tab').forEach(t => {
                    t.classList.remove('active');
                    t.style.background = '';
                    t.style.color = '';
                });

                // Show selected section
                const section = document.getElementById(sectionId);
                if (section) section.classList.add('active');

                // Update nav
                const tabs = document.querySelectorAll('.nav-tab');
                tabs.forEach(tab => {
                    if (tab.textContent.toLowerCase().includes(sectionId)) {
                        tab.classList.add('active');
                        tab.style.background = this.schema.theme.primary;
                        tab.style.color = 'white';
                    }
                });
            }

            recalculate() {
                // Runway calculation
                const cash = this.data.currentCash || 0;
                const burn = this.data.burnRate || 0;
                const revenue = this.data.monthlyRevenue || 0;
                const netBurn = burn - revenue;
                const runway = netBurn > 0 ? cash / netBurn : Infinity;

                this.updateMetric('netBurn', '$' + netBurn.toLocaleString());
                this.updateMetric('runwayMonths', runway === Infinity ? '‚àû' : Math.floor(runway));
                this.updateMetric('runway', runway === Infinity ? '‚àû' : Math.floor(runway));
                this.updateMetric('mrr', '$' + (revenue || 0).toLocaleString());

                // Growth calculation
                const startMRR = this.data.startingMRR || 0;
                const growth = this.data.growthRate || 0;
                const targetMRR = this.data.targetMRR || 0;
                const growthMultiplier = 1 + (growth / 100);

                let months = 0;
                let currentMRR = startMRR;
                while (currentMRR < targetMRR && months < 120) {
                    currentMRR *= growthMultiplier;
                    months++;
                }

                const year1MRR = startMRR * Math.pow(growthMultiplier, 12);
                const year1ARR = year1MRR * 12;

                this.updateMetric('monthsToTarget', months >= 120 ? '120+' : months);
                this.updateMetric('year1MRR', '$' + Math.round(year1MRR).toLocaleString());
                this.updateMetric('year1ARR', '$' + Math.round(year1ARR).toLocaleString());
                this.updateMetric('growth', growth + '%');

                this.updateGrowthChart(startMRR, growthMultiplier);

                // Scenario calculations
                this.updateScenarios();
            }

            updateMetric(id, value) {
                const display = document.getElementById(id + 'Display');
                if (display) {
                    const valueEl = display.querySelector('.metric-value');
                    if (valueEl) valueEl.textContent = value;
                }
            }

            updateGrowthChart(startMRR, multiplier) {
                const chart = document.getElementById('growthChartContent');
                if (!chart) return;

                chart.innerHTML = '';

                const values = [];
                let mrr = startMRR;
                for (let i = 0; i <= 12; i += 2) {
                    values.push({ month: i, value: mrr });
                    mrr *= multiplier * multiplier;
                }

                const maxValue = Math.max(...values.map(v => v.value));

                values.forEach(v => {
                    const group = document.createElement('div');
                    group.className = 'bar-group';

                    const bar = document.createElement('div');
                    bar.className = 'bar';
                    bar.style.height = (v.value / maxValue * 200) + 'px';
                    bar.style.background = `linear-gradient(180deg, ${this.schema.theme.primary} 0%, ${this.schema.theme.primary}dd 100%)`;

                    const barValue = document.createElement('span');
                    barValue.className = 'bar-value';
                    barValue.textContent = '$' + Math.round(v.value / 1000) + 'k';
                    bar.appendChild(barValue);

                    group.appendChild(bar);

                    const label = document.createElement('div');
                    label.className = 'bar-label';
                    label.textContent = 'M' + v.month;
                    group.appendChild(label);

                    chart.appendChild(group);
                });
            }

            updateScenarios() {
                const acquisition = this.data.acquisitionRate || 50;
                const churn = this.data.churnRate || 5;
                const arpu = this.data.arpu || 100;
                const cac = this.data.cac || 50;

                const scenarios = [
                    { id: 'pessimistic', factor: 0.7 },
                    { id: 'realistic', factor: 1.0 },
                    { id: 'optimistic', factor: 1.3 }
                ];

                scenarios.forEach(scenario => {
                    const adjAcquisition = Math.round(acquisition * scenario.factor);
                    const adjChurn = scenario.id === 'optimistic' ? churn * 0.7 :
                                     scenario.id === 'pessimistic' ? churn * 1.3 : churn;

                    const monthlyChurnRate = adjChurn / 100;
                    const avgLifespan = monthlyChurnRate > 0 ? 1 / monthlyChurnRate : 100;
                    const ltv = arpu * avgLifespan;
                    const ltvCacRatio = cac > 0 ? ltv / cac : 0;

                    let totalRevenue = 0;
                    let customers = 0;
                    for (let m = 0; m < 12; m++) {
                        customers = customers * (1 - monthlyChurnRate) + adjAcquisition;
                        totalRevenue += customers * arpu;
                    }

                    const container = document.getElementById(scenario.id + 'Scenario');
                    if (container) {
                        const values = container.querySelectorAll('.scenario-metric-value');
                        if (values[0]) values[0].textContent = '$' + Math.round(totalRevenue).toLocaleString();
                        if (values[1]) values[1].textContent = '$' + Math.round(ltv).toLocaleString();
                        if (values[2]) values[2].textContent = ltvCacRatio.toFixed(1) + 'x';
                        if (values[3]) values[3].textContent = Math.round(customers).toLocaleString();
                    }
                });
            }

            handleAction(action) {
                switch (action) {
                    case 'exportHTML':
                        this.exportHTML();
                        break;
                    case 'exportJSON':
                        this.exportJSON();
                        break;
                    case 'importJSON':
                        this.importJSON();
                        break;
                    case 'print':
                        window.print();
                        break;
                }
            }

            exportHTML() {
                const html = document.documentElement.outerHTML;
                const blob = new Blob([html], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'strategic-document-' + new Date().toISOString().split('T')[0] + '.html';
                a.click();
                URL.revokeObjectURL(url);
            }

            exportJSON() {
                const exportData = {
                    schema: this.schema,
                    data: this.data,
                    exportedAt: new Date().toISOString()
                };
                const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'strategic-data-' + new Date().toISOString().split('T')[0] + '.json';
                a.click();
                URL.revokeObjectURL(url);
            }

            importJSON() {
                const input = document.getElementById('importFile');
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (!file) return;

                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const imported = JSON.parse(event.target.result);
                            if (imported.schema) this.schema = imported.schema;
                            if (imported.data) this.data = imported.data;
                            this.saveData();
                            location.reload();
                        } catch (err) {
                            alert('Error importing: ' + err.message);
                        }
                    };
                    reader.readAsText(file);
                };
                input.click();
            }

            saveData() {
                localStorage.setItem('livingDocumentData', JSON.stringify(this.data));
                localStorage.setItem('livingDocumentSchema', JSON.stringify(this.schema));

                const statusText = document.getElementById('statusText');
                if (statusText) {
                    statusText.textContent = 'Saved just now';
                }
            }

            loadData() {
                try {
                    const savedData = localStorage.getItem('livingDocumentData');
                    const savedSchema = localStorage.getItem('livingDocumentSchema');

                    if (savedData) this.data = JSON.parse(savedData);
                    if (savedSchema) this.schema = JSON.parse(savedSchema);
                } catch (e) {
                    console.error('Error loading data:', e);
                }
            }

            attachEventListeners() {
                // Any global event listeners
            }

            startAutoSave() {
                setInterval(() => {
                    const statusText = document.getElementById('statusText');
                    if (statusText && statusText.textContent === 'Saved just now') {
                        statusText.textContent = 'Auto-saved';
                    }
                }, 3000);
            }
        }

        // ===== INITIALIZE APPLICATION =====
        document.addEventListener('DOMContentLoaded', () => {
            window.doc = new DynamicDocument();
        });
    </script>
</body>
</html>
